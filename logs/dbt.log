[0m22:36:32.832389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ff3cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dc0850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dc0130>]}


============================== 22:36:32.835565 | 9d479451-d1b9-4b22-9702-d19d65aae8df ==============================
[0m22:36:32.835565 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:36:32.835888 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/cedric.conol/Documents/sellerx/logs', 'version_check': 'True', 'profiles_dir': '/Users/cedric.conol/Documents/remote/warehouse-dbt/dbt/profile/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt init', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:36:32.865903 [info ] [MainThread]: Setting up your profile.
[0m22:37:50.716062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107017cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089a7a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089a73d0>]}


============================== 22:37:50.719192 | 2839ade7-078c-4486-be50-59bcd550e764 ==============================
[0m22:37:50.719192 [info ] [MainThread]: Running with dbt=1.8.8
[0m22:37:50.719517 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/cedric.conol/Documents/sellerx/logs', 'profiles_dir': '/Users/cedric.conol/Documents/remote/warehouse-dbt/dbt/profile/', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt init', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:37:50.747361 [info ] [MainThread]: Setting up your profile.
[0m22:43:55.715067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031abca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b3ba00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b3b340>]}


============================== 22:43:55.719546 | d2c830b4-f77a-44a3-800c-63e85ace14d2 ==============================
[0m22:43:55.719546 [info ] [MainThread]: Running with dbt=1.8.8
[0m22:43:55.719929 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/cedric.conol/Documents/sellerx/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/cedric.conol/Documents/remote/warehouse-dbt/dbt/profile/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt init sellerx_wh', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:43:55.754376 [info ] [MainThread]: Setting up your profile.
[0m22:45:57.640891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f7bc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cb39d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cb3310>]}


============================== 22:45:57.644174 | e8b41e4e-9c96-4412-97cd-b6bdcda65c9c ==============================
[0m22:45:57.644174 [info ] [MainThread]: Running with dbt=1.8.8
[0m22:45:57.644513 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cedric.conol/Documents/remote/warehouse-dbt/dbt/profile/', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/cedric.conol/Documents/sellerx/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt init sellerx_wh', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:45:57.677560 [info ] [MainThread]: Setting up your profile.
[0m22:46:26.259603 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 28.677301, "process_user_time": 0.684726, "process_kernel_time": 0.151999, "process_mem_max_rss": "94502912", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:46:26.262367 [debug] [MainThread]: Command `dbt init` succeeded at 22:46:26.262024 after 28.68 seconds
[0m22:46:26.264300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f7bc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c07400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069dae90>]}
[0m22:46:26.265726 [debug] [MainThread]: Flushing usage events
[0m22:48:46.337500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043bbc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f77b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f77490>]}


============================== 22:48:46.340821 | e3308481-6afe-463e-bfc8-592e8b791c7b ==============================
[0m22:48:46.340821 [info ] [MainThread]: Running with dbt=1.8.8
[0m22:48:46.341162 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cedric.conol/Documents/remote/warehouse-dbt/dbt/profile/', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/cedric.conol/Documents/sellerx/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt init sellerx_wh', 'send_anonymous_usage_stats': 'True'}
[0m22:48:46.370521 [info ] [MainThread]: Setting up your profile.
[0m22:51:28.120477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107323c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11985b9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11985b2e0>]}


============================== 22:51:28.123281 | a804ecb3-707e-49d1-8988-d539d82c51a8 ==============================
[0m22:51:28.123281 [info ] [MainThread]: Running with dbt=1.8.8
[0m22:51:28.123620 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/cedric.conol/Documents/sellerx/logs', 'version_check': 'True', 'profiles_dir': '/Users/cedric.conol/Documents/sellerx/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt init takehome_wh', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:51:28.132172 [debug] [MainThread]: Starter project path: /Users/cedric.conol/Documents/sellerx/dbt-env/lib/python3.10/site-packages/dbt/include/starter_project
[0m22:51:28.138026 [info ] [MainThread]: 
Your new dbt project "takehome_wh" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m22:51:28.138323 [info ] [MainThread]: Setting up your profile.
[0m22:51:37.482153 [error] [MainThread]: Encountered an error:

[0m22:51:37.488269 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/cedric.conol/Documents/sellerx/dbt-env/lib/python3.10/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/cedric.conol/Documents/sellerx/dbt-env/lib/python3.10/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/Users/cedric.conol/Documents/sellerx/dbt-env/lib/python3.10/site-packages/dbt/cli/main.py", line 470, in init
    results = task.run()
  File "/Users/cedric.conol/Documents/sellerx/dbt-env/lib/python3.10/site-packages/dbt/task/init.py", line 347, in run
    self.setup_profile(profile_name)
  File "/Users/cedric.conol/Documents/sellerx/dbt-env/lib/python3.10/site-packages/dbt/task/init.py", line 262, in setup_profile
    adapter = self.ask_for_adapter_choice()
  File "/Users/cedric.conol/Documents/sellerx/dbt-env/lib/python3.10/site-packages/dbt/task/init.py", line 243, in ask_for_adapter_choice
    numeric_choice = click.prompt(prompt_msg, type=click.INT)
  File "/Users/cedric.conol/Documents/sellerx/dbt-env/lib/python3.10/site-packages/click/termui.py", line 164, in prompt
    value = prompt_func(prompt)
  File "/Users/cedric.conol/Documents/sellerx/dbt-env/lib/python3.10/site-packages/click/termui.py", line 147, in prompt_func
    raise Abort() from None
click.exceptions.Abort

[0m22:51:37.493350 [debug] [MainThread]: Resource report: {"command_name": "init", "command_wall_clock_time": 9.415575, "process_user_time": 0.627278, "process_kernel_time": 0.14969, "process_mem_max_rss": "95043584", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:51:37.497711 [debug] [MainThread]: Command `dbt init` failed at 22:51:37.497095 after 9.42 seconds
[0m22:51:37.498475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107323c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11985a350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119890310>]}
[0m22:51:37.498928 [debug] [MainThread]: Flushing usage events
[0m22:52:01.004831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120723c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122aca590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122acaad0>]}


============================== 22:52:01.008373 | 6a4f5dd1-d2a0-4ca3-8c80-19cf4089afd7 ==============================
[0m22:52:01.008373 [info ] [MainThread]: Running with dbt=1.8.8
[0m22:52:01.008731 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cedric.conol/Documents/sellerx/', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/cedric.conol/Documents/sellerx/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt init takehome_wh', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:52:01.017096 [info ] [MainThread]: A project called takehome_wh already exists here.
[0m22:52:01.018576 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 0.06955558, "process_user_time": 0.603415, "process_kernel_time": 0.103467, "process_mem_max_rss": "94961664", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:52:01.019011 [debug] [MainThread]: Command `dbt init` succeeded at 22:52:01.018951 after 0.07 seconds
[0m22:52:01.019253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120723c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122b2c280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122acb7c0>]}
[0m22:52:01.019458 [debug] [MainThread]: Flushing usage events
[0m22:52:11.579657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10677bc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b3cdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b3c040>]}


============================== 22:52:11.583192 | 608215b9-5c01-4132-8fb6-656b7a9543ff ==============================
[0m22:52:11.583192 [info ] [MainThread]: Running with dbt=1.8.8
[0m22:52:11.583564 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/cedric.conol/Documents/sellerx/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/cedric.conol/Documents/sellerx/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt init takehome_wh', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:52:11.590716 [debug] [MainThread]: Starter project path: /Users/cedric.conol/Documents/sellerx/dbt-env/lib/python3.10/site-packages/dbt/include/starter_project
[0m22:52:11.595453 [info ] [MainThread]: 
Your new dbt project "takehome_wh" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m22:52:11.595704 [info ] [MainThread]: Setting up your profile.
[0m23:00:32.971850 [info ] [MainThread]: Profile takehome_wh written to /Users/cedric.conol/Documents/sellerx/profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m23:00:32.979434 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 501.42487, "process_user_time": 0.76009, "process_kernel_time": 0.223065, "process_mem_max_rss": "100057088", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:00:32.980850 [debug] [MainThread]: Command `dbt init` succeeded at 23:00:32.980626 after 501.43 seconds
[0m23:00:32.982946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10677bc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b3f100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b59f30>]}
[0m23:00:32.983454 [debug] [MainThread]: Flushing usage events
[0m14:06:18.127421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120a7bc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122c61d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122f077f0>]}


============================== 14:06:18.130241 | 4ff35669-5de0-4b63-9c80-a3d2e895e2eb ==============================
[0m14:06:18.130241 [info ] [MainThread]: Running with dbt=1.8.8
[0m14:06:18.130559 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/cedric.conol/Documents/sellerx/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/cedric.conol/Documents/sellerx/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt init', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:06:24.445887 [debug] [MainThread]: Starter project path: /Users/cedric.conol/Documents/sellerx/dbt-env/lib/python3.10/site-packages/dbt/include/starter_project
[0m14:06:24.465978 [info ] [MainThread]: 
Your new dbt project "takehome_wh" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m14:06:24.466720 [info ] [MainThread]: Setting up your profile.
[0m14:08:46.536930 [info ] [MainThread]: Profile takehome_wh written to /Users/cedric.conol/Documents/sellerx/profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m14:08:46.546910 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 148.46144, "process_user_time": 0.70383, "process_kernel_time": 0.236879, "process_mem_max_rss": "94912512", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:08:46.549495 [debug] [MainThread]: Command `dbt init` succeeded at 14:08:46.548447 after 148.46 seconds
[0m14:08:46.551081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120a7bc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122f07340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122f655a0>]}
[0m14:08:46.551932 [debug] [MainThread]: Flushing usage events
[0m14:08:54.368078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10499bc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062d3c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062d3580>]}


============================== 14:08:54.371251 | c4462292-8d9b-49ac-ac68-23a409a6c7f0 ==============================
[0m14:08:54.371251 [info ] [MainThread]: Running with dbt=1.8.8
[0m14:08:54.371591 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cedric.conol/Documents/sellerx/', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/cedric.conol/Documents/sellerx/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:08:54.380449 [info ] [MainThread]: dbt version: 1.8.8
[0m14:08:54.380740 [info ] [MainThread]: python version: 3.10.9
[0m14:08:54.380921 [info ] [MainThread]: python path: /Users/cedric.conol/Documents/sellerx/dbt-env/bin/python
[0m14:08:54.381094 [info ] [MainThread]: os info: macOS-15.0.1-arm64-arm-64bit
[0m14:08:54.551576 [info ] [MainThread]: Using profiles dir at /Users/cedric.conol/Documents/sellerx/
[0m14:08:54.551934 [info ] [MainThread]: Using profiles.yml file at /Users/cedric.conol/Documents/sellerx/profiles.yml
[0m14:08:54.552141 [info ] [MainThread]: Using dbt_project.yml file at /Users/cedric.conol/Documents/sellerx/dbt_project.yml
[0m14:08:54.552541 [info ] [MainThread]: adapter type: snowflake
[0m14:08:54.552761 [info ] [MainThread]: adapter version: 1.8.4
[0m14:08:54.552939 [info ] [MainThread]: Configuration:
[0m14:08:54.553111 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:08:54.553277 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m14:08:54.553548 [info ] [MainThread]: Required dependencies:
[0m14:08:54.553813 [debug] [MainThread]: Executing "git --help"
[0m14:08:54.571830 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:08:54.572556 [debug] [MainThread]: STDERR: "b''"
[0m14:08:54.572790 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:08:54.573025 [info ] [MainThread]: Connection:
[0m14:08:54.573233 [info ] [MainThread]:   account: rm34151.ap-southeast-1
[0m14:08:54.573404 [info ] [MainThread]:   user: footymcfoot
[0m14:08:54.573566 [info ] [MainThread]:   database: takehome_db
[0m14:08:54.573725 [info ] [MainThread]:   warehouse: takehome_wh
[0m14:08:54.573884 [info ] [MainThread]:   role: takehome_role 
[0m14:08:54.574042 [info ] [MainThread]:   schema: takehome_schema
[0m14:08:54.574202 [info ] [MainThread]:   authenticator: None
[0m14:08:54.574358 [info ] [MainThread]:   oauth_client_id: None
[0m14:08:54.574514 [info ] [MainThread]:   query_tag: None
[0m14:08:54.574671 [info ] [MainThread]:   client_session_keep_alive: False
[0m14:08:54.574826 [info ] [MainThread]:   host: None
[0m14:08:54.574982 [info ] [MainThread]:   port: None
[0m14:08:54.575138 [info ] [MainThread]:   proxy_host: None
[0m14:08:54.575295 [info ] [MainThread]:   proxy_port: None
[0m14:08:54.575451 [info ] [MainThread]:   protocol: None
[0m14:08:54.575608 [info ] [MainThread]:   connect_retries: 1
[0m14:08:54.575765 [info ] [MainThread]:   connect_timeout: None
[0m14:08:54.575920 [info ] [MainThread]:   retry_on_database_errors: False
[0m14:08:54.576077 [info ] [MainThread]:   retry_all: False
[0m14:08:54.576230 [info ] [MainThread]:   insecure_mode: False
[0m14:08:54.576386 [info ] [MainThread]:   reuse_connections: None
[0m14:08:54.576757 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:08:54.580716 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m14:08:54.581516 [debug] [MainThread]: Using snowflake connection "debug"
[0m14:08:54.581687 [debug] [MainThread]: On debug: select 1 as id
[0m14:08:54.581841 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:08:57.307455 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m14:08:57.308104 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m14:08:57.308552 [debug] [MainThread]: On debug: No close available on handle
[0m14:08:57.308959 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m14:08:57.309420 [info ] [MainThread]: [31m2 checks failed:[0m
[0m14:08:57.309765 [info ] [MainThread]: Project loading failed for the following reason:
 project path </Users/cedric.conol/Documents/sellerx/dbt_project.yml> not found

[0m14:08:57.310116 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001 (08001): Failed to connect to DB: rm34151.ap-southeast-1.snowflakecomputing.com:443. Role 'TAKEHOME_ROLE ' specified in the connect string does not exist or not authorized. Contact your local system administrator, or attempt to login with another role, e.g. PUBLIC.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m14:08:57.312963 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 2.9885252, "process_user_time": 0.884313, "process_kernel_time": 0.201572, "process_mem_max_rss": "127057920", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:08:57.313710 [debug] [MainThread]: Command `dbt debug` failed at 14:08:57.313611 after 2.99 seconds
[0m14:08:57.314101 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:08:57.314449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10499bc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ea5bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e5b490>]}
[0m14:08:57.314840 [debug] [MainThread]: Flushing usage events
[0m16:19:52.374076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10289bcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104213ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042135e0>]}


============================== 16:19:52.378521 | 88961f59-3234-4364-aa37-d448245db9ab ==============================
[0m16:19:52.378521 [info ] [MainThread]: Running with dbt=1.8.8
[0m16:19:52.378936 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/cedric.conol/Documents/takehome/', 'log_path': '/Users/cedric.conol/Documents/takehome/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'target', 'invocation_command': 'dbt run -m stg_product__devices', 'send_anonymous_usage_stats': 'True'}
[0m16:19:52.628702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88961f59-3234-4364-aa37-d448245db9ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10417e200>]}
[0m16:19:52.657107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '88961f59-3234-4364-aa37-d448245db9ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cc6d70>]}
[0m16:19:52.657814 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:19:52.672041 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m16:19:52.745383 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m16:19:52.745801 [debug] [MainThread]: Partial parsing: added file: takehome_wh://models/staging/_product__sources.yml
[0m16:19:52.746025 [debug] [MainThread]: Partial parsing: added file: takehome_wh://models/staging/stg_product__devices.sql
[0m16:19:52.938195 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.takehome_wh.marts
[0m16:19:52.945541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88961f59-3234-4364-aa37-d448245db9ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105449f90>]}
[0m16:19:53.002483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88961f59-3234-4364-aa37-d448245db9ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051a4760>]}
[0m16:19:53.002806 [info ] [MainThread]: Found 2 models, 3 sources, 570 macros
[0m16:19:53.003020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88961f59-3234-4364-aa37-d448245db9ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051a5ff0>]}
[0m16:19:53.003658 [info ] [MainThread]: 
[0m16:19:53.003972 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:19:53.004429 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_takehome_db'
[0m16:19:53.011811 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db"
[0m16:19:53.012460 [debug] [ThreadPool]: On list_takehome_db: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db"} */
show terse schemas in database takehome_db
    limit 10000
[0m16:19:53.012701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:19:53.981082 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.968 seconds
[0m16:19:53.984198 [debug] [ThreadPool]: On list_takehome_db: Close
[0m16:19:54.211525 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome_db, now list_takehome_db_takehome_schema)
[0m16:19:54.222842 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db_takehome_schema"
[0m16:19:54.223510 [debug] [ThreadPool]: On list_takehome_db_takehome_schema: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db_takehome_schema"} */
show objects in takehome_db.takehome_schema limit 10000
[0m16:19:54.223775 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:19:54.756852 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.533 seconds
[0m16:19:54.759526 [debug] [ThreadPool]: On list_takehome_db_takehome_schema: Close
[0m16:19:54.943066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88961f59-3234-4364-aa37-d448245db9ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105449900>]}
[0m16:19:54.944825 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m16:19:54.945648 [info ] [MainThread]: 
[0m16:19:54.951259 [debug] [Thread-1 (]: Began running node model.takehome_wh.stg_product__devices
[0m16:19:54.952716 [info ] [Thread-1 (]: 1 of 1 START sql view model takehome_schema.stg_product__devices ............... [RUN]
[0m16:19:54.953957 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_takehome_db_takehome_schema, now model.takehome_wh.stg_product__devices)
[0m16:19:54.955624 [debug] [Thread-1 (]: Began compiling node model.takehome_wh.stg_product__devices
[0m16:19:54.969305 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome_wh.stg_product__devices"
[0m16:19:54.970726 [debug] [Thread-1 (]: Began executing node model.takehome_wh.stg_product__devices
[0m16:19:55.009838 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome_wh.stg_product__devices"
[0m16:19:55.011045 [debug] [Thread-1 (]: Using snowflake connection "model.takehome_wh.stg_product__devices"
[0m16:19:55.011320 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__devices: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.stg_product__devices"} */
create or replace   view takehome_db.takehome_schema.stg_product__devices
  
   as (
    with
    devices as (select * from read_replica.product.device),

    final as (
        select
            *
        from
            devices
    )

select *
from final
  );
[0m16:19:55.011573 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:55.510182 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b7f753-3201-4d0e-0000-000ab12a6195
[0m16:19:55.511096 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Database 'READ_REPLICA' does not exist or not authorized.
[0m16:19:55.511933 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__devices: Close
[0m16:19:55.702183 [debug] [Thread-1 (]: Database Error in model stg_product__devices (models/staging/stg_product__devices.sql)
  002003 (02000): SQL compilation error:
  Database 'READ_REPLICA' does not exist or not authorized.
  compiled code at target/run/takehome_wh/models/staging/stg_product__devices.sql
[0m16:19:55.705810 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88961f59-3234-4364-aa37-d448245db9ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056fa590>]}
[0m16:19:55.707526 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model takehome_schema.stg_product__devices ...... [[31mERROR[0m in 0.75s]
[0m16:19:55.708895 [debug] [Thread-1 (]: Finished running node model.takehome_wh.stg_product__devices
[0m16:19:55.711490 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:19:55.712154 [debug] [MainThread]: Connection 'model.takehome_wh.stg_product__devices' was properly closed.
[0m16:19:55.712711 [info ] [MainThread]: 
[0m16:19:55.714074 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.71 seconds (2.71s).
[0m16:19:55.715434 [debug] [MainThread]: Command end result
[0m16:19:55.759401 [info ] [MainThread]: 
[0m16:19:55.760013 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:19:55.760261 [info ] [MainThread]: 
[0m16:19:55.760549 [error] [MainThread]:   Database Error in model stg_product__devices (models/staging/stg_product__devices.sql)
  002003 (02000): SQL compilation error:
  Database 'READ_REPLICA' does not exist or not authorized.
  compiled code at target/run/takehome_wh/models/staging/stg_product__devices.sql
[0m16:19:55.760776 [info ] [MainThread]: 
[0m16:19:55.761010 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:19:55.763696 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.439779, "process_user_time": 1.400457, "process_kernel_time": 0.265974, "process_mem_max_rss": "138985472", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:19:55.764364 [debug] [MainThread]: Command `dbt run` failed at 16:19:55.764291 after 3.44 seconds
[0m16:19:55.764729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10289bcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051a60b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cc6d70>]}
[0m16:19:55.765092 [debug] [MainThread]: Flushing usage events
[0m16:20:48.406031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102623d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10429bdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10429b700>]}


============================== 16:20:48.409817 | d63accb7-4d77-443b-abcf-e771aee8148e ==============================
[0m16:20:48.409817 [info ] [MainThread]: Running with dbt=1.8.8
[0m16:20:48.410313 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cedric.conol/Documents/takehome/', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/cedric.conol/Documents/takehome/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_product__devices', 'static_parser': 'True', 'target_path': 'target', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:20:48.664368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd63accb7-4d77-443b-abcf-e771aee8148e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104207c10>]}
[0m16:20:48.690422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd63accb7-4d77-443b-abcf-e771aee8148e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f75690>]}
[0m16:20:48.691024 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:20:48.703519 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m16:20:48.787863 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:20:48.788128 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:20:48.791247 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.takehome_wh.marts
[0m16:20:48.809151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd63accb7-4d77-443b-abcf-e771aee8148e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055344c0>]}
[0m16:20:48.890927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd63accb7-4d77-443b-abcf-e771aee8148e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054d9120>]}
[0m16:20:48.891255 [info ] [MainThread]: Found 2 models, 3 sources, 570 macros
[0m16:20:48.891468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd63accb7-4d77-443b-abcf-e771aee8148e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054d94b0>]}
[0m16:20:48.892119 [info ] [MainThread]: 
[0m16:20:48.892424 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:20:48.892896 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_takehome_db'
[0m16:20:48.900814 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db"
[0m16:20:48.901094 [debug] [ThreadPool]: On list_takehome_db: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db"} */
show terse schemas in database takehome_db
    limit 10000
[0m16:20:48.901277 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:49.459331 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.558 seconds
[0m16:20:49.463055 [debug] [ThreadPool]: On list_takehome_db: Close
[0m16:20:49.646008 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome_db, now list_takehome_db_takehome_schema)
[0m16:20:49.660025 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db_takehome_schema"
[0m16:20:49.660692 [debug] [ThreadPool]: On list_takehome_db_takehome_schema: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db_takehome_schema"} */
show objects in takehome_db.takehome_schema limit 10000
[0m16:20:49.661054 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:20:50.211994 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.551 seconds
[0m16:20:50.214178 [debug] [ThreadPool]: On list_takehome_db_takehome_schema: Close
[0m16:20:50.416375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd63accb7-4d77-443b-abcf-e771aee8148e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055143d0>]}
[0m16:20:50.418855 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m16:20:50.420200 [info ] [MainThread]: 
[0m16:20:50.424549 [debug] [Thread-1 (]: Began running node model.takehome_wh.stg_product__devices
[0m16:20:50.427650 [info ] [Thread-1 (]: 1 of 1 START sql view model takehome_schema.stg_product__devices ............... [RUN]
[0m16:20:50.428674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_takehome_db_takehome_schema, now model.takehome_wh.stg_product__devices)
[0m16:20:50.429342 [debug] [Thread-1 (]: Began compiling node model.takehome_wh.stg_product__devices
[0m16:20:50.446013 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome_wh.stg_product__devices"
[0m16:20:50.447447 [debug] [Thread-1 (]: Began executing node model.takehome_wh.stg_product__devices
[0m16:20:50.473937 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome_wh.stg_product__devices"
[0m16:20:50.475230 [debug] [Thread-1 (]: Using snowflake connection "model.takehome_wh.stg_product__devices"
[0m16:20:50.476411 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__devices: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.stg_product__devices"} */
create or replace   view takehome_db.takehome_schema.stg_product__devices
  
   as (
    with
    devices as (select * from read_replica.product.device),

    final as (
        select
            *
        from
            devices
    )

select *
from final
  );
[0m16:20:50.476748 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:20:51.039711 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b7f754-3201-4d0e-0000-000ab12a61f5
[0m16:20:51.040676 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Database 'READ_REPLICA' does not exist or not authorized.
[0m16:20:51.041466 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__devices: Close
[0m16:20:51.211990 [debug] [Thread-1 (]: Database Error in model stg_product__devices (models/staging/stg_product__devices.sql)
  002003 (02000): SQL compilation error:
  Database 'READ_REPLICA' does not exist or not authorized.
  compiled code at target/run/takehome_wh/models/staging/stg_product__devices.sql
[0m16:20:51.215207 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd63accb7-4d77-443b-abcf-e771aee8148e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10578b9d0>]}
[0m16:20:51.216446 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model takehome_schema.stg_product__devices ...... [[31mERROR[0m in 0.78s]
[0m16:20:51.219100 [debug] [Thread-1 (]: Finished running node model.takehome_wh.stg_product__devices
[0m16:20:51.222490 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:20:51.223140 [debug] [MainThread]: Connection 'model.takehome_wh.stg_product__devices' was properly closed.
[0m16:20:51.223618 [info ] [MainThread]: 
[0m16:20:51.224104 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.33 seconds (2.33s).
[0m16:20:51.224936 [debug] [MainThread]: Command end result
[0m16:20:51.264725 [info ] [MainThread]: 
[0m16:20:51.265230 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:20:51.265465 [info ] [MainThread]: 
[0m16:20:51.265749 [error] [MainThread]:   Database Error in model stg_product__devices (models/staging/stg_product__devices.sql)
  002003 (02000): SQL compilation error:
  Database 'READ_REPLICA' does not exist or not authorized.
  compiled code at target/run/takehome_wh/models/staging/stg_product__devices.sql
[0m16:20:51.265966 [info ] [MainThread]: 
[0m16:20:51.266192 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:20:51.268926 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.9108014, "process_user_time": 1.316615, "process_kernel_time": 0.261066, "process_mem_max_rss": "131137536", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:20:51.269376 [debug] [MainThread]: Command `dbt run` failed at 16:20:51.269319 after 2.91 seconds
[0m16:20:51.269666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102623d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054bd1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f75690>]}
[0m16:20:51.269939 [debug] [MainThread]: Flushing usage events
[0m16:24:40.292061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a23d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107997e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107997760>]}


============================== 16:24:40.296944 | 4c668efe-1435-4714-8b2c-d28468cc448f ==============================
[0m16:24:40.296944 [info ] [MainThread]: Running with dbt=1.8.8
[0m16:24:40.297592 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cedric.conol/Documents/takehome/', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/cedric.conol/Documents/takehome/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'target', 'invocation_command': 'dbt run -m stg_product__devices', 'send_anonymous_usage_stats': 'True'}
[0m16:24:40.666400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c668efe-1435-4714-8b2c-d28468cc448f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084b46a0>]}
[0m16:24:40.696895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c668efe-1435-4714-8b2c-d28468cc448f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10853d7b0>]}
[0m16:24:40.697691 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:24:40.711422 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m16:24:40.812079 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:24:40.812397 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:24:40.815923 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.takehome_wh.marts
[0m16:24:40.836979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c668efe-1435-4714-8b2c-d28468cc448f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c34520>]}
[0m16:24:40.949984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c668efe-1435-4714-8b2c-d28468cc448f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108527df0>]}
[0m16:24:40.950360 [info ] [MainThread]: Found 2 models, 3 sources, 570 macros
[0m16:24:40.950582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c668efe-1435-4714-8b2c-d28468cc448f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087d46a0>]}
[0m16:24:40.951274 [info ] [MainThread]: 
[0m16:24:40.951583 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:24:40.952042 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_takehome_db'
[0m16:24:40.961583 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db"
[0m16:24:40.961887 [debug] [ThreadPool]: On list_takehome_db: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db"} */
show terse schemas in database takehome_db
    limit 10000
[0m16:24:40.962075 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:24:41.533700 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.572 seconds
[0m16:24:41.535537 [debug] [ThreadPool]: On list_takehome_db: Close
[0m16:24:41.707516 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome_db, now list_takehome_db_takehome_schema)
[0m16:24:41.716202 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db_takehome_schema"
[0m16:24:41.716643 [debug] [ThreadPool]: On list_takehome_db_takehome_schema: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db_takehome_schema"} */
show objects in takehome_db.takehome_schema limit 10000
[0m16:24:41.716884 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:24:42.240621 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.524 seconds
[0m16:24:42.242041 [debug] [ThreadPool]: On list_takehome_db_takehome_schema: Close
[0m16:24:42.480637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c668efe-1435-4714-8b2c-d28468cc448f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085240d0>]}
[0m16:24:42.481446 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m16:24:42.481695 [info ] [MainThread]: 
[0m16:24:42.483917 [debug] [Thread-1 (]: Began running node model.takehome_wh.stg_product__devices
[0m16:24:42.484586 [info ] [Thread-1 (]: 1 of 1 START sql view model takehome_schema.stg_product__devices ............... [RUN]
[0m16:24:42.485053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_takehome_db_takehome_schema, now model.takehome_wh.stg_product__devices)
[0m16:24:42.485279 [debug] [Thread-1 (]: Began compiling node model.takehome_wh.stg_product__devices
[0m16:24:42.510483 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome_wh.stg_product__devices"
[0m16:24:42.511417 [debug] [Thread-1 (]: Began executing node model.takehome_wh.stg_product__devices
[0m16:24:42.538156 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome_wh.stg_product__devices"
[0m16:24:42.539451 [debug] [Thread-1 (]: Using snowflake connection "model.takehome_wh.stg_product__devices"
[0m16:24:42.539722 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__devices: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.stg_product__devices"} */
create or replace   view takehome_db.takehome_schema.stg_product__devices
  
   as (
    with
    devices as (select * from read_replica.product.device),

    final as (
        select
            *
        from
            devices
    )

select *
from final
  );
[0m16:24:42.539934 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:24:43.135862 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.595 seconds
[0m16:24:43.160780 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__devices: Close
[0m16:24:43.360424 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c668efe-1435-4714-8b2c-d28468cc448f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a189f90>]}
[0m16:24:43.362286 [info ] [Thread-1 (]: 1 of 1 OK created sql view model takehome_schema.stg_product__devices .......... [[32mSUCCESS 1[0m in 0.87s]
[0m16:24:43.364760 [debug] [Thread-1 (]: Finished running node model.takehome_wh.stg_product__devices
[0m16:24:43.366538 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:24:43.367130 [debug] [MainThread]: Connection 'model.takehome_wh.stg_product__devices' was properly closed.
[0m16:24:43.367665 [info ] [MainThread]: 
[0m16:24:43.368186 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.42 seconds (2.42s).
[0m16:24:43.369109 [debug] [MainThread]: Command end result
[0m16:24:43.435214 [info ] [MainThread]: 
[0m16:24:43.440897 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:24:43.441835 [info ] [MainThread]: 
[0m16:24:43.442287 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:24:43.444375 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.2071273, "process_user_time": 1.284651, "process_kernel_time": 0.285928, "process_mem_max_rss": "127975424", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:24:43.445038 [debug] [MainThread]: Command `dbt run` succeeded at 16:24:43.444962 after 3.21 seconds
[0m16:24:43.448674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a23d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bb5270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a247760>]}
[0m16:24:43.449827 [debug] [MainThread]: Flushing usage events
[0m17:50:17.207348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ca3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104617d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104617670>]}


============================== 17:50:17.211908 | c03347e6-0f1e-432f-ac28-ce8b625e01de ==============================
[0m17:50:17.211908 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:50:17.212252 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cedric.conol/Documents/takehome/', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/cedric.conol/Documents/takehome/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_product__stores', 'log_format': 'default', 'target_path': 'target', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:50:17.463788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c03347e6-0f1e-432f-ac28-ce8b625e01de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032fd2a0>]}
[0m17:50:17.493038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c03347e6-0f1e-432f-ac28-ce8b625e01de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042bbdf0>]}
[0m17:50:17.493699 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:50:17.506365 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m17:50:17.601560 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m17:50:17.601935 [debug] [MainThread]: Partial parsing: added file: takehome_wh://models/staging/stg_product__stores.sql
[0m17:50:17.602175 [debug] [MainThread]: Partial parsing: updated file: takehome_wh://models/staging/stg_product__devices.sql
[0m17:50:17.772737 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.takehome_wh.marts
[0m17:50:17.781578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c03347e6-0f1e-432f-ac28-ce8b625e01de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105650040>]}
[0m17:50:17.839511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c03347e6-0f1e-432f-ac28-ce8b625e01de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056653c0>]}
[0m17:50:17.839857 [info ] [MainThread]: Found 3 models, 3 sources, 570 macros
[0m17:50:17.840068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c03347e6-0f1e-432f-ac28-ce8b625e01de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10564f3d0>]}
[0m17:50:17.840747 [info ] [MainThread]: 
[0m17:50:17.841056 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:50:17.841532 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_takehome_db'
[0m17:50:17.849246 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db"
[0m17:50:17.849568 [debug] [ThreadPool]: On list_takehome_db: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db"} */
show terse schemas in database takehome_db
    limit 10000
[0m17:50:17.849746 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:18.986968 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.137 seconds
[0m17:50:18.990271 [debug] [ThreadPool]: On list_takehome_db: Close
[0m17:50:19.169649 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome_db, now list_takehome_db_takehome_schema)
[0m17:50:19.183222 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db_takehome_schema"
[0m17:50:19.183902 [debug] [ThreadPool]: On list_takehome_db_takehome_schema: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db_takehome_schema"} */
show objects in takehome_db.takehome_schema limit 10000
[0m17:50:19.184272 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:50:19.707234 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.523 seconds
[0m17:50:19.708785 [debug] [ThreadPool]: On list_takehome_db_takehome_schema: Close
[0m17:50:19.877225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c03347e6-0f1e-432f-ac28-ce8b625e01de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105665270>]}
[0m17:50:19.878772 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m17:50:19.879321 [info ] [MainThread]: 
[0m17:50:19.882706 [debug] [Thread-1 (]: Began running node model.takehome_wh.stg_product__stores
[0m17:50:19.883414 [info ] [Thread-1 (]: 1 of 1 START sql view model takehome_schema.stg_product__stores ................ [RUN]
[0m17:50:19.883984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_takehome_db_takehome_schema, now model.takehome_wh.stg_product__stores)
[0m17:50:19.884394 [debug] [Thread-1 (]: Began compiling node model.takehome_wh.stg_product__stores
[0m17:50:19.897551 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome_wh.stg_product__stores"
[0m17:50:19.898558 [debug] [Thread-1 (]: Began executing node model.takehome_wh.stg_product__stores
[0m17:50:19.921341 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome_wh.stg_product__stores"
[0m17:50:19.922643 [debug] [Thread-1 (]: Using snowflake connection "model.takehome_wh.stg_product__stores"
[0m17:50:19.922953 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__stores: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.stg_product__stores"} */
create or replace   view takehome_db.takehome_schema.stg_product__stores
  
   as (
    with
    stores as (select * from read_replica.product.store),

    final as (
        select
            id as pk_store_id,
            name as store_name,
            address as store_address,
            city as store_city,
            country as store_country,
            typology as store_device_typology,
            customer_id,

            created_at as store_created_at,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from
            stores
    )

select *
from final
  );
[0m17:50:19.923231 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:50:20.724188 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.801 seconds
[0m17:50:20.746022 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__stores: Close
[0m17:50:20.921288 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c03347e6-0f1e-432f-ac28-ce8b625e01de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a2a050>]}
[0m17:50:20.923854 [info ] [Thread-1 (]: 1 of 1 OK created sql view model takehome_schema.stg_product__stores ........... [[32mSUCCESS 1[0m in 1.03s]
[0m17:50:20.925197 [debug] [Thread-1 (]: Finished running node model.takehome_wh.stg_product__stores
[0m17:50:20.927665 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:50:20.928817 [debug] [MainThread]: Connection 'model.takehome_wh.stg_product__stores' was properly closed.
[0m17:50:20.929504 [info ] [MainThread]: 
[0m17:50:20.929963 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.09 seconds (3.09s).
[0m17:50:20.931240 [debug] [MainThread]: Command end result
[0m17:50:20.974068 [info ] [MainThread]: 
[0m17:50:20.974605 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:50:20.974851 [info ] [MainThread]: 
[0m17:50:20.975096 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:50:20.977876 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.8210206, "process_user_time": 1.431748, "process_kernel_time": 0.261235, "process_mem_max_rss": "133431296", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:50:20.978761 [debug] [MainThread]: Command `dbt run` succeeded at 17:50:20.978654 after 3.82 seconds
[0m17:50:20.979102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ca3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a42c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059e3af0>]}
[0m17:50:20.979388 [debug] [MainThread]: Flushing usage events
[0m18:01:27.706652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bd3cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113997ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139975e0>]}


============================== 18:01:27.709765 | 8d941c5b-1716-4d3b-9eba-7abe8fe30239 ==============================
[0m18:01:27.709765 [info ] [MainThread]: Running with dbt=1.8.8
[0m18:01:27.710106 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cedric.conol/Documents/takehome/', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/cedric.conol/Documents/takehome/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'target', 'invocation_command': 'dbt run -m stg_product__transactions', 'send_anonymous_usage_stats': 'True'}
[0m18:01:27.972314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d941c5b-1716-4d3b-9eba-7abe8fe30239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113906200>]}
[0m18:01:28.002352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d941c5b-1716-4d3b-9eba-7abe8fe30239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1146dad70>]}
[0m18:01:28.003077 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:01:28.016558 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m18:01:28.107223 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m18:01:28.107593 [debug] [MainThread]: Partial parsing: added file: takehome_wh://models/staging/stg_product__transactions.sql
[0m18:01:28.250029 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.takehome_wh.marts
[0m18:01:28.259135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d941c5b-1716-4d3b-9eba-7abe8fe30239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114f78130>]}
[0m18:01:28.323002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d941c5b-1716-4d3b-9eba-7abe8fe30239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114f79810>]}
[0m18:01:28.323367 [info ] [MainThread]: Found 4 models, 3 sources, 570 macros
[0m18:01:28.323584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d941c5b-1716-4d3b-9eba-7abe8fe30239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114f798a0>]}
[0m18:01:28.324406 [info ] [MainThread]: 
[0m18:01:28.324733 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:01:28.325192 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_takehome_db'
[0m18:01:28.332916 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db"
[0m18:01:28.333248 [debug] [ThreadPool]: On list_takehome_db: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db"} */
show terse schemas in database takehome_db
    limit 10000
[0m18:01:28.333442 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:28.905741 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.572 seconds
[0m18:01:28.910060 [debug] [ThreadPool]: On list_takehome_db: Close
[0m18:01:29.095047 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome_db, now list_takehome_db_takehome_schema)
[0m18:01:29.109637 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db_takehome_schema"
[0m18:01:29.110207 [debug] [ThreadPool]: On list_takehome_db_takehome_schema: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db_takehome_schema"} */
show objects in takehome_db.takehome_schema limit 10000
[0m18:01:29.110534 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:01:29.644015 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.533 seconds
[0m18:01:29.646177 [debug] [ThreadPool]: On list_takehome_db_takehome_schema: Close
[0m18:01:29.819091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d941c5b-1716-4d3b-9eba-7abe8fe30239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114f79720>]}
[0m18:01:29.819952 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:01:29.820331 [info ] [MainThread]: 
[0m18:01:29.823247 [debug] [Thread-1 (]: Began running node model.takehome_wh.stg_product__transactions
[0m18:01:29.824102 [info ] [Thread-1 (]: 1 of 1 START sql view model takehome_schema.stg_product__transactions .......... [RUN]
[0m18:01:29.827095 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_takehome_db_takehome_schema, now model.takehome_wh.stg_product__transactions)
[0m18:01:29.827692 [debug] [Thread-1 (]: Began compiling node model.takehome_wh.stg_product__transactions
[0m18:01:29.840644 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome_wh.stg_product__transactions"
[0m18:01:29.843019 [debug] [Thread-1 (]: Began executing node model.takehome_wh.stg_product__transactions
[0m18:01:29.867236 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome_wh.stg_product__transactions"
[0m18:01:29.868995 [debug] [Thread-1 (]: Using snowflake connection "model.takehome_wh.stg_product__transactions"
[0m18:01:29.869299 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.stg_product__transactions"} */
create or replace   view takehome_db.takehome_schema.stg_product__transactions
  
   as (
    with
    transactions as (select * from read_replica.product.transactions),

    final as (
        select
            id as pk_transaction_id,
            device_id,
            product_name as transaction_product_name,
            product_sku as transaction_product_sku,
            amount as transaction_amount_eur,
            status as transaction_status,

            -- ideally, sensitive information such as credit card numbers
            -- and CVVs should not be stored in a data warehouse
            -- these sensitive information will not be included in downstream
            -- models in this project
            
            -- if an analysis requires these two fields, and product
            -- database remain unencrypted, perform tokenization

            created_at as transaction_created_at,
            happened_at as transaction_happened_at,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from transactions
    )

select *
from final
  );
[0m18:01:29.869558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:30.485686 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.616 seconds
[0m18:01:30.505076 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__transactions: Close
[0m18:01:30.672052 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d941c5b-1716-4d3b-9eba-7abe8fe30239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115d1c4f0>]}
[0m18:01:30.673006 [info ] [Thread-1 (]: 1 of 1 OK created sql view model takehome_schema.stg_product__transactions ..... [[32mSUCCESS 1[0m in 0.84s]
[0m18:01:30.673623 [debug] [Thread-1 (]: Finished running node model.takehome_wh.stg_product__transactions
[0m18:01:30.675249 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:01:30.675781 [debug] [MainThread]: Connection 'model.takehome_wh.stg_product__transactions' was properly closed.
[0m18:01:30.676288 [info ] [MainThread]: 
[0m18:01:30.676680 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.35 seconds (2.35s).
[0m18:01:30.677296 [debug] [MainThread]: Command end result
[0m18:01:30.705237 [info ] [MainThread]: 
[0m18:01:30.705694 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:01:30.705911 [info ] [MainThread]: 
[0m18:01:30.706131 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:01:30.707779 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.0478175, "process_user_time": 1.38837, "process_kernel_time": 0.247771, "process_mem_max_rss": "138739712", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:01:30.708130 [debug] [MainThread]: Command `dbt run` succeeded at 18:01:30.708081 after 3.05 seconds
[0m18:01:30.708392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bd3cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114f2c3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113906200>]}
[0m18:01:30.708631 [debug] [MainThread]: Flushing usage events
[0m18:19:46.121417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10635bd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ccfd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ccf670>]}


============================== 18:19:46.124458 | 71946ff6-ea13-4b5e-8832-e136f14a3c8d ==============================
[0m18:19:46.124458 [info ] [MainThread]: Running with dbt=1.8.8
[0m18:19:46.124789 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/cedric.conol/Documents/takehome/logs', 'debug': 'False', 'profiles_dir': '/Users/cedric.conol/Documents/takehome/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_product__devices', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'target', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:19:46.347343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71946ff6-ea13-4b5e-8832-e136f14a3c8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108786dd0>]}
[0m18:19:46.373724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '71946ff6-ea13-4b5e-8832-e136f14a3c8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088be800>]}
[0m18:19:46.374366 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:19:46.387101 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m18:19:46.483872 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:19:46.484124 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:19:46.487160 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.takehome_wh.marts
[0m18:19:46.536803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71946ff6-ea13-4b5e-8832-e136f14a3c8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cc00d0>]}
[0m18:19:46.603163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71946ff6-ea13-4b5e-8832-e136f14a3c8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a63580>]}
[0m18:19:46.603490 [info ] [MainThread]: Found 3 models, 2 data tests, 3 sources, 570 macros
[0m18:19:46.603695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71946ff6-ea13-4b5e-8832-e136f14a3c8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a609a0>]}
[0m18:19:46.604362 [info ] [MainThread]: 
[0m18:19:46.604683 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:19:46.605136 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_takehome_db'
[0m18:19:46.614022 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db"
[0m18:19:46.614313 [debug] [ThreadPool]: On list_takehome_db: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db"} */
show terse schemas in database takehome_db
    limit 10000
[0m18:19:46.614484 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:19:47.186438 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.571 seconds
[0m18:19:47.190664 [debug] [ThreadPool]: On list_takehome_db: Close
[0m18:19:47.380125 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome_db, now list_takehome_db_takehome_schema)
[0m18:19:47.396422 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db_takehome_schema"
[0m18:19:47.397036 [debug] [ThreadPool]: On list_takehome_db_takehome_schema: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db_takehome_schema"} */
show objects in takehome_db.takehome_schema limit 10000
[0m18:19:47.397404 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:19:47.846155 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.449 seconds
[0m18:19:47.847732 [debug] [ThreadPool]: On list_takehome_db_takehome_schema: Close
[0m18:19:47.997207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71946ff6-ea13-4b5e-8832-e136f14a3c8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a190f0>]}
[0m18:19:47.998875 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:19:47.999806 [info ] [MainThread]: 
[0m18:19:48.005036 [debug] [Thread-1 (]: Began running node model.takehome_wh.stg_product__devices
[0m18:19:48.006388 [info ] [Thread-1 (]: 1 of 1 START sql view model takehome_schema.stg_product__devices ............... [RUN]
[0m18:19:48.007237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_takehome_db_takehome_schema, now model.takehome_wh.stg_product__devices)
[0m18:19:48.007850 [debug] [Thread-1 (]: Began compiling node model.takehome_wh.stg_product__devices
[0m18:19:48.027136 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome_wh.stg_product__devices"
[0m18:19:48.030240 [debug] [Thread-1 (]: Began executing node model.takehome_wh.stg_product__devices
[0m18:19:48.052052 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome_wh.stg_product__devices"
[0m18:19:48.055615 [debug] [Thread-1 (]: Using snowflake connection "model.takehome_wh.stg_product__devices"
[0m18:19:48.056071 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__devices: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.stg_product__devices"} */
create or replace   view takehome_db.takehome_schema.stg_product__devices
  
   as (
    with
    devices as (select * from read_replica.product.device),

    final as (
        select
            id as pk_product_id,
            type as product_type,
            store_id,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from
            devices
    )

select *
from final
  );
[0m18:19:48.056351 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:19:48.615247 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.558 seconds
[0m18:19:48.650268 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__devices: Close
[0m18:19:48.833916 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71946ff6-ea13-4b5e-8832-e136f14a3c8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f0e470>]}
[0m18:19:48.835759 [info ] [Thread-1 (]: 1 of 1 OK created sql view model takehome_schema.stg_product__devices .......... [[32mSUCCESS 1[0m in 0.82s]
[0m18:19:48.840748 [debug] [Thread-1 (]: Finished running node model.takehome_wh.stg_product__devices
[0m18:19:48.855492 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:19:48.859037 [debug] [MainThread]: Connection 'model.takehome_wh.stg_product__devices' was properly closed.
[0m18:19:48.860295 [info ] [MainThread]: 
[0m18:19:48.861276 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.26 seconds (2.26s).
[0m18:19:48.864034 [debug] [MainThread]: Command end result
[0m18:19:48.920157 [info ] [MainThread]: 
[0m18:19:48.920703 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:19:48.920942 [info ] [MainThread]: 
[0m18:19:48.921169 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:19:48.923461 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.8520606, "process_user_time": 1.331289, "process_kernel_time": 0.228945, "process_mem_max_rss": "136544256", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:19:48.924890 [debug] [MainThread]: Command `dbt run` succeeded at 18:19:48.924799 after 2.85 seconds
[0m18:19:48.925255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10635bd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070fec20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ef48b0>]}
[0m18:19:48.925606 [debug] [MainThread]: Flushing usage events
[0m18:20:34.249732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066d3d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108047d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108047670>]}


============================== 18:20:34.253439 | 3500ea29-3e10-4674-a193-eedea138710e ==============================
[0m18:20:34.253439 [info ] [MainThread]: Running with dbt=1.8.8
[0m18:20:34.253837 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cedric.conol/Documents/takehome/', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/cedric.conol/Documents/takehome/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m stg_product__devices', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'target', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:20:34.484130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3500ea29-3e10-4674-a193-eedea138710e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108afedd0>]}
[0m18:20:34.511108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3500ea29-3e10-4674-a193-eedea138710e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c36800>]}
[0m18:20:34.511914 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:20:34.525485 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m18:20:34.624023 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:20:34.624431 [debug] [MainThread]: Partial parsing: updated file: takehome_wh://models/staging/stg_product__devices.sql
[0m18:20:34.762824 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:20:34.763206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3500ea29-3e10-4674-a193-eedea138710e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109053a30>]}
[0m18:20:34.845964 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.takehome_wh.marts
[0m18:20:34.853847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3500ea29-3e10-4674-a193-eedea138710e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092de710>]}
[0m18:20:34.921999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3500ea29-3e10-4674-a193-eedea138710e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ee4400>]}
[0m18:20:34.922326 [info ] [MainThread]: Found 3 models, 2 data tests, 3 sources, 570 macros
[0m18:20:34.922535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3500ea29-3e10-4674-a193-eedea138710e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ee57b0>]}
[0m18:20:34.923204 [info ] [MainThread]: 
[0m18:20:34.923506 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:20:34.923965 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_takehome_db'
[0m18:20:34.930893 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db"
[0m18:20:34.931164 [debug] [ThreadPool]: On list_takehome_db: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db"} */
show terse schemas in database takehome_db
    limit 10000
[0m18:20:34.931360 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:20:35.453109 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.521 seconds
[0m18:20:35.456528 [debug] [ThreadPool]: On list_takehome_db: Close
[0m18:20:35.634759 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome_db, now list_takehome_db_takehome_schema)
[0m18:20:35.650967 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db_takehome_schema"
[0m18:20:35.651645 [debug] [ThreadPool]: On list_takehome_db_takehome_schema: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db_takehome_schema"} */
show objects in takehome_db.takehome_schema limit 10000
[0m18:20:35.652596 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:20:36.169980 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.517 seconds
[0m18:20:36.173952 [debug] [ThreadPool]: On list_takehome_db_takehome_schema: Close
[0m18:20:36.362349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3500ea29-3e10-4674-a193-eedea138710e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091c0730>]}
[0m18:20:36.364060 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:20:36.365137 [info ] [MainThread]: 
[0m18:20:36.370835 [debug] [Thread-1 (]: Began running node model.takehome_wh.stg_product__devices
[0m18:20:36.372175 [info ] [Thread-1 (]: 1 of 1 START sql view model takehome_schema.stg_product__devices ............... [RUN]
[0m18:20:36.372961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_takehome_db_takehome_schema, now model.takehome_wh.stg_product__devices)
[0m18:20:36.373372 [debug] [Thread-1 (]: Began compiling node model.takehome_wh.stg_product__devices
[0m18:20:36.384940 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome_wh.stg_product__devices"
[0m18:20:36.388275 [debug] [Thread-1 (]: Began executing node model.takehome_wh.stg_product__devices
[0m18:20:36.415626 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome_wh.stg_product__devices"
[0m18:20:36.417294 [debug] [Thread-1 (]: Using snowflake connection "model.takehome_wh.stg_product__devices"
[0m18:20:36.417594 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__devices: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.stg_product__devices"} */
create or replace   view takehome_db.takehome_schema.stg_product__devices
  
   as (
    with
    devices as (select * from read_replica.product.device),

    final as (
        select
            id as pk_device_id,
            type as device_type,
            store_id,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from
            devices
    )

select *
from final
  );
[0m18:20:36.417829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:20:36.922206 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.504 seconds
[0m18:20:36.940930 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__devices: Close
[0m18:20:37.088123 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3500ea29-3e10-4674-a193-eedea138710e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aff5b0>]}
[0m18:20:37.088855 [info ] [Thread-1 (]: 1 of 1 OK created sql view model takehome_schema.stg_product__devices .......... [[32mSUCCESS 1[0m in 0.71s]
[0m18:20:37.089377 [debug] [Thread-1 (]: Finished running node model.takehome_wh.stg_product__devices
[0m18:20:37.090325 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:20:37.090605 [debug] [MainThread]: Connection 'model.takehome_wh.stg_product__devices' was properly closed.
[0m18:20:37.090848 [info ] [MainThread]: 
[0m18:20:37.091136 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.17 seconds (2.17s).
[0m18:20:37.091611 [debug] [MainThread]: Command end result
[0m18:20:37.117130 [info ] [MainThread]: 
[0m18:20:37.117490 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:20:37.117686 [info ] [MainThread]: 
[0m18:20:37.117894 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:20:37.120287 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.9158232, "process_user_time": 1.441575, "process_kernel_time": 0.215912, "process_mem_max_rss": "146030592", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:20:37.120825 [debug] [MainThread]: Command `dbt run` succeeded at 18:20:37.120755 after 2.92 seconds
[0m18:20:37.121091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066d3d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109054c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106830a00>]}
[0m18:20:37.121339 [debug] [MainThread]: Flushing usage events
[0m18:23:53.604227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104823c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c9fe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c9f7c0>]}


============================== 18:23:53.608176 | 02aaf4a1-9b43-44fc-8096-e998a2fc9c80 ==============================
[0m18:23:53.608176 [info ] [MainThread]: Running with dbt=1.8.8
[0m18:23:53.608546 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cedric.conol/Documents/takehome/', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/cedric.conol/Documents/takehome/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt build -m stg_product__devices', 'target_path': 'target', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:23:53.872998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02aaf4a1-9b43-44fc-8096-e998a2fc9c80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118b3a800>]}
[0m18:23:53.902136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02aaf4a1-9b43-44fc-8096-e998a2fc9c80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118b3a9b0>]}
[0m18:23:53.902867 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:23:53.917848 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m18:23:54.028808 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:23:54.029214 [debug] [MainThread]: Partial parsing: updated file: takehome_wh://models/staging/_stg_product__models.yml
[0m18:23:54.143068 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.takehome_wh.marts
[0m18:23:54.151408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02aaf4a1-9b43-44fc-8096-e998a2fc9c80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119015ba0>]}
[0m18:23:54.293669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02aaf4a1-9b43-44fc-8096-e998a2fc9c80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1191731c0>]}
[0m18:23:54.294097 [info ] [MainThread]: Found 3 models, 2 data tests, 3 sources, 570 macros
[0m18:23:54.294886 [info ] [MainThread]: 
[0m18:23:54.295207 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:23:54.295638 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_takehome_db'
[0m18:23:54.303890 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db"
[0m18:23:54.304231 [debug] [ThreadPool]: On list_takehome_db: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db"} */
show terse schemas in database takehome_db
    limit 10000
[0m18:23:54.304427 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:23:54.960455 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.656 seconds
[0m18:23:54.964158 [debug] [ThreadPool]: On list_takehome_db: Close
[0m18:23:55.141528 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome_db, now list_takehome_db_takehome_schema)
[0m18:23:55.153257 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db_takehome_schema"
[0m18:23:55.153900 [debug] [ThreadPool]: On list_takehome_db_takehome_schema: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db_takehome_schema"} */
show objects in takehome_db.takehome_schema limit 10000
[0m18:23:55.154250 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:23:55.625912 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.472 seconds
[0m18:23:55.627732 [debug] [ThreadPool]: On list_takehome_db_takehome_schema: Close
[0m18:23:55.787550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02aaf4a1-9b43-44fc-8096-e998a2fc9c80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119173bb0>]}
[0m18:23:55.790411 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:23:55.791720 [info ] [MainThread]: 
[0m18:23:55.798229 [debug] [Thread-1 (]: Began running node model.takehome_wh.stg_product__devices
[0m18:23:55.803304 [info ] [Thread-1 (]: 1 of 3 START sql view model takehome_schema.stg_product__devices ............... [RUN]
[0m18:23:55.806810 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_takehome_db_takehome_schema, now model.takehome_wh.stg_product__devices)
[0m18:23:55.807432 [debug] [Thread-1 (]: Began compiling node model.takehome_wh.stg_product__devices
[0m18:23:55.819656 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome_wh.stg_product__devices"
[0m18:23:55.820693 [debug] [Thread-1 (]: Began executing node model.takehome_wh.stg_product__devices
[0m18:23:55.844477 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome_wh.stg_product__devices"
[0m18:23:55.845754 [debug] [Thread-1 (]: Using snowflake connection "model.takehome_wh.stg_product__devices"
[0m18:23:55.846016 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__devices: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.stg_product__devices"} */
create or replace   view takehome_db.takehome_schema.stg_product__devices
  
   as (
    with
    devices as (select * from read_replica.product.device),

    final as (
        select
            id as pk_device_id,
            type as device_type,
            store_id,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from
            devices
    )

select *
from final
  );
[0m18:23:55.846248 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:23:56.467759 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.621 seconds
[0m18:23:56.502334 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__devices: Close
[0m18:23:56.688296 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02aaf4a1-9b43-44fc-8096-e998a2fc9c80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119114250>]}
[0m18:23:56.690658 [info ] [Thread-1 (]: 1 of 3 OK created sql view model takehome_schema.stg_product__devices .......... [[32mSUCCESS 1[0m in 0.88s]
[0m18:23:56.692155 [debug] [Thread-1 (]: Finished running node model.takehome_wh.stg_product__devices
[0m18:23:56.693682 [debug] [Thread-2 (]: Began running node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m18:23:56.694473 [debug] [Thread-1 (]: Began running node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m18:23:56.695308 [info ] [Thread-2 (]: 2 of 3 START test not_null_stg_product__devices_pk_device_id ................... [RUN]
[0m18:23:56.696049 [info ] [Thread-1 (]: 3 of 3 START test unique_stg_product__devices_pk_device_id ..................... [RUN]
[0m18:23:56.698148 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941'
[0m18:23:56.699796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.takehome_wh.stg_product__devices, now test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505)
[0m18:23:56.700432 [debug] [Thread-2 (]: Began compiling node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m18:23:56.700996 [debug] [Thread-1 (]: Began compiling node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m18:23:56.719370 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"
[0m18:23:56.729366 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"
[0m18:23:56.732156 [debug] [Thread-1 (]: Began executing node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m18:23:56.732737 [debug] [Thread-2 (]: Began executing node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m18:23:56.745547 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"
[0m18:23:56.749243 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"
[0m18:23:56.750564 [debug] [Thread-2 (]: Using snowflake connection "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"
[0m18:23:56.750886 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pk_device_id
from takehome_db.takehome_schema.stg_product__devices
where pk_device_id is null



      
    ) dbt_internal_test
[0m18:23:56.751407 [debug] [Thread-1 (]: Using snowflake connection "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"
[0m18:23:56.751695 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:23:56.751973 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    pk_device_id as unique_field,
    count(*) as n_records

from takehome_db.takehome_schema.stg_product__devices
where pk_device_id is not null
group by pk_device_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:23:56.752562 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:23:57.433961 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.682 seconds
[0m18:23:57.443237 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941: Close
[0m18:23:57.527978 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.775 seconds
[0m18:23:57.534901 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505: Close
[0m18:23:57.629909 [info ] [Thread-2 (]: 2 of 3 PASS not_null_stg_product__devices_pk_device_id ......................... [[32mPASS[0m in 0.93s]
[0m18:23:57.632490 [debug] [Thread-2 (]: Finished running node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m18:23:57.704747 [info ] [Thread-1 (]: 3 of 3 PASS unique_stg_product__devices_pk_device_id ........................... [[32mPASS[0m in 1.00s]
[0m18:23:57.707483 [debug] [Thread-1 (]: Finished running node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m18:23:57.709017 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:23:57.709653 [debug] [MainThread]: Connection 'test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505' was properly closed.
[0m18:23:57.710136 [debug] [MainThread]: Connection 'test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941' was properly closed.
[0m18:23:57.710699 [info ] [MainThread]: 
[0m18:23:57.711259 [info ] [MainThread]: Finished running 1 view model, 2 data tests in 0 hours 0 minutes and 3.42 seconds (3.42s).
[0m18:23:57.712620 [debug] [MainThread]: Command end result
[0m18:23:57.754074 [info ] [MainThread]: 
[0m18:23:57.754571 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:23:57.755450 [info ] [MainThread]: 
[0m18:23:57.757375 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:23:57.759218 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 4.20696, "process_user_time": 1.67149, "process_kernel_time": 0.285967, "process_mem_max_rss": "163266560", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:23:57.759643 [debug] [MainThread]: Command `dbt build` succeeded at 18:23:57.759586 after 4.21 seconds
[0m18:23:57.759983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104823c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fd9540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118feaf80>]}
[0m18:23:57.760283 [debug] [MainThread]: Flushing usage events
[0m18:24:21.579103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1025d3d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f4ff40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f4f880>]}


============================== 18:24:21.581735 | 02677a5a-f322-4a72-b296-585282f69a90 ==============================
[0m18:24:21.581735 [info ] [MainThread]: Running with dbt=1.8.8
[0m18:24:21.582080 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/cedric.conol/Documents/takehome/logs', 'profiles_dir': '/Users/cedric.conol/Documents/takehome/', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build -m stg_product__stores', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'target', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:24:21.857815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02677a5a-f322-4a72-b296-585282f69a90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103eb7f10>]}
[0m18:24:21.886690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02677a5a-f322-4a72-b296-585282f69a90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ba0a90>]}
[0m18:24:21.887693 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:24:21.901451 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m18:24:22.003542 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:24:22.004031 [debug] [MainThread]: Partial parsing: updated file: takehome_wh://models/staging/_stg_product__models.yml
[0m18:24:22.163023 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:24:22.163755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '02677a5a-f322-4a72-b296-585282f69a90', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f99db0>]}
[0m18:24:22.247320 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.takehome_wh.marts
[0m18:24:22.255137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02677a5a-f322-4a72-b296-585282f69a90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051d0130>]}
[0m18:24:22.328174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02677a5a-f322-4a72-b296-585282f69a90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051eac20>]}
[0m18:24:22.328495 [info ] [MainThread]: Found 3 models, 4 data tests, 3 sources, 570 macros
[0m18:24:22.329303 [info ] [MainThread]: 
[0m18:24:22.329611 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:24:22.330066 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_takehome_db'
[0m18:24:22.337521 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db"
[0m18:24:22.337796 [debug] [ThreadPool]: On list_takehome_db: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db"} */
show terse schemas in database takehome_db
    limit 10000
[0m18:24:22.337981 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:24:22.951876 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.614 seconds
[0m18:24:22.954840 [debug] [ThreadPool]: On list_takehome_db: Close
[0m18:24:23.120176 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome_db, now list_takehome_db_takehome_schema)
[0m18:24:23.136820 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db_takehome_schema"
[0m18:24:23.137510 [debug] [ThreadPool]: On list_takehome_db_takehome_schema: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db_takehome_schema"} */
show objects in takehome_db.takehome_schema limit 10000
[0m18:24:23.137877 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:24:23.712899 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.575 seconds
[0m18:24:23.715827 [debug] [ThreadPool]: On list_takehome_db_takehome_schema: Close
[0m18:24:23.866784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02677a5a-f322-4a72-b296-585282f69a90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051d3c70>]}
[0m18:24:23.867419 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:24:23.867743 [info ] [MainThread]: 
[0m18:24:23.870558 [debug] [Thread-1 (]: Began running node model.takehome_wh.stg_product__stores
[0m18:24:23.871223 [info ] [Thread-1 (]: 1 of 3 START sql view model takehome_schema.stg_product__stores ................ [RUN]
[0m18:24:23.872789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_takehome_db_takehome_schema, now model.takehome_wh.stg_product__stores)
[0m18:24:23.874089 [debug] [Thread-1 (]: Began compiling node model.takehome_wh.stg_product__stores
[0m18:24:23.886206 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome_wh.stg_product__stores"
[0m18:24:23.887625 [debug] [Thread-1 (]: Began executing node model.takehome_wh.stg_product__stores
[0m18:24:23.912538 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome_wh.stg_product__stores"
[0m18:24:23.914947 [debug] [Thread-1 (]: Using snowflake connection "model.takehome_wh.stg_product__stores"
[0m18:24:23.915505 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__stores: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.stg_product__stores"} */
create or replace   view takehome_db.takehome_schema.stg_product__stores
  
   as (
    with
    stores as (select * from read_replica.product.store),

    final as (
        select
            id as pk_store_id,
            name as store_name,
            address as store_address,
            city as store_city,
            country as store_country,
            typology as store_device_typology,
            customer_id,

            created_at as store_created_at,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from
            stores
    )

select *
from final
  );
[0m18:24:23.915884 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:24:24.460720 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.545 seconds
[0m18:24:24.533964 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__stores: Close
[0m18:24:24.696743 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02677a5a-f322-4a72-b296-585282f69a90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a036d0>]}
[0m18:24:24.699790 [info ] [Thread-1 (]: 1 of 3 OK created sql view model takehome_schema.stg_product__stores ........... [[32mSUCCESS 1[0m in 0.82s]
[0m18:24:24.701054 [debug] [Thread-1 (]: Finished running node model.takehome_wh.stg_product__stores
[0m18:24:24.702931 [debug] [Thread-2 (]: Began running node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m18:24:24.703580 [debug] [Thread-1 (]: Began running node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m18:24:24.704315 [info ] [Thread-2 (]: 2 of 3 START test not_null_stg_product__stores_pk_store_id ..................... [RUN]
[0m18:24:24.705111 [info ] [Thread-1 (]: 3 of 3 START test unique_stg_product__stores_pk_store_id ....................... [RUN]
[0m18:24:24.707133 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696'
[0m18:24:24.707861 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.takehome_wh.stg_product__stores, now test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e)
[0m18:24:24.708310 [debug] [Thread-2 (]: Began compiling node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m18:24:24.708573 [debug] [Thread-1 (]: Began compiling node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m18:24:24.726042 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"
[0m18:24:24.732727 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"
[0m18:24:24.733619 [debug] [Thread-1 (]: Began executing node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m18:24:24.733916 [debug] [Thread-2 (]: Began executing node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m18:24:24.749891 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"
[0m18:24:24.752262 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"
[0m18:24:24.753342 [debug] [Thread-2 (]: Using snowflake connection "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"
[0m18:24:24.753905 [debug] [Thread-1 (]: Using snowflake connection "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"
[0m18:24:24.754221 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pk_store_id
from takehome_db.takehome_schema.stg_product__stores
where pk_store_id is null



      
    ) dbt_internal_test
[0m18:24:24.754529 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    pk_store_id as unique_field,
    count(*) as n_records

from takehome_db.takehome_schema.stg_product__stores
where pk_store_id is not null
group by pk_store_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:24:24.754812 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:24:24.755053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:24:25.297852 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.543 seconds
[0m18:24:25.308074 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696: Close
[0m18:24:25.345566 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.590 seconds
[0m18:24:25.349859 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e: Close
[0m18:24:25.484663 [info ] [Thread-2 (]: 2 of 3 PASS not_null_stg_product__stores_pk_store_id ........................... [[32mPASS[0m in 0.78s]
[0m18:24:25.486238 [debug] [Thread-2 (]: Finished running node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m18:24:25.501779 [info ] [Thread-1 (]: 3 of 3 PASS unique_stg_product__stores_pk_store_id ............................. [[32mPASS[0m in 0.79s]
[0m18:24:25.502385 [debug] [Thread-1 (]: Finished running node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m18:24:25.503296 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:24:25.503569 [debug] [MainThread]: Connection 'test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e' was properly closed.
[0m18:24:25.503778 [debug] [MainThread]: Connection 'test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696' was properly closed.
[0m18:24:25.504161 [info ] [MainThread]: 
[0m18:24:25.504477 [info ] [MainThread]: Finished running 1 view model, 2 data tests in 0 hours 0 minutes and 3.17 seconds (3.17s).
[0m18:24:25.507229 [debug] [MainThread]: Command end result
[0m18:24:25.649473 [info ] [MainThread]: 
[0m18:24:25.649868 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:24:25.650069 [info ] [MainThread]: 
[0m18:24:25.650509 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:24:25.653088 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 4.1229134, "process_user_time": 1.738869, "process_kernel_time": 0.256412, "process_mem_max_rss": "145031168", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:24:25.653515 [debug] [MainThread]: Command `dbt build` succeeded at 18:24:25.653463 after 4.12 seconds
[0m18:24:25.653764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1025d3d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062a7cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062a4cd0>]}
[0m18:24:25.654018 [debug] [MainThread]: Flushing usage events
[0m18:31:43.570267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a3bc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043b3f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043b3850>]}


============================== 18:31:43.573545 | ce82c6f8-ce60-46e7-b3dc-7cc8d5221c3d ==============================
[0m18:31:43.573545 [info ] [MainThread]: Running with dbt=1.8.8
[0m18:31:43.573892 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/cedric.conol/Documents/takehome/logs', 'debug': 'False', 'profiles_dir': '/Users/cedric.conol/Documents/takehome/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'target', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:31:43.794519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce82c6f8-ce60-46e7-b3dc-7cc8d5221c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e6a950>]}
[0m18:31:43.820410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce82c6f8-ce60-46e7-b3dc-7cc8d5221c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fa9b40>]}
[0m18:31:43.820975 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:31:43.834778 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m18:31:43.942141 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m18:31:43.942700 [debug] [MainThread]: Partial parsing: updated file: takehome_wh://models/staging/_product__sources.yml
[0m18:31:43.942975 [debug] [MainThread]: Partial parsing: updated file: takehome_wh://models/staging/_stg_product__models.yml
[0m18:31:44.086677 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:31:44.087057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ce82c6f8-ce60-46e7-b3dc-7cc8d5221c3d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051423b0>]}
[0m18:31:44.213945 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.takehome_wh.marts
[0m18:31:44.220501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce82c6f8-ce60-46e7-b3dc-7cc8d5221c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10570a380>]}
[0m18:31:44.301653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce82c6f8-ce60-46e7-b3dc-7cc8d5221c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105383820>]}
[0m18:31:44.301997 [info ] [MainThread]: Found 3 models, 2 data tests, 3 sources, 570 macros
[0m18:31:44.303282 [info ] [MainThread]: 
[0m18:31:44.303973 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:31:44.306483 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_takehome_db'
[0m18:31:44.313781 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db"
[0m18:31:44.314094 [debug] [ThreadPool]: On list_takehome_db: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db"} */
show terse schemas in database takehome_db
    limit 10000
[0m18:31:44.314276 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:44.890446 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.576 seconds
[0m18:31:44.893640 [debug] [ThreadPool]: On list_takehome_db: Close
[0m18:31:45.067779 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome_db, now list_takehome_db_takehome_schema)
[0m18:31:45.085597 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db_takehome_schema"
[0m18:31:45.086233 [debug] [ThreadPool]: On list_takehome_db_takehome_schema: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db_takehome_schema"} */
show objects in takehome_db.takehome_schema limit 10000
[0m18:31:45.087468 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:31:45.584212 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.497 seconds
[0m18:31:45.586018 [debug] [ThreadPool]: On list_takehome_db_takehome_schema: Close
[0m18:31:45.756398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce82c6f8-ce60-46e7-b3dc-7cc8d5221c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102876da0>]}
[0m18:31:45.758018 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:31:45.758826 [info ] [MainThread]: 
[0m18:31:45.764546 [debug] [Thread-1 (]: Began running node model.takehome_wh.stg_product__devices
[0m18:31:45.765398 [debug] [Thread-2 (]: Began running node model.takehome_wh.stg_product__stores
[0m18:31:45.766398 [info ] [Thread-1 (]: 1 of 5 START sql view model takehome_schema.stg_product__devices ............... [RUN]
[0m18:31:45.767066 [info ] [Thread-2 (]: 2 of 5 START sql view model takehome_schema.stg_product__stores ................ [RUN]
[0m18:31:45.767746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_takehome_db_takehome_schema, now model.takehome_wh.stg_product__devices)
[0m18:31:45.768354 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.takehome_wh.stg_product__stores'
[0m18:31:45.769258 [debug] [Thread-1 (]: Began compiling node model.takehome_wh.stg_product__devices
[0m18:31:45.770619 [debug] [Thread-2 (]: Began compiling node model.takehome_wh.stg_product__stores
[0m18:31:45.783385 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome_wh.stg_product__devices"
[0m18:31:45.788912 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome_wh.stg_product__stores"
[0m18:31:45.789621 [debug] [Thread-1 (]: Began executing node model.takehome_wh.stg_product__devices
[0m18:31:45.789871 [debug] [Thread-2 (]: Began executing node model.takehome_wh.stg_product__stores
[0m18:31:45.809145 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome_wh.stg_product__devices"
[0m18:31:45.814696 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome_wh.stg_product__stores"
[0m18:31:45.815714 [debug] [Thread-1 (]: Using snowflake connection "model.takehome_wh.stg_product__devices"
[0m18:31:45.816276 [debug] [Thread-2 (]: Using snowflake connection "model.takehome_wh.stg_product__stores"
[0m18:31:45.816542 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__devices: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.stg_product__devices"} */
create or replace   view takehome_db.takehome_schema.stg_product__devices
  
   as (
    with
    devices as (select * from read_replica.product.device),

    final as (
        select
            id as pk_device_id,
            type as device_type,
            store_id,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from
            devices
    )

select *
from final
  );
[0m18:31:45.816795 [debug] [Thread-2 (]: On model.takehome_wh.stg_product__stores: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.stg_product__stores"} */
create or replace   view takehome_db.takehome_schema.stg_product__stores
  
   as (
    with
    stores as (select * from read_replica.product.store),

    final as (
        select
            id as pk_store_id,
            name as store_name,
            address as store_address,
            city as store_city,
            country as store_country,
            typology as store_device_typology,
            customer_id,

            created_at as store_created_at,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from
            stores
    )

select *
from final
  );
[0m18:31:45.817052 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:45.817270 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:31:46.395962 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.577 seconds
[0m18:31:46.445877 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__devices: Close
[0m18:31:46.447370 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.630 seconds
[0m18:31:46.450469 [debug] [Thread-2 (]: On model.takehome_wh.stg_product__stores: Close
[0m18:31:46.605388 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce82c6f8-ce60-46e7-b3dc-7cc8d5221c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037d8f10>]}
[0m18:31:46.607216 [info ] [Thread-2 (]: 2 of 5 OK created sql view model takehome_schema.stg_product__stores ........... [[32mSUCCESS 1[0m in 0.83s]
[0m18:31:46.608698 [debug] [Thread-2 (]: Finished running node model.takehome_wh.stg_product__stores
[0m18:31:46.609714 [debug] [Thread-2 (]: Began running node model.takehome_wh.stg_product__transactions
[0m18:31:46.611118 [info ] [Thread-2 (]: 3 of 5 START sql view model takehome_schema.stg_product__transactions .......... [RUN]
[0m18:31:46.612969 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome_wh.stg_product__stores, now model.takehome_wh.stg_product__transactions)
[0m18:31:46.614320 [debug] [Thread-2 (]: Began compiling node model.takehome_wh.stg_product__transactions
[0m18:31:46.623330 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome_wh.stg_product__transactions"
[0m18:31:46.624629 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce82c6f8-ce60-46e7-b3dc-7cc8d5221c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106497070>]}
[0m18:31:46.625966 [info ] [Thread-1 (]: 1 of 5 OK created sql view model takehome_schema.stg_product__devices .......... [[32mSUCCESS 1[0m in 0.86s]
[0m18:31:46.626817 [debug] [Thread-1 (]: Finished running node model.takehome_wh.stg_product__devices
[0m18:31:46.627404 [debug] [Thread-1 (]: Began running node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m18:31:46.629787 [debug] [Thread-2 (]: Began executing node model.takehome_wh.stg_product__transactions
[0m18:31:46.628778 [info ] [Thread-1 (]: 4 of 5 START test not_null_stg_product__stores_pk_store_id ..................... [RUN]
[0m18:31:46.633799 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome_wh.stg_product__transactions"
[0m18:31:46.634328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.takehome_wh.stg_product__devices, now test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696)
[0m18:31:46.634834 [debug] [Thread-1 (]: Began compiling node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m18:31:46.648249 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"
[0m18:31:46.649655 [debug] [Thread-2 (]: Using snowflake connection "model.takehome_wh.stg_product__transactions"
[0m18:31:46.650022 [debug] [Thread-2 (]: On model.takehome_wh.stg_product__transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.stg_product__transactions"} */
create or replace   view takehome_db.takehome_schema.stg_product__transactions
  
   as (
    with
    transactions as (select * from read_replica.product.transactions),

    final as (
        select
            id as pk_transaction_id,
            device_id,
            product_name as transaction_product_name,
            product_sku as transaction_product_sku,
            amount as transaction_amount_eur,
            status as transaction_status,

            -- ideally, sensitive information such as credit card numbers
            -- and CVVs should not be stored in a data warehouse
            -- these sensitive information will not be included in downstream
            -- models in this project
            
            -- if an analysis requires these two fields, and product
            -- database remain unencrypted, perform tokenization

            created_at as transaction_created_at,
            happened_at as transaction_happened_at,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from transactions
    )

select *
from final
  );
[0m18:31:46.650369 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:31:46.650665 [debug] [Thread-1 (]: Began executing node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m18:31:46.741382 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"
[0m18:31:46.742743 [debug] [Thread-1 (]: Using snowflake connection "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"
[0m18:31:46.742971 [debug] [Thread-1 (]: On test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pk_store_id
from takehome_db.takehome_schema.stg_product__stores
where pk_store_id is null



      
    ) dbt_internal_test
[0m18:31:46.743166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:47.285108 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.542 seconds
[0m18:31:47.294071 [debug] [Thread-1 (]: On test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696: Close
[0m18:31:47.354975 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.704 seconds
[0m18:31:47.359816 [debug] [Thread-2 (]: On model.takehome_wh.stg_product__transactions: Close
[0m18:31:47.460036 [info ] [Thread-1 (]: 4 of 5 PASS not_null_stg_product__stores_pk_store_id ........................... [[32mPASS[0m in 0.83s]
[0m18:31:47.461749 [debug] [Thread-1 (]: Finished running node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m18:31:47.463129 [debug] [Thread-1 (]: Began running node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m18:31:47.464202 [info ] [Thread-1 (]: 5 of 5 START test unique_stg_product__stores_pk_store_id ....................... [RUN]
[0m18:31:47.465121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696, now test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e)
[0m18:31:47.465810 [debug] [Thread-1 (]: Began compiling node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m18:31:47.478181 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"
[0m18:31:47.481681 [debug] [Thread-1 (]: Began executing node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m18:31:47.485671 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"
[0m18:31:47.488969 [debug] [Thread-1 (]: Using snowflake connection "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"
[0m18:31:47.489488 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    pk_store_id as unique_field,
    count(*) as n_records

from takehome_db.takehome_schema.stg_product__stores
where pk_store_id is not null
group by pk_store_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:31:47.489860 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:47.524097 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce82c6f8-ce60-46e7-b3dc-7cc8d5221c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106450be0>]}
[0m18:31:47.525419 [info ] [Thread-2 (]: 3 of 5 OK created sql view model takehome_schema.stg_product__transactions ..... [[32mSUCCESS 1[0m in 0.91s]
[0m18:31:47.526109 [debug] [Thread-2 (]: Finished running node model.takehome_wh.stg_product__transactions
[0m18:31:48.014995 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.525 seconds
[0m18:31:48.018691 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e: Close
[0m18:31:48.205672 [info ] [Thread-1 (]: 5 of 5 PASS unique_stg_product__stores_pk_store_id ............................. [[32mPASS[0m in 0.74s]
[0m18:31:48.207346 [debug] [Thread-1 (]: Finished running node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m18:31:48.209927 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:31:48.210618 [debug] [MainThread]: Connection 'test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e' was properly closed.
[0m18:31:48.211197 [debug] [MainThread]: Connection 'model.takehome_wh.stg_product__transactions' was properly closed.
[0m18:31:48.212107 [info ] [MainThread]: 
[0m18:31:48.213461 [info ] [MainThread]: Finished running 3 view models, 2 data tests in 0 hours 0 minutes and 3.91 seconds (3.91s).
[0m18:31:48.215479 [debug] [MainThread]: Command end result
[0m18:31:48.260310 [info ] [MainThread]: 
[0m18:31:48.260826 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:31:48.261072 [info ] [MainThread]: 
[0m18:31:48.262215 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m18:31:48.264495 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 4.7408967, "process_user_time": 1.911065, "process_kernel_time": 0.306566, "process_mem_max_rss": "146620416", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:31:48.264926 [debug] [MainThread]: Command `dbt build` succeeded at 18:31:48.264867 after 4.74 seconds
[0m18:31:48.265213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a3bc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10643b6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10643be20>]}
[0m18:31:48.265518 [debug] [MainThread]: Flushing usage events
[0m18:32:10.525167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10696bd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11089bfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11089b8b0>]}


============================== 18:32:10.527969 | ea717bed-e2c8-438f-89bf-457f8e911f8f ==============================
[0m18:32:10.527969 [info ] [MainThread]: Running with dbt=1.8.8
[0m18:32:10.528351 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/cedric.conol/Documents/takehome/logs', 'version_check': 'True', 'profiles_dir': '/Users/cedric.conol/Documents/takehome/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build', 'target_path': 'target', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:32:10.734097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea717bed-e2c8-438f-89bf-457f8e911f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111607040>]}
[0m18:32:10.761123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea717bed-e2c8-438f-89bf-457f8e911f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105607f0>]}
[0m18:32:10.761865 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:32:10.776291 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m18:32:10.877782 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:32:10.878284 [debug] [MainThread]: Partial parsing: updated file: takehome_wh://models/staging/_stg_product__models.yml
[0m18:32:11.148002 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.takehome_wh.marts
[0m18:32:11.156433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea717bed-e2c8-438f-89bf-457f8e911f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ed0610>]}
[0m18:32:11.234066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea717bed-e2c8-438f-89bf-457f8e911f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111eedc30>]}
[0m18:32:11.234417 [info ] [MainThread]: Found 3 models, 6 data tests, 3 sources, 570 macros
[0m18:32:11.235528 [info ] [MainThread]: 
[0m18:32:11.235848 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:32:11.238705 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_takehome_db'
[0m18:32:11.246359 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db"
[0m18:32:11.246680 [debug] [ThreadPool]: On list_takehome_db: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db"} */
show terse schemas in database takehome_db
    limit 10000
[0m18:32:11.246881 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:32:11.840619 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.594 seconds
[0m18:32:11.845267 [debug] [ThreadPool]: On list_takehome_db: Close
[0m18:32:12.022412 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome_db, now list_takehome_db_takehome_schema)
[0m18:32:12.040097 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db_takehome_schema"
[0m18:32:12.041319 [debug] [ThreadPool]: On list_takehome_db_takehome_schema: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db_takehome_schema"} */
show objects in takehome_db.takehome_schema limit 10000
[0m18:32:12.042647 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:32:12.625792 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.584 seconds
[0m18:32:12.629981 [debug] [ThreadPool]: On list_takehome_db_takehome_schema: Close
[0m18:32:12.813476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea717bed-e2c8-438f-89bf-457f8e911f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067ffe20>]}
[0m18:32:12.815074 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:32:12.817744 [info ] [MainThread]: 
[0m18:32:12.822157 [debug] [Thread-1 (]: Began running node model.takehome_wh.stg_product__devices
[0m18:32:12.822776 [debug] [Thread-2 (]: Began running node model.takehome_wh.stg_product__stores
[0m18:32:12.823692 [info ] [Thread-1 (]: 1 of 9 START sql view model takehome_schema.stg_product__devices ............... [RUN]
[0m18:32:12.827147 [info ] [Thread-2 (]: 2 of 9 START sql view model takehome_schema.stg_product__stores ................ [RUN]
[0m18:32:12.827832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_takehome_db_takehome_schema, now model.takehome_wh.stg_product__devices)
[0m18:32:12.828340 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.takehome_wh.stg_product__stores'
[0m18:32:12.828985 [debug] [Thread-1 (]: Began compiling node model.takehome_wh.stg_product__devices
[0m18:32:12.829297 [debug] [Thread-2 (]: Began compiling node model.takehome_wh.stg_product__stores
[0m18:32:12.840406 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome_wh.stg_product__devices"
[0m18:32:12.846327 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome_wh.stg_product__stores"
[0m18:32:12.847336 [debug] [Thread-1 (]: Began executing node model.takehome_wh.stg_product__devices
[0m18:32:12.847626 [debug] [Thread-2 (]: Began executing node model.takehome_wh.stg_product__stores
[0m18:32:12.881223 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome_wh.stg_product__stores"
[0m18:32:12.884993 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome_wh.stg_product__devices"
[0m18:32:12.888992 [debug] [Thread-2 (]: Using snowflake connection "model.takehome_wh.stg_product__stores"
[0m18:32:12.889611 [debug] [Thread-1 (]: Using snowflake connection "model.takehome_wh.stg_product__devices"
[0m18:32:12.890065 [debug] [Thread-2 (]: On model.takehome_wh.stg_product__stores: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.stg_product__stores"} */
create or replace   view takehome_db.takehome_schema.stg_product__stores
  
   as (
    with
    stores as (select * from read_replica.product.store),

    final as (
        select
            id as pk_store_id,
            name as store_name,
            address as store_address,
            city as store_city,
            country as store_country,
            typology as store_device_typology,
            customer_id,

            created_at as store_created_at,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from
            stores
    )

select *
from final
  );
[0m18:32:12.890842 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__devices: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.stg_product__devices"} */
create or replace   view takehome_db.takehome_schema.stg_product__devices
  
   as (
    with
    devices as (select * from read_replica.product.device),

    final as (
        select
            id as pk_device_id,
            type as device_type,
            store_id,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from
            devices
    )

select *
from final
  );
[0m18:32:12.891091 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:32:12.893864 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:32:13.489193 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.596 seconds
[0m18:32:13.530068 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__devices: Close
[0m18:32:13.530936 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.640 seconds
[0m18:32:13.533995 [debug] [Thread-2 (]: On model.takehome_wh.stg_product__stores: Close
[0m18:32:13.708446 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea717bed-e2c8-438f-89bf-457f8e911f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cfd540>]}
[0m18:32:13.710419 [info ] [Thread-2 (]: 2 of 9 OK created sql view model takehome_schema.stg_product__stores ........... [[32mSUCCESS 1[0m in 0.88s]
[0m18:32:13.711680 [debug] [Thread-2 (]: Finished running node model.takehome_wh.stg_product__stores
[0m18:32:13.712423 [debug] [Thread-2 (]: Began running node model.takehome_wh.stg_product__transactions
[0m18:32:13.713857 [info ] [Thread-2 (]: 3 of 9 START sql view model takehome_schema.stg_product__transactions .......... [RUN]
[0m18:32:13.714586 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome_wh.stg_product__stores, now model.takehome_wh.stg_product__transactions)
[0m18:32:13.715098 [debug] [Thread-2 (]: Began compiling node model.takehome_wh.stg_product__transactions
[0m18:32:13.721635 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome_wh.stg_product__transactions"
[0m18:32:13.723611 [debug] [Thread-2 (]: Began executing node model.takehome_wh.stg_product__transactions
[0m18:32:13.727386 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome_wh.stg_product__transactions"
[0m18:32:13.729851 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea717bed-e2c8-438f-89bf-457f8e911f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cfc280>]}
[0m18:32:13.730895 [info ] [Thread-1 (]: 1 of 9 OK created sql view model takehome_schema.stg_product__devices .......... [[32mSUCCESS 1[0m in 0.90s]
[0m18:32:13.731565 [debug] [Thread-1 (]: Finished running node model.takehome_wh.stg_product__devices
[0m18:32:13.732031 [debug] [Thread-1 (]: Began running node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m18:32:13.733252 [debug] [Thread-2 (]: Using snowflake connection "model.takehome_wh.stg_product__transactions"
[0m18:32:13.733764 [info ] [Thread-1 (]: 4 of 9 START test not_null_stg_product__stores_pk_store_id ..................... [RUN]
[0m18:32:13.734312 [debug] [Thread-2 (]: On model.takehome_wh.stg_product__transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.stg_product__transactions"} */
create or replace   view takehome_db.takehome_schema.stg_product__transactions
  
   as (
    with
    transactions as (select * from read_replica.product.transactions),

    final as (
        select
            id as pk_transaction_id,
            device_id,
            product_name as transaction_product_name,
            product_sku as transaction_product_sku,
            amount as transaction_amount_eur,
            status as transaction_status,

            -- ideally, sensitive information such as credit card numbers
            -- and CVVs should not be stored in a data warehouse
            -- these sensitive information will not be included in downstream
            -- models in this project
            
            -- if an analysis requires these two fields, and product
            -- database remain unencrypted, perform tokenization

            created_at as transaction_created_at,
            happened_at as transaction_happened_at,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from transactions
    )

select *
from final
  );
[0m18:32:13.734835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.takehome_wh.stg_product__devices, now test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696)
[0m18:32:13.735180 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:32:13.735509 [debug] [Thread-1 (]: Began compiling node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m18:32:13.749109 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"
[0m18:32:13.750566 [debug] [Thread-1 (]: Began executing node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m18:32:13.765080 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"
[0m18:32:13.766208 [debug] [Thread-1 (]: Using snowflake connection "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"
[0m18:32:13.766528 [debug] [Thread-1 (]: On test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pk_store_id
from takehome_db.takehome_schema.stg_product__stores
where pk_store_id is null



      
    ) dbt_internal_test
[0m18:32:13.766786 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:32:14.256264 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.490 seconds
[0m18:32:14.262449 [debug] [Thread-1 (]: On test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696: Close
[0m18:32:14.423566 [info ] [Thread-1 (]: 4 of 9 PASS not_null_stg_product__stores_pk_store_id ........................... [[32mPASS[0m in 0.69s]
[0m18:32:14.424624 [debug] [Thread-1 (]: Finished running node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m18:32:14.425135 [debug] [Thread-1 (]: Began running node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m18:32:14.425738 [info ] [Thread-1 (]: 5 of 9 START test unique_stg_product__stores_pk_store_id ....................... [RUN]
[0m18:32:14.426951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696, now test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e)
[0m18:32:14.428494 [debug] [Thread-1 (]: Began compiling node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m18:32:14.439148 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"
[0m18:32:14.440218 [debug] [Thread-1 (]: Began executing node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m18:32:14.445006 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"
[0m18:32:14.446283 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.712 seconds
[0m18:32:14.447972 [debug] [Thread-2 (]: On model.takehome_wh.stg_product__transactions: Close
[0m18:32:14.449660 [debug] [Thread-1 (]: Using snowflake connection "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"
[0m18:32:14.450160 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    pk_store_id as unique_field,
    count(*) as n_records

from takehome_db.takehome_schema.stg_product__stores
where pk_store_id is not null
group by pk_store_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:32:14.450895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:32:14.620851 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea717bed-e2c8-438f-89bf-457f8e911f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131a9ff0>]}
[0m18:32:14.622000 [info ] [Thread-2 (]: 3 of 9 OK created sql view model takehome_schema.stg_product__transactions ..... [[32mSUCCESS 1[0m in 0.91s]
[0m18:32:14.622837 [debug] [Thread-2 (]: Finished running node model.takehome_wh.stg_product__transactions
[0m18:32:14.623405 [debug] [Thread-2 (]: Began running node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m18:32:14.624175 [info ] [Thread-2 (]: 6 of 9 START test not_null_stg_product__devices_pk_device_id ................... [RUN]
[0m18:32:14.624884 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome_wh.stg_product__transactions, now test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941)
[0m18:32:14.625399 [debug] [Thread-2 (]: Began compiling node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m18:32:14.631908 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"
[0m18:32:14.633213 [debug] [Thread-2 (]: Began executing node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m18:32:14.637836 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"
[0m18:32:14.639215 [debug] [Thread-2 (]: Using snowflake connection "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"
[0m18:32:14.639616 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pk_device_id
from takehome_db.takehome_schema.stg_product__devices
where pk_device_id is null



      
    ) dbt_internal_test
[0m18:32:14.639989 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:32:14.939043 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.488 seconds
[0m18:32:14.944339 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e: Close
[0m18:32:15.109457 [info ] [Thread-1 (]: 5 of 9 PASS unique_stg_product__stores_pk_store_id ............................. [[32mPASS[0m in 0.68s]
[0m18:32:15.111941 [debug] [Thread-1 (]: Finished running node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m18:32:15.112960 [debug] [Thread-1 (]: Began running node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m18:32:15.114035 [info ] [Thread-1 (]: 7 of 9 START test unique_stg_product__devices_pk_device_id ..................... [RUN]
[0m18:32:15.115230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e, now test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505)
[0m18:32:15.116001 [debug] [Thread-1 (]: Began compiling node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m18:32:15.125976 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"
[0m18:32:15.128693 [debug] [Thread-1 (]: Began executing node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m18:32:15.132446 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"
[0m18:32:15.133769 [debug] [Thread-1 (]: Using snowflake connection "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"
[0m18:32:15.134233 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    pk_device_id as unique_field,
    count(*) as n_records

from takehome_db.takehome_schema.stg_product__devices
where pk_device_id is not null
group by pk_device_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:32:15.134663 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:32:15.183949 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.544 seconds
[0m18:32:15.187511 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941: Close
[0m18:32:15.363735 [info ] [Thread-2 (]: 6 of 9 PASS not_null_stg_product__devices_pk_device_id ......................... [[32mPASS[0m in 0.74s]
[0m18:32:15.364378 [debug] [Thread-2 (]: Finished running node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m18:32:15.364687 [debug] [Thread-2 (]: Began running node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m18:32:15.365040 [info ] [Thread-2 (]: 8 of 9 START test not_null_stg_product__transactions_pk_transaction_id ......... [RUN]
[0m18:32:15.365404 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941, now test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc)
[0m18:32:15.365674 [debug] [Thread-2 (]: Began compiling node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m18:32:15.369931 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"
[0m18:32:15.370924 [debug] [Thread-2 (]: Began executing node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m18:32:15.372792 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"
[0m18:32:15.373603 [debug] [Thread-2 (]: Using snowflake connection "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"
[0m18:32:15.373851 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pk_transaction_id
from takehome_db.takehome_schema.stg_product__transactions
where pk_transaction_id is null



      
    ) dbt_internal_test
[0m18:32:15.374079 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:32:15.622659 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.488 seconds
[0m18:32:15.625833 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505: Close
[0m18:32:15.795348 [info ] [Thread-1 (]: 7 of 9 PASS unique_stg_product__devices_pk_device_id ........................... [[32mPASS[0m in 0.68s]
[0m18:32:15.796187 [debug] [Thread-1 (]: Finished running node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m18:32:15.796501 [debug] [Thread-1 (]: Began running node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m18:32:15.796801 [info ] [Thread-1 (]: 9 of 9 START test unique_stg_product__transactions_pk_transaction_id ........... [RUN]
[0m18:32:15.797141 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505, now test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df)
[0m18:32:15.797356 [debug] [Thread-1 (]: Began compiling node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m18:32:15.800427 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"
[0m18:32:15.802855 [debug] [Thread-1 (]: Began executing node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m18:32:15.805467 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"
[0m18:32:15.806570 [debug] [Thread-1 (]: Using snowflake connection "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"
[0m18:32:15.806814 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    pk_transaction_id as unique_field,
    count(*) as n_records

from takehome_db.takehome_schema.stg_product__transactions
where pk_transaction_id is not null
group by pk_transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:32:15.807081 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:32:15.912467 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.539 seconds
[0m18:32:15.913969 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc: Close
[0m18:32:16.080749 [info ] [Thread-2 (]: 8 of 9 PASS not_null_stg_product__transactions_pk_transaction_id ............... [[32mPASS[0m in 0.72s]
[0m18:32:16.081842 [debug] [Thread-2 (]: Finished running node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m18:32:16.388847 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.582 seconds
[0m18:32:16.404056 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df: Close
[0m18:32:16.561354 [info ] [Thread-1 (]: 9 of 9 PASS unique_stg_product__transactions_pk_transaction_id ................. [[32mPASS[0m in 0.76s]
[0m18:32:16.562090 [debug] [Thread-1 (]: Finished running node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m18:32:16.562910 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:32:16.563133 [debug] [MainThread]: Connection 'test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df' was properly closed.
[0m18:32:16.563304 [debug] [MainThread]: Connection 'test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc' was properly closed.
[0m18:32:16.563526 [info ] [MainThread]: 
[0m18:32:16.563737 [info ] [MainThread]: Finished running 3 view models, 6 data tests in 0 hours 0 minutes and 5.33 seconds (5.33s).
[0m18:32:16.564614 [debug] [MainThread]: Command end result
[0m18:32:16.596945 [info ] [MainThread]: 
[0m18:32:16.597451 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:32:16.597682 [info ] [MainThread]: 
[0m18:32:16.597919 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m18:32:16.599797 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 6.129601, "process_user_time": 2.16008, "process_kernel_time": 0.26515, "process_mem_max_rss": "143114240", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:32:16.600239 [debug] [MainThread]: Command `dbt build` succeeded at 18:32:16.600178 after 6.13 seconds
[0m18:32:16.601492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10696bd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a89a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111eedc30>]}
[0m18:32:16.601848 [debug] [MainThread]: Flushing usage events
[0m18:47:01.217859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107007d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10897bdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10897b700>]}


============================== 18:47:01.220963 | 05168ec6-a44a-41d0-a94c-2be4e19359ff ==============================
[0m18:47:01.220963 [info ] [MainThread]: Running with dbt=1.8.8
[0m18:47:01.221301 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cedric.conol/Documents/takehome/', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/cedric.conol/Documents/takehome/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m fct_transactions', 'introspect': 'True', 'target_path': 'target', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:47:01.460841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05168ec6-a44a-41d0-a94c-2be4e19359ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088ea0e0>]}
[0m18:47:01.487777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05168ec6-a44a-41d0-a94c-2be4e19359ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095b9690>]}
[0m18:47:01.488594 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:47:01.502367 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m18:47:01.600274 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m18:47:01.600659 [debug] [MainThread]: Partial parsing: added file: takehome_wh://models/marts/fct_transactions.sql
[0m18:47:01.754376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05168ec6-a44a-41d0-a94c-2be4e19359ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109abd8a0>]}
[0m18:47:01.818117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05168ec6-a44a-41d0-a94c-2be4e19359ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109947b20>]}
[0m18:47:01.818448 [info ] [MainThread]: Found 4 models, 6 data tests, 3 sources, 570 macros
[0m18:47:01.818663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05168ec6-a44a-41d0-a94c-2be4e19359ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109945ae0>]}
[0m18:47:01.819366 [info ] [MainThread]: 
[0m18:47:01.819675 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:47:01.820134 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_takehome_db'
[0m18:47:01.827535 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db"
[0m18:47:01.827858 [debug] [ThreadPool]: On list_takehome_db: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db"} */
show terse schemas in database takehome_db
    limit 10000
[0m18:47:01.828058 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:47:02.845631 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.017 seconds
[0m18:47:02.849095 [debug] [ThreadPool]: On list_takehome_db: Close
[0m18:47:03.018473 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome_db, now list_takehome_db_takehome_schema)
[0m18:47:03.027568 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db_takehome_schema"
[0m18:47:03.028003 [debug] [ThreadPool]: On list_takehome_db_takehome_schema: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db_takehome_schema"} */
show objects in takehome_db.takehome_schema limit 10000
[0m18:47:03.028292 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:47:03.578633 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.550 seconds
[0m18:47:03.583904 [debug] [ThreadPool]: On list_takehome_db_takehome_schema: Close
[0m18:47:03.764742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05168ec6-a44a-41d0-a94c-2be4e19359ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109945ae0>]}
[0m18:47:03.766535 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:47:03.767700 [info ] [MainThread]: 
[0m18:47:03.772296 [debug] [Thread-1 (]: Began running node model.takehome_wh.fct_transactions
[0m18:47:03.773532 [info ] [Thread-1 (]: 1 of 1 START sql table model takehome_schema.fct_transactions .................. [RUN]
[0m18:47:03.775457 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_takehome_db_takehome_schema, now model.takehome_wh.fct_transactions)
[0m18:47:03.776283 [debug] [Thread-1 (]: Began compiling node model.takehome_wh.fct_transactions
[0m18:47:03.787630 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome_wh.fct_transactions"
[0m18:47:03.788961 [debug] [Thread-1 (]: Began executing node model.takehome_wh.fct_transactions
[0m18:47:03.820352 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome_wh.fct_transactions"
[0m18:47:03.822062 [debug] [Thread-1 (]: Using snowflake connection "model.takehome_wh.fct_transactions"
[0m18:47:03.822363 [debug] [Thread-1 (]: On model.takehome_wh.fct_transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.fct_transactions"} */
create or replace transient table takehome_db.takehome_schema.fct_transactions
         as
        (with
    -- import CTEs
    transactions as (select * from takehome_db.takehome_schema.stg_product__transactions),

    stores as (select * from takehome_db.takehome_schema.stg_product__stores),

    devices as (select * from takehome_db.takehome_schema.stg_product__devices),

    -- logical CTEs
    transactions_enriched as (
        select
            transactions.*,
            devices.device_type,
            stores.*
        from transactions
        left join devices on transactions.device_id = devices.pk_device_id
        left join stores on devices.store_id = stores.pk_store_id
    )

select *
from transactions_enriched
        );
[0m18:47:03.822637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:47:04.355461 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b7f7e7-3201-4d35-0000-000ab12a7d31
[0m18:47:04.356629 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002025 (42S21): SQL compilation error:
duplicate column name 'DBT_UPDATED_AT'
[0m18:47:04.357679 [debug] [Thread-1 (]: On model.takehome_wh.fct_transactions: Close
[0m18:47:04.519867 [debug] [Thread-1 (]: Database Error in model fct_transactions (models/marts/fct_transactions.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'DBT_UPDATED_AT'
  compiled code at target/run/takehome_wh/models/marts/fct_transactions.sql
[0m18:47:04.522097 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05168ec6-a44a-41d0-a94c-2be4e19359ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f425f0>]}
[0m18:47:04.522917 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model takehome_schema.fct_transactions ......... [[31mERROR[0m in 0.75s]
[0m18:47:04.523619 [debug] [Thread-1 (]: Finished running node model.takehome_wh.fct_transactions
[0m18:47:04.526758 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:47:04.527464 [debug] [MainThread]: Connection 'model.takehome_wh.fct_transactions' was properly closed.
[0m18:47:04.527866 [info ] [MainThread]: 
[0m18:47:04.528215 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.71 seconds (2.71s).
[0m18:47:04.528836 [debug] [MainThread]: Command end result
[0m18:47:04.562648 [info ] [MainThread]: 
[0m18:47:04.563141 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:47:04.563376 [info ] [MainThread]: 
[0m18:47:04.563676 [error] [MainThread]:   Database Error in model fct_transactions (models/marts/fct_transactions.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'DBT_UPDATED_AT'
  compiled code at target/run/takehome_wh/models/marts/fct_transactions.sql
[0m18:47:04.563887 [info ] [MainThread]: 
[0m18:47:04.564102 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:47:04.566386 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.3971205, "process_user_time": 1.38832, "process_kernel_time": 0.239735, "process_mem_max_rss": "142032896", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:47:04.567058 [debug] [MainThread]: Command `dbt run` failed at 18:47:04.566978 after 3.40 seconds
[0m18:47:04.567924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107007d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095b9690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fa4df0>]}
[0m18:47:04.568360 [debug] [MainThread]: Flushing usage events
[0m20:47:53.862245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067fbca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10955ff40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10955f880>]}


============================== 20:47:53.866172 | 2cac742e-22c3-4418-8841-2b18b203dc00 ==============================
[0m20:47:53.866172 [info ] [MainThread]: Running with dbt=1.8.8
[0m20:47:53.866541 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/cedric.conol/Documents/takehome/', 'log_path': '/Users/cedric.conol/Documents/takehome/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'target', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:47:54.253350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2cac742e-22c3-4418-8841-2b18b203dc00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1dded0>]}
[0m20:47:54.287020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2cac742e-22c3-4418-8841-2b18b203dc00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2ed0c0>]}
[0m20:47:54.287852 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:47:54.309451 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m20:47:54.434063 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m20:47:54.434454 [debug] [MainThread]: Partial parsing: added file: takehome_wh://models/marts/dim_devices.sql
[0m20:47:54.434706 [debug] [MainThread]: Partial parsing: updated file: takehome_wh://models/marts/fct_transactions.sql
[0m20:47:54.617873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2cac742e-22c3-4418-8841-2b18b203dc00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a765390>]}
[0m20:47:54.725857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2cac742e-22c3-4418-8841-2b18b203dc00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a702650>]}
[0m20:47:54.726231 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 570 macros
[0m20:47:54.727512 [info ] [MainThread]: 
[0m20:47:54.727855 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:47:54.732117 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_takehome_db'
[0m20:47:54.741059 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db"
[0m20:47:54.741389 [debug] [ThreadPool]: On list_takehome_db: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db"} */
show terse schemas in database takehome_db
    limit 10000
[0m20:47:54.741575 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:47:55.819942 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.078 seconds
[0m20:47:55.824308 [debug] [ThreadPool]: On list_takehome_db: Close
[0m20:47:56.120618 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome_db, now list_takehome_db_takehome_schema)
[0m20:47:56.133039 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db_takehome_schema"
[0m20:47:56.133538 [debug] [ThreadPool]: On list_takehome_db_takehome_schema: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db_takehome_schema"} */
show objects in takehome_db.takehome_schema limit 10000
[0m20:47:56.133824 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:47:56.871177 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.737 seconds
[0m20:47:56.890661 [debug] [ThreadPool]: On list_takehome_db_takehome_schema: Close
[0m20:47:57.069397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cac742e-22c3-4418-8841-2b18b203dc00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066369b0>]}
[0m20:47:57.070819 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m20:47:57.071601 [info ] [MainThread]: 
[0m20:47:57.076656 [debug] [Thread-1 (]: Began running node model.takehome_wh.stg_product__devices
[0m20:47:57.077431 [debug] [Thread-2 (]: Began running node model.takehome_wh.stg_product__stores
[0m20:47:57.078300 [info ] [Thread-1 (]: 1 of 11 START sql view model takehome_schema.stg_product__devices .............. [RUN]
[0m20:47:57.078908 [info ] [Thread-2 (]: 2 of 11 START sql view model takehome_schema.stg_product__stores ............... [RUN]
[0m20:47:57.080843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_takehome_db_takehome_schema, now model.takehome_wh.stg_product__devices)
[0m20:47:57.082943 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.takehome_wh.stg_product__stores'
[0m20:47:57.083901 [debug] [Thread-1 (]: Began compiling node model.takehome_wh.stg_product__devices
[0m20:47:57.084518 [debug] [Thread-2 (]: Began compiling node model.takehome_wh.stg_product__stores
[0m20:47:57.101288 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome_wh.stg_product__devices"
[0m20:47:57.105915 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome_wh.stg_product__stores"
[0m20:47:57.107292 [debug] [Thread-1 (]: Began executing node model.takehome_wh.stg_product__devices
[0m20:47:57.107715 [debug] [Thread-2 (]: Began executing node model.takehome_wh.stg_product__stores
[0m20:47:57.144627 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome_wh.stg_product__devices"
[0m20:47:57.145469 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome_wh.stg_product__stores"
[0m20:47:57.149478 [debug] [Thread-2 (]: Using snowflake connection "model.takehome_wh.stg_product__stores"
[0m20:47:57.149847 [debug] [Thread-2 (]: On model.takehome_wh.stg_product__stores: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.stg_product__stores"} */
create or replace   view takehome_db.takehome_schema.stg_product__stores
  
   as (
    with
    stores as (select * from read_replica.product.store),

    final as (
        select
            id as pk_store_id,
            name as store_name,
            address as store_address,
            city as store_city,
            country as store_country,
            typology as store_device_typology,
            customer_id,

            created_at as store_created_at,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from
            stores
    )

select *
from final
  );
[0m20:47:57.150092 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:47:57.150649 [debug] [Thread-1 (]: Using snowflake connection "model.takehome_wh.stg_product__devices"
[0m20:47:57.151342 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__devices: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.stg_product__devices"} */
create or replace   view takehome_db.takehome_schema.stg_product__devices
  
   as (
    with
    devices as (select * from read_replica.product.device),

    final as (
        select
            id as pk_device_id,
            type as device_type,
            store_id,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from
            devices
    )

select *
from final
  );
[0m20:47:57.151674 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:47:57.751072 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.599 seconds
[0m20:47:57.782377 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__devices: Close
[0m20:47:57.801364 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.651 seconds
[0m20:47:57.804589 [debug] [Thread-2 (]: On model.takehome_wh.stg_product__stores: Close
[0m20:47:57.941075 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cac742e-22c3-4418-8841-2b18b203dc00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1df670>]}
[0m20:47:57.941735 [info ] [Thread-1 (]: 1 of 11 OK created sql view model takehome_schema.stg_product__devices ......... [[32mSUCCESS 1[0m in 0.86s]
[0m20:47:57.942206 [debug] [Thread-1 (]: Finished running node model.takehome_wh.stg_product__devices
[0m20:47:57.942536 [debug] [Thread-1 (]: Began running node model.takehome_wh.stg_product__transactions
[0m20:47:57.943086 [info ] [Thread-1 (]: 3 of 11 START sql view model takehome_schema.stg_product__transactions ......... [RUN]
[0m20:47:57.943491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.takehome_wh.stg_product__devices, now model.takehome_wh.stg_product__transactions)
[0m20:47:57.943771 [debug] [Thread-1 (]: Began compiling node model.takehome_wh.stg_product__transactions
[0m20:47:57.946464 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome_wh.stg_product__transactions"
[0m20:47:57.948133 [debug] [Thread-1 (]: Began executing node model.takehome_wh.stg_product__transactions
[0m20:47:57.950698 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome_wh.stg_product__transactions"
[0m20:47:57.951946 [debug] [Thread-1 (]: Using snowflake connection "model.takehome_wh.stg_product__transactions"
[0m20:47:57.952244 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.stg_product__transactions"} */
create or replace   view takehome_db.takehome_schema.stg_product__transactions
  
   as (
    with
    transactions as (select * from read_replica.product.transactions),

    final as (
        select
            id as pk_transaction_id,
            device_id,
            product_name as transaction_product_name,
            product_sku as transaction_product_sku,
            amount as transaction_amount_eur,
            status as transaction_status,

            -- ideally, sensitive information such as credit card numbers
            -- and CVVs should not be stored in a data warehouse
            -- these sensitive information will not be included in downstream
            -- models in this project
            
            -- if an analysis requires these two fields, and product
            -- database remain unencrypted, perform tokenization

            created_at as transaction_created_at,
            happened_at as transaction_happened_at,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from transactions
    )

select *
from final
  );
[0m20:47:57.952530 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:47:57.982505 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cac742e-22c3-4418-8841-2b18b203dc00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b94f6d0>]}
[0m20:47:57.983148 [info ] [Thread-2 (]: 2 of 11 OK created sql view model takehome_schema.stg_product__stores .......... [[32mSUCCESS 1[0m in 0.90s]
[0m20:47:57.983581 [debug] [Thread-2 (]: Finished running node model.takehome_wh.stg_product__stores
[0m20:47:57.983887 [debug] [Thread-2 (]: Began running node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m20:47:57.984308 [info ] [Thread-2 (]: 4 of 11 START test not_null_stg_product__devices_pk_device_id .................. [RUN]
[0m20:47:57.984690 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome_wh.stg_product__stores, now test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941)
[0m20:47:57.985001 [debug] [Thread-2 (]: Began compiling node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m20:47:57.993334 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"
[0m20:47:57.994504 [debug] [Thread-2 (]: Began executing node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m20:47:58.006655 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"
[0m20:47:58.007754 [debug] [Thread-2 (]: Using snowflake connection "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"
[0m20:47:58.008006 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pk_device_id
from takehome_db.takehome_schema.stg_product__devices
where pk_device_id is null



      
    ) dbt_internal_test
[0m20:47:58.008234 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:47:58.516067 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.563 seconds
[0m20:47:58.520639 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__transactions: Close
[0m20:47:58.633281 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.625 seconds
[0m20:47:58.643047 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941: Close
[0m20:47:58.676307 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cac742e-22c3-4418-8841-2b18b203dc00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8bc490>]}
[0m20:47:58.678144 [info ] [Thread-1 (]: 3 of 11 OK created sql view model takehome_schema.stg_product__transactions .... [[32mSUCCESS 1[0m in 0.73s]
[0m20:47:58.679121 [debug] [Thread-1 (]: Finished running node model.takehome_wh.stg_product__transactions
[0m20:47:58.679797 [debug] [Thread-1 (]: Began running node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m20:47:58.681749 [info ] [Thread-1 (]: 5 of 11 START test unique_stg_product__devices_pk_device_id .................... [RUN]
[0m20:47:58.683408 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.takehome_wh.stg_product__transactions, now test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505)
[0m20:47:58.684155 [debug] [Thread-1 (]: Began compiling node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m20:47:58.695209 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"
[0m20:47:58.696425 [debug] [Thread-1 (]: Began executing node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m20:47:58.702734 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"
[0m20:47:58.704553 [debug] [Thread-1 (]: Using snowflake connection "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"
[0m20:47:58.705100 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    pk_device_id as unique_field,
    count(*) as n_records

from takehome_db.takehome_schema.stg_product__devices
where pk_device_id is not null
group by pk_device_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:47:58.707739 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:47:58.808696 [info ] [Thread-2 (]: 4 of 11 PASS not_null_stg_product__devices_pk_device_id ........................ [[32mPASS[0m in 0.82s]
[0m20:47:58.809388 [debug] [Thread-2 (]: Finished running node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m20:47:58.809777 [debug] [Thread-2 (]: Began running node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m20:47:58.810216 [info ] [Thread-2 (]: 6 of 11 START test not_null_stg_product__stores_pk_store_id .................... [RUN]
[0m20:47:58.810704 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941, now test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696)
[0m20:47:58.811056 [debug] [Thread-2 (]: Began compiling node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m20:47:58.816502 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"
[0m20:47:58.818236 [debug] [Thread-2 (]: Began executing node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m20:47:58.820767 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"
[0m20:47:58.823135 [debug] [Thread-2 (]: Using snowflake connection "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"
[0m20:47:58.823959 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pk_store_id
from takehome_db.takehome_schema.stg_product__stores
where pk_store_id is null



      
    ) dbt_internal_test
[0m20:47:58.824346 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:47:59.218926 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.511 seconds
[0m20:47:59.225400 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505: Close
[0m20:47:59.327699 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.503 seconds
[0m20:47:59.337375 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696: Close
[0m20:47:59.402735 [info ] [Thread-1 (]: 5 of 11 PASS unique_stg_product__devices_pk_device_id .......................... [[32mPASS[0m in 0.72s]
[0m20:47:59.404513 [debug] [Thread-1 (]: Finished running node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m20:47:59.406853 [debug] [Thread-1 (]: Began running node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m20:47:59.408790 [info ] [Thread-1 (]: 7 of 11 START test unique_stg_product__stores_pk_store_id ...................... [RUN]
[0m20:47:59.409885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505, now test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e)
[0m20:47:59.410758 [debug] [Thread-1 (]: Began compiling node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m20:47:59.419973 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"
[0m20:47:59.424844 [debug] [Thread-1 (]: Began executing node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m20:47:59.428245 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"
[0m20:47:59.430065 [debug] [Thread-1 (]: Using snowflake connection "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"
[0m20:47:59.432943 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    pk_store_id as unique_field,
    count(*) as n_records

from takehome_db.takehome_schema.stg_product__stores
where pk_store_id is not null
group by pk_store_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:47:59.433509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:47:59.509058 [info ] [Thread-2 (]: 6 of 11 PASS not_null_stg_product__stores_pk_store_id .......................... [[32mPASS[0m in 0.70s]
[0m20:47:59.509783 [debug] [Thread-2 (]: Finished running node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m20:47:59.510163 [debug] [Thread-2 (]: Began running node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m20:47:59.510557 [info ] [Thread-2 (]: 8 of 11 START test not_null_stg_product__transactions_pk_transaction_id ........ [RUN]
[0m20:47:59.511105 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696, now test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc)
[0m20:47:59.511493 [debug] [Thread-2 (]: Began compiling node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m20:47:59.520611 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"
[0m20:47:59.522335 [debug] [Thread-2 (]: Began executing node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m20:47:59.525350 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"
[0m20:47:59.526952 [debug] [Thread-2 (]: Using snowflake connection "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"
[0m20:47:59.527378 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pk_transaction_id
from takehome_db.takehome_schema.stg_product__transactions
where pk_transaction_id is null



      
    ) dbt_internal_test
[0m20:47:59.527746 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:48:00.037047 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.603 seconds
[0m20:48:00.049416 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e: Close
[0m20:48:00.117648 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.590 seconds
[0m20:48:00.123339 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc: Close
[0m20:48:00.230792 [info ] [Thread-1 (]: 7 of 11 PASS unique_stg_product__stores_pk_store_id ............................ [[32mPASS[0m in 0.82s]
[0m20:48:00.235766 [debug] [Thread-1 (]: Finished running node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m20:48:00.236984 [debug] [Thread-1 (]: Began running node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m20:48:00.238209 [info ] [Thread-1 (]: 9 of 11 START test unique_stg_product__transactions_pk_transaction_id .......... [RUN]
[0m20:48:00.241224 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e, now test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df)
[0m20:48:00.242068 [debug] [Thread-1 (]: Began compiling node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m20:48:00.251212 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"
[0m20:48:00.252530 [debug] [Thread-1 (]: Began executing node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m20:48:00.256528 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"
[0m20:48:00.258323 [debug] [Thread-1 (]: Using snowflake connection "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"
[0m20:48:00.258736 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    pk_transaction_id as unique_field,
    count(*) as n_records

from takehome_db.takehome_schema.stg_product__transactions
where pk_transaction_id is not null
group by pk_transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:48:00.259068 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:48:00.320567 [info ] [Thread-2 (]: 8 of 11 PASS not_null_stg_product__transactions_pk_transaction_id .............. [[32mPASS[0m in 0.81s]
[0m20:48:00.321922 [debug] [Thread-2 (]: Finished running node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m20:48:00.323176 [debug] [Thread-2 (]: Began running node model.takehome_wh.dim_devices
[0m20:48:00.323925 [info ] [Thread-2 (]: 10 of 11 START sql table model takehome_schema.dim_devices ..................... [RUN]
[0m20:48:00.324596 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc, now model.takehome_wh.dim_devices)
[0m20:48:00.325047 [debug] [Thread-2 (]: Began compiling node model.takehome_wh.dim_devices
[0m20:48:00.329892 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome_wh.dim_devices"
[0m20:48:00.334603 [debug] [Thread-2 (]: Began executing node model.takehome_wh.dim_devices
[0m20:48:00.361756 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome_wh.dim_devices"
[0m20:48:00.365769 [debug] [Thread-2 (]: Using snowflake connection "model.takehome_wh.dim_devices"
[0m20:48:00.366529 [debug] [Thread-2 (]: On model.takehome_wh.dim_devices: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.dim_devices"} */
create or replace transient table takehome_db.takehome_schema.dim_devices
         as
        (with
    -- import CTEs

    stores as (select * from takehome_db.takehome_schema.stg_product__stores),

    devices as (select * from takehome_db.takehome_schema.stg_product__devices),

    -- logical CTEs
    final as (
        select
            devices.pk_device_id,
            devices.device_type,
            stores.store_id,
            stores.store_name,
            stores.store_address,
            stores.store_city,
            stores.store_country,
            stores.store_device_typology,
            stores.store_created_at,
            stores.customer_id,
            
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from devices
        left join stores on devices.store_id = stores.pk_store_id
    )

select *
from final
        );
[0m20:48:00.366979 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:48:00.791941 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.533 seconds
[0m20:48:00.796318 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df: Close
[0m20:48:00.969766 [info ] [Thread-1 (]: 9 of 11 PASS unique_stg_product__transactions_pk_transaction_id ................ [[32mPASS[0m in 0.73s]
[0m20:48:00.971259 [debug] [Thread-1 (]: Finished running node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m20:48:00.973339 [debug] [Thread-1 (]: Began running node model.takehome_wh.fct_transactions
[0m20:48:00.975000 [info ] [Thread-1 (]: 11 of 11 START sql table model takehome_schema.fct_transactions ................ [RUN]
[0m20:48:00.975850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df, now model.takehome_wh.fct_transactions)
[0m20:48:00.976506 [debug] [Thread-1 (]: Began compiling node model.takehome_wh.fct_transactions
[0m20:48:00.985930 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome_wh.fct_transactions"
[0m20:48:00.987536 [debug] [Thread-1 (]: Began executing node model.takehome_wh.fct_transactions
[0m20:48:00.993241 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome_wh.fct_transactions"
[0m20:48:00.995544 [debug] [Thread-1 (]: Using snowflake connection "model.takehome_wh.fct_transactions"
[0m20:48:00.996103 [debug] [Thread-1 (]: On model.takehome_wh.fct_transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.fct_transactions"} */
create or replace transient table takehome_db.takehome_schema.fct_transactions
         as
        (with
    -- import CTEs
    transactions as (select * from takehome_db.takehome_schema.stg_product__transactions),

    stores as (select * from takehome_db.takehome_schema.stg_product__stores),

    devices as (select * from takehome_db.takehome_schema.stg_product__devices),

    -- logical CTEs
    final as (
        select
            transactions.pk_transaction_id,
            transaction_happened_at,
            transaction_status,
            transaction_product_name,
            transaction_product_sku,
            transaction_amount_eur,

            device_id,
            devices.device_type,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from transactions
        left join devices on transactions.device_id = devices.pk_device_id
    )

select *
from final
        );
[0m20:48:00.996552 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:48:01.004844 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01b7f860-3201-4cb6-0000-000ab12aa2ad
[0m20:48:01.006071 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 12
invalid identifier 'STORES.STORE_ID'
[0m20:48:01.006625 [debug] [Thread-2 (]: On model.takehome_wh.dim_devices: Close
[0m20:48:01.162271 [debug] [Thread-2 (]: Database Error in model dim_devices (models/marts/dim_devices.sql)
  000904 (42000): SQL compilation error: error line 15 at position 12
  invalid identifier 'STORES.STORE_ID'
  compiled code at target/run/takehome_wh/models/marts/dim_devices.sql
[0m20:48:01.162936 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cac742e-22c3-4418-8841-2b18b203dc00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a767280>]}
[0m20:48:01.165835 [error] [Thread-2 (]: 10 of 11 ERROR creating sql table model takehome_schema.dim_devices ............ [[31mERROR[0m in 0.84s]
[0m20:48:01.167634 [debug] [Thread-2 (]: Finished running node model.takehome_wh.dim_devices
[0m20:48:02.359407 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.362 seconds
[0m20:48:02.367936 [debug] [Thread-1 (]: On model.takehome_wh.fct_transactions: Close
[0m20:48:02.586095 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cac742e-22c3-4418-8841-2b18b203dc00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cd6950>]}
[0m20:48:02.587453 [info ] [Thread-1 (]: 11 of 11 OK created sql table model takehome_schema.fct_transactions ........... [[32mSUCCESS 1[0m in 1.61s]
[0m20:48:02.589316 [debug] [Thread-1 (]: Finished running node model.takehome_wh.fct_transactions
[0m20:48:02.592145 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:48:02.592484 [debug] [MainThread]: Connection 'model.takehome_wh.fct_transactions' was properly closed.
[0m20:48:02.592715 [debug] [MainThread]: Connection 'model.takehome_wh.dim_devices' was properly closed.
[0m20:48:02.593083 [info ] [MainThread]: 
[0m20:48:02.593496 [info ] [MainThread]: Finished running 3 view models, 6 data tests, 2 table models in 0 hours 0 minutes and 7.87 seconds (7.87s).
[0m20:48:02.595880 [debug] [MainThread]: Command end result
[0m20:48:02.632942 [info ] [MainThread]: 
[0m20:48:02.633402 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:48:02.633655 [info ] [MainThread]: 
[0m20:48:02.633942 [error] [MainThread]:   Database Error in model dim_devices (models/marts/dim_devices.sql)
  000904 (42000): SQL compilation error: error line 15 at position 12
  invalid identifier 'STORES.STORE_ID'
  compiled code at target/run/takehome_wh/models/marts/dim_devices.sql
[0m20:48:02.634184 [info ] [MainThread]: 
[0m20:48:02.634450 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m20:48:02.636257 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 8.836331, "process_user_time": 2.2795, "process_kernel_time": 0.399417, "process_mem_max_rss": "134414336", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:48:02.636788 [debug] [MainThread]: Command `dbt build` failed at 20:48:02.636726 after 8.84 seconds
[0m20:48:02.637089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067fbca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d180d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a744a60>]}
[0m20:48:02.637364 [debug] [MainThread]: Flushing usage events
[0m21:44:14.129364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107823cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114dbf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114db880>]}


============================== 21:44:14.132488 | 18dedebb-9ada-4645-b0ed-671dc79759c0 ==============================
[0m21:44:14.132488 [info ] [MainThread]: Running with dbt=1.8.8
[0m21:44:14.133362 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cedric.conol/Documents/takehome/', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/cedric.conol/Documents/takehome/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build', 'static_parser': 'True', 'target_path': 'target', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:44:14.375617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18dedebb-9ada-4645-b0ed-671dc79759c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125062f0>]}
[0m21:44:14.404568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18dedebb-9ada-4645-b0ed-671dc79759c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111a07c0>]}
[0m21:44:14.405269 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:44:14.419247 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m21:44:14.529069 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m21:44:14.529478 [debug] [MainThread]: Partial parsing: added file: takehome_wh://models/reports/rpt_device_performance.sql
[0m21:44:14.529731 [debug] [MainThread]: Partial parsing: updated file: takehome_wh://models/marts/dim_devices.sql
[0m21:44:14.709266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18dedebb-9ada-4645-b0ed-671dc79759c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a97b20>]}
[0m21:44:14.785787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18dedebb-9ada-4645-b0ed-671dc79759c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b8bb80>]}
[0m21:44:14.786113 [info ] [MainThread]: Found 6 models, 6 data tests, 3 sources, 570 macros
[0m21:44:14.787523 [info ] [MainThread]: 
[0m21:44:14.787917 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:44:14.790529 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_takehome_db'
[0m21:44:14.799251 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db"
[0m21:44:14.799569 [debug] [ThreadPool]: On list_takehome_db: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db"} */
show terse schemas in database takehome_db
    limit 10000
[0m21:44:14.801122 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:44:15.887800 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.087 seconds
[0m21:44:15.890611 [debug] [ThreadPool]: On list_takehome_db: Close
[0m21:44:16.422548 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome_db, now list_takehome_db_takehome_schema)
[0m21:44:16.439518 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db_takehome_schema"
[0m21:44:16.440315 [debug] [ThreadPool]: On list_takehome_db_takehome_schema: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db_takehome_schema"} */
show objects in takehome_db.takehome_schema limit 10000
[0m21:44:16.440749 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:44:17.019060 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.578 seconds
[0m21:44:17.022364 [debug] [ThreadPool]: On list_takehome_db_takehome_schema: Close
[0m21:44:17.189893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18dedebb-9ada-4645-b0ed-671dc79759c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122dec80>]}
[0m21:44:17.194396 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m21:44:17.195354 [info ] [MainThread]: 
[0m21:44:17.199419 [debug] [Thread-1 (]: Began running node model.takehome_wh.stg_product__devices
[0m21:44:17.202150 [debug] [Thread-2 (]: Began running node model.takehome_wh.stg_product__stores
[0m21:44:17.203103 [info ] [Thread-1 (]: 1 of 12 START sql view model takehome_schema.stg_product__devices .............. [RUN]
[0m21:44:17.204005 [info ] [Thread-2 (]: 2 of 12 START sql view model takehome_schema.stg_product__stores ............... [RUN]
[0m21:44:17.205089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_takehome_db_takehome_schema, now model.takehome_wh.stg_product__devices)
[0m21:44:17.205976 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.takehome_wh.stg_product__stores'
[0m21:44:17.207798 [debug] [Thread-1 (]: Began compiling node model.takehome_wh.stg_product__devices
[0m21:44:17.210692 [debug] [Thread-2 (]: Began compiling node model.takehome_wh.stg_product__stores
[0m21:44:17.221006 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome_wh.stg_product__devices"
[0m21:44:17.226692 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome_wh.stg_product__stores"
[0m21:44:17.227791 [debug] [Thread-2 (]: Began executing node model.takehome_wh.stg_product__stores
[0m21:44:17.228042 [debug] [Thread-1 (]: Began executing node model.takehome_wh.stg_product__devices
[0m21:44:17.249059 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome_wh.stg_product__stores"
[0m21:44:17.252710 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome_wh.stg_product__devices"
[0m21:44:17.253825 [debug] [Thread-1 (]: Using snowflake connection "model.takehome_wh.stg_product__devices"
[0m21:44:17.254493 [debug] [Thread-2 (]: Using snowflake connection "model.takehome_wh.stg_product__stores"
[0m21:44:17.254767 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__devices: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.stg_product__devices"} */
create or replace   view takehome_db.takehome_schema.stg_product__devices
  
   as (
    with
    devices as (select * from read_replica.product.device),

    final as (
        select
            id as pk_device_id,
            type as device_type,
            store_id,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from
            devices
    )

select *
from final
  );
[0m21:44:17.255049 [debug] [Thread-2 (]: On model.takehome_wh.stg_product__stores: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.stg_product__stores"} */
create or replace   view takehome_db.takehome_schema.stg_product__stores
  
   as (
    with
    stores as (select * from read_replica.product.store),

    final as (
        select
            id as pk_store_id,
            name as store_name,
            address as store_address,
            city as store_city,
            country as store_country,
            typology as store_device_typology,
            customer_id,

            created_at as store_created_at,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from
            stores
    )

select *
from final
  );
[0m21:44:17.255309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:44:17.255539 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:44:17.826810 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.571 seconds
[0m21:44:17.862738 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__devices: Close
[0m21:44:17.911917 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.656 seconds
[0m21:44:17.915365 [debug] [Thread-2 (]: On model.takehome_wh.stg_product__stores: Close
[0m21:44:18.038073 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18dedebb-9ada-4645-b0ed-671dc79759c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122df6a0>]}
[0m21:44:18.039651 [info ] [Thread-1 (]: 1 of 12 OK created sql view model takehome_schema.stg_product__devices ......... [[32mSUCCESS 1[0m in 0.83s]
[0m21:44:18.040648 [debug] [Thread-1 (]: Finished running node model.takehome_wh.stg_product__devices
[0m21:44:18.041317 [debug] [Thread-1 (]: Began running node model.takehome_wh.stg_product__transactions
[0m21:44:18.043654 [info ] [Thread-1 (]: 3 of 12 START sql view model takehome_schema.stg_product__transactions ......... [RUN]
[0m21:44:18.044715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.takehome_wh.stg_product__devices, now model.takehome_wh.stg_product__transactions)
[0m21:44:18.045299 [debug] [Thread-1 (]: Began compiling node model.takehome_wh.stg_product__transactions
[0m21:44:18.054375 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome_wh.stg_product__transactions"
[0m21:44:18.056676 [debug] [Thread-1 (]: Began executing node model.takehome_wh.stg_product__transactions
[0m21:44:18.063863 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome_wh.stg_product__transactions"
[0m21:44:18.065940 [debug] [Thread-1 (]: Using snowflake connection "model.takehome_wh.stg_product__transactions"
[0m21:44:18.067215 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.stg_product__transactions"} */
create or replace   view takehome_db.takehome_schema.stg_product__transactions
  
   as (
    with
    transactions as (select * from read_replica.product.transactions),

    final as (
        select
            id as pk_transaction_id,
            device_id,
            product_name as transaction_product_name,
            product_sku as transaction_product_sku,
            amount as transaction_amount_eur,
            status as transaction_status,

            -- ideally, sensitive information such as credit card numbers
            -- and CVVs should not be stored in a data warehouse
            -- these sensitive information will not be included in downstream
            -- models in this project
            
            -- if an analysis requires these two fields, and product
            -- database remain unencrypted, perform tokenization

            created_at as transaction_created_at,
            happened_at as transaction_happened_at,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from transactions
    )

select *
from final
  );
[0m21:44:18.068268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:44:18.090165 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18dedebb-9ada-4645-b0ed-671dc79759c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139b5b40>]}
[0m21:44:18.091149 [info ] [Thread-2 (]: 2 of 12 OK created sql view model takehome_schema.stg_product__stores .......... [[32mSUCCESS 1[0m in 0.88s]
[0m21:44:18.092804 [debug] [Thread-2 (]: Finished running node model.takehome_wh.stg_product__stores
[0m21:44:18.093513 [debug] [Thread-2 (]: Began running node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m21:44:18.094121 [info ] [Thread-2 (]: 4 of 12 START test not_null_stg_product__devices_pk_device_id .................. [RUN]
[0m21:44:18.094614 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome_wh.stg_product__stores, now test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941)
[0m21:44:18.094986 [debug] [Thread-2 (]: Began compiling node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m21:44:18.109497 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"
[0m21:44:18.110905 [debug] [Thread-2 (]: Began executing node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m21:44:18.125190 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"
[0m21:44:18.126871 [debug] [Thread-2 (]: Using snowflake connection "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"
[0m21:44:18.127168 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pk_device_id
from takehome_db.takehome_schema.stg_product__devices
where pk_device_id is null



      
    ) dbt_internal_test
[0m21:44:18.127415 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:44:18.622150 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.554 seconds
[0m21:44:18.628663 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__transactions: Close
[0m21:44:18.794478 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18dedebb-9ada-4645-b0ed-671dc79759c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d046a0>]}
[0m21:44:18.796046 [info ] [Thread-1 (]: 3 of 12 OK created sql view model takehome_schema.stg_product__transactions .... [[32mSUCCESS 1[0m in 0.75s]
[0m21:44:18.797029 [debug] [Thread-1 (]: Finished running node model.takehome_wh.stg_product__transactions
[0m21:44:18.797819 [debug] [Thread-1 (]: Began running node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m21:44:18.798770 [info ] [Thread-1 (]: 5 of 12 START test unique_stg_product__devices_pk_device_id .................... [RUN]
[0m21:44:18.802816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.takehome_wh.stg_product__transactions, now test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505)
[0m21:44:18.804060 [debug] [Thread-1 (]: Began compiling node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m21:44:18.819047 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"
[0m21:44:18.820265 [debug] [Thread-1 (]: Began executing node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m21:44:18.823762 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"
[0m21:44:18.826530 [debug] [Thread-1 (]: Using snowflake connection "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"
[0m21:44:18.827103 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    pk_device_id as unique_field,
    count(*) as n_records

from takehome_db.takehome_schema.stg_product__devices
where pk_device_id is not null
group by pk_device_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:44:18.827484 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:44:18.969865 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.842 seconds
[0m21:44:18.974500 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941: Close
[0m21:44:19.171195 [info ] [Thread-2 (]: 4 of 12 PASS not_null_stg_product__devices_pk_device_id ........................ [[32mPASS[0m in 1.08s]
[0m21:44:19.171861 [debug] [Thread-2 (]: Finished running node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m21:44:19.172203 [debug] [Thread-2 (]: Began running node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m21:44:19.172585 [info ] [Thread-2 (]: 6 of 12 START test not_null_stg_product__stores_pk_store_id .................... [RUN]
[0m21:44:19.172959 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941, now test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696)
[0m21:44:19.173224 [debug] [Thread-2 (]: Began compiling node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m21:44:19.178270 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"
[0m21:44:19.179107 [debug] [Thread-2 (]: Began executing node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m21:44:19.181846 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"
[0m21:44:19.182540 [debug] [Thread-2 (]: Using snowflake connection "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"
[0m21:44:19.183540 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pk_store_id
from takehome_db.takehome_schema.stg_product__stores
where pk_store_id is null



      
    ) dbt_internal_test
[0m21:44:19.184159 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:44:19.564815 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.737 seconds
[0m21:44:19.571330 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505: Close
[0m21:44:19.670866 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.486 seconds
[0m21:44:19.675940 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696: Close
[0m21:44:19.746700 [info ] [Thread-1 (]: 5 of 12 PASS unique_stg_product__devices_pk_device_id .......................... [[32mPASS[0m in 0.94s]
[0m21:44:19.748170 [debug] [Thread-1 (]: Finished running node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m21:44:19.748854 [debug] [Thread-1 (]: Began running node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m21:44:19.749537 [info ] [Thread-1 (]: 7 of 12 START test unique_stg_product__stores_pk_store_id ...................... [RUN]
[0m21:44:19.751554 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505, now test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e)
[0m21:44:19.752473 [debug] [Thread-1 (]: Began compiling node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m21:44:19.762554 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"
[0m21:44:19.765025 [debug] [Thread-1 (]: Began executing node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m21:44:19.770038 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"
[0m21:44:19.772234 [debug] [Thread-1 (]: Using snowflake connection "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"
[0m21:44:19.772790 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    pk_store_id as unique_field,
    count(*) as n_records

from takehome_db.takehome_schema.stg_product__stores
where pk_store_id is not null
group by pk_store_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:44:19.773265 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:44:19.846828 [info ] [Thread-2 (]: 6 of 12 PASS not_null_stg_product__stores_pk_store_id .......................... [[32mPASS[0m in 0.67s]
[0m21:44:19.847817 [debug] [Thread-2 (]: Finished running node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m21:44:19.848398 [debug] [Thread-2 (]: Began running node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m21:44:19.849073 [info ] [Thread-2 (]: 8 of 12 START test not_null_stg_product__transactions_pk_transaction_id ........ [RUN]
[0m21:44:19.850673 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696, now test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc)
[0m21:44:19.851419 [debug] [Thread-2 (]: Began compiling node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m21:44:19.857341 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"
[0m21:44:19.859944 [debug] [Thread-2 (]: Began executing node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m21:44:19.863231 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"
[0m21:44:19.864447 [debug] [Thread-2 (]: Using snowflake connection "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"
[0m21:44:19.864905 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pk_transaction_id
from takehome_db.takehome_schema.stg_product__transactions
where pk_transaction_id is null



      
    ) dbt_internal_test
[0m21:44:19.865281 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:44:20.389440 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.616 seconds
[0m21:44:20.394853 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e: Close
[0m21:44:20.437928 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.572 seconds
[0m21:44:20.442570 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc: Close
[0m21:44:20.564540 [info ] [Thread-1 (]: 7 of 12 PASS unique_stg_product__stores_pk_store_id ............................ [[32mPASS[0m in 0.81s]
[0m21:44:20.566117 [debug] [Thread-1 (]: Finished running node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m21:44:20.570589 [debug] [Thread-1 (]: Began running node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m21:44:20.572306 [info ] [Thread-1 (]: 9 of 12 START test unique_stg_product__transactions_pk_transaction_id .......... [RUN]
[0m21:44:20.577549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e, now test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df)
[0m21:44:20.578691 [debug] [Thread-1 (]: Began compiling node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m21:44:20.587969 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"
[0m21:44:20.589271 [debug] [Thread-1 (]: Began executing node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m21:44:20.594052 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"
[0m21:44:20.595506 [debug] [Thread-1 (]: Using snowflake connection "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"
[0m21:44:20.595923 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    pk_transaction_id as unique_field,
    count(*) as n_records

from takehome_db.takehome_schema.stg_product__transactions
where pk_transaction_id is not null
group by pk_transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:44:20.596298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:44:20.620416 [info ] [Thread-2 (]: 8 of 12 PASS not_null_stg_product__transactions_pk_transaction_id .............. [[32mPASS[0m in 0.77s]
[0m21:44:20.621256 [debug] [Thread-2 (]: Finished running node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m21:44:20.621722 [debug] [Thread-2 (]: Began running node model.takehome_wh.dim_devices
[0m21:44:20.622362 [info ] [Thread-2 (]: 10 of 12 START sql table model takehome_schema.dim_devices ..................... [RUN]
[0m21:44:20.622892 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc, now model.takehome_wh.dim_devices)
[0m21:44:20.623273 [debug] [Thread-2 (]: Began compiling node model.takehome_wh.dim_devices
[0m21:44:20.628146 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome_wh.dim_devices"
[0m21:44:20.629206 [debug] [Thread-2 (]: Began executing node model.takehome_wh.dim_devices
[0m21:44:20.648194 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome_wh.dim_devices"
[0m21:44:20.651114 [debug] [Thread-2 (]: Using snowflake connection "model.takehome_wh.dim_devices"
[0m21:44:20.652219 [debug] [Thread-2 (]: On model.takehome_wh.dim_devices: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.dim_devices"} */
create or replace transient table takehome_db.takehome_schema.dim_devices
         as
        (with
    -- import CTEs

    stores as (select * from takehome_db.takehome_schema.stg_product__stores),

    devices as (select * from takehome_db.takehome_schema.stg_product__devices),

    -- logical CTEs
    final as (
        select
            devices.pk_device_id,
            devices.device_type,
            devices.store_id,
            stores.store_name,
            stores.store_address,
            stores.store_city,
            stores.store_country,
            stores.store_device_typology,
            stores.store_created_at,
            stores.customer_id,
            
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from devices
        left join stores on devices.store_id = stores.pk_store_id
    )

select *
from final
        );
[0m21:44:20.652576 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:44:21.109772 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.513 seconds
[0m21:44:21.114734 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df: Close
[0m21:44:21.278467 [info ] [Thread-1 (]: 9 of 12 PASS unique_stg_product__transactions_pk_transaction_id ................ [[32mPASS[0m in 0.70s]
[0m21:44:21.280082 [debug] [Thread-1 (]: Finished running node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m21:44:21.281372 [debug] [Thread-1 (]: Began running node model.takehome_wh.fct_transactions
[0m21:44:21.282515 [info ] [Thread-1 (]: 11 of 12 START sql table model takehome_schema.fct_transactions ................ [RUN]
[0m21:44:21.284439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df, now model.takehome_wh.fct_transactions)
[0m21:44:21.286055 [debug] [Thread-1 (]: Began compiling node model.takehome_wh.fct_transactions
[0m21:44:21.295548 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome_wh.fct_transactions"
[0m21:44:21.297740 [debug] [Thread-1 (]: Began executing node model.takehome_wh.fct_transactions
[0m21:44:21.302468 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome_wh.fct_transactions"
[0m21:44:21.304597 [debug] [Thread-1 (]: Using snowflake connection "model.takehome_wh.fct_transactions"
[0m21:44:21.305082 [debug] [Thread-1 (]: On model.takehome_wh.fct_transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.fct_transactions"} */
create or replace transient table takehome_db.takehome_schema.fct_transactions
         as
        (with
    -- import CTEs
    transactions as (select * from takehome_db.takehome_schema.stg_product__transactions),

    stores as (select * from takehome_db.takehome_schema.stg_product__stores),

    devices as (select * from takehome_db.takehome_schema.stg_product__devices),

    -- logical CTEs
    final as (
        select
            transactions.pk_transaction_id,
            transaction_happened_at,
            transaction_status,
            transaction_product_name,
            transaction_product_sku,
            transaction_amount_eur,

            device_id,
            devices.device_type,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from transactions
        left join devices on transactions.device_id = devices.pk_device_id
    )

select *
from final
        );
[0m21:44:21.305519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:44:21.557238 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.904 seconds
[0m21:44:21.561973 [debug] [Thread-2 (]: On model.takehome_wh.dim_devices: Close
[0m21:44:21.712562 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18dedebb-9ada-4645-b0ed-671dc79759c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139ef040>]}
[0m21:44:21.714246 [info ] [Thread-2 (]: 10 of 12 OK created sql table model takehome_schema.dim_devices ................ [[32mSUCCESS 1[0m in 1.09s]
[0m21:44:21.715288 [debug] [Thread-2 (]: Finished running node model.takehome_wh.dim_devices
[0m21:44:22.153341 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.848 seconds
[0m21:44:22.159872 [debug] [Thread-1 (]: On model.takehome_wh.fct_transactions: Close
[0m21:44:22.327861 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18dedebb-9ada-4645-b0ed-671dc79759c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139545b0>]}
[0m21:44:22.329441 [info ] [Thread-1 (]: 11 of 12 OK created sql table model takehome_schema.fct_transactions ........... [[32mSUCCESS 1[0m in 1.04s]
[0m21:44:22.330432 [debug] [Thread-1 (]: Finished running node model.takehome_wh.fct_transactions
[0m21:44:22.331759 [debug] [Thread-2 (]: Began running node model.takehome_wh.rpt_device_performance
[0m21:44:22.332693 [info ] [Thread-2 (]: 12 of 12 START sql view model takehome_schema.rpt_device_performance ........... [RUN]
[0m21:44:22.334895 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome_wh.dim_devices, now model.takehome_wh.rpt_device_performance)
[0m21:44:22.335683 [debug] [Thread-2 (]: Began compiling node model.takehome_wh.rpt_device_performance
[0m21:44:22.343362 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome_wh.rpt_device_performance"
[0m21:44:22.345918 [debug] [Thread-2 (]: Began executing node model.takehome_wh.rpt_device_performance
[0m21:44:22.350584 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome_wh.rpt_device_performance"
[0m21:44:22.352422 [debug] [Thread-2 (]: Using snowflake connection "model.takehome_wh.rpt_device_performance"
[0m21:44:22.352902 [debug] [Thread-2 (]: On model.takehome_wh.rpt_device_performance: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.rpt_device_performance"} */
create or replace   view takehome_db.takehome_schema.rpt_device_performance
  
   as (
    with
    -- import CTEs
    transactions as (select * from takehome_db.takehome_schema.fct_transactions),

    devices as (select * from takehome_db.takehome_schema.dim_devices),

    -- logical CTEs
    final as (
        select
            devices.* exclude dbt_updated_at,
        from devices
        left join transactions on devices.pk_device_id on transactions.device_id
    )

select *
from final
  );
[0m21:44:22.353321 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:44:22.786648 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01b7f898-3201-4d0e-0000-000ab12a8c89
[0m21:44:22.787632 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 15 at position 55 unexpected 'on'.
syntax error line 18 at position 0 unexpected 'select'.
[0m21:44:22.788676 [debug] [Thread-2 (]: On model.takehome_wh.rpt_device_performance: Close
[0m21:44:22.949634 [debug] [Thread-2 (]: Database Error in model rpt_device_performance (models/reports/rpt_device_performance.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 55 unexpected 'on'.
  syntax error line 18 at position 0 unexpected 'select'.
  compiled code at target/run/takehome_wh/models/reports/rpt_device_performance.sql
[0m21:44:22.951859 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18dedebb-9ada-4645-b0ed-671dc79759c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112875ba0>]}
[0m21:44:22.953209 [error] [Thread-2 (]: 12 of 12 ERROR creating sql view model takehome_schema.rpt_device_performance .. [[31mERROR[0m in 0.62s]
[0m21:44:22.954069 [debug] [Thread-2 (]: Finished running node model.takehome_wh.rpt_device_performance
[0m21:44:22.956352 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:44:22.956915 [debug] [MainThread]: Connection 'model.takehome_wh.fct_transactions' was properly closed.
[0m21:44:22.957615 [debug] [MainThread]: Connection 'model.takehome_wh.rpt_device_performance' was properly closed.
[0m21:44:22.958376 [info ] [MainThread]: 
[0m21:44:22.958977 [info ] [MainThread]: Finished running 4 view models, 6 data tests, 2 table models in 0 hours 0 minutes and 8.17 seconds (8.17s).
[0m21:44:22.963181 [debug] [MainThread]: Command end result
[0m21:44:23.003141 [info ] [MainThread]: 
[0m21:44:23.003649 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:44:23.003997 [info ] [MainThread]: 
[0m21:44:23.004341 [error] [MainThread]:   Database Error in model rpt_device_performance (models/reports/rpt_device_performance.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 55 unexpected 'on'.
  syntax error line 18 at position 0 unexpected 'select'.
  compiled code at target/run/takehome_wh/models/reports/rpt_device_performance.sql
[0m21:44:23.004588 [info ] [MainThread]: 
[0m21:44:23.004824 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=0 TOTAL=12
[0m21:44:23.007042 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 8.931127, "process_user_time": 2.454815, "process_kernel_time": 0.357279, "process_mem_max_rss": "146604032", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:44:23.007718 [debug] [MainThread]: Command `dbt build` failed at 21:44:23.007447 after 8.93 seconds
[0m21:44:23.009908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107823cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d53e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d53e50>]}
[0m21:44:23.010252 [debug] [MainThread]: Flushing usage events
[0m21:44:41.378009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10737bd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12199bf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12199b880>]}


============================== 21:44:41.382062 | 280af204-91d2-4174-b9d5-3713ced687fa ==============================
[0m21:44:41.382062 [info ] [MainThread]: Running with dbt=1.8.8
[0m21:44:41.382434 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cedric.conol/Documents/takehome/', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/cedric.conol/Documents/takehome/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build', 'log_format': 'default', 'target_path': 'target', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:44:41.620131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '280af204-91d2-4174-b9d5-3713ced687fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121907580>]}
[0m21:44:41.652265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '280af204-91d2-4174-b9d5-3713ced687fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1231ecb80>]}
[0m21:44:41.652993 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:44:41.666797 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m21:44:41.773939 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:44:41.774382 [debug] [MainThread]: Partial parsing: updated file: takehome_wh://models/reports/rpt_device_performance.sql
[0m21:44:41.935337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '280af204-91d2-4174-b9d5-3713ced687fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123982440>]}
[0m21:44:42.014946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '280af204-91d2-4174-b9d5-3713ced687fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123817cd0>]}
[0m21:44:42.015296 [info ] [MainThread]: Found 6 models, 6 data tests, 3 sources, 570 macros
[0m21:44:42.016557 [info ] [MainThread]: 
[0m21:44:42.016871 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:44:42.019499 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_takehome_db'
[0m21:44:42.027691 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db"
[0m21:44:42.027972 [debug] [ThreadPool]: On list_takehome_db: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db"} */
show terse schemas in database takehome_db
    limit 10000
[0m21:44:42.028151 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:44:42.601040 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.573 seconds
[0m21:44:42.605069 [debug] [ThreadPool]: On list_takehome_db: Close
[0m21:44:42.785429 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome_db, now list_takehome_db_takehome_schema)
[0m21:44:42.802654 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db_takehome_schema"
[0m21:44:42.803407 [debug] [ThreadPool]: On list_takehome_db_takehome_schema: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db_takehome_schema"} */
show objects in takehome_db.takehome_schema limit 10000
[0m21:44:42.805198 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:44:43.290019 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.485 seconds
[0m21:44:43.293744 [debug] [ThreadPool]: On list_takehome_db_takehome_schema: Close
[0m21:44:43.458128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '280af204-91d2-4174-b9d5-3713ced687fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1230dec80>]}
[0m21:44:43.459622 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m21:44:43.460385 [info ] [MainThread]: 
[0m21:44:43.464882 [debug] [Thread-1 (]: Began running node model.takehome_wh.stg_product__devices
[0m21:44:43.465610 [debug] [Thread-2 (]: Began running node model.takehome_wh.stg_product__stores
[0m21:44:43.466833 [info ] [Thread-1 (]: 1 of 12 START sql view model takehome_schema.stg_product__devices .............. [RUN]
[0m21:44:43.467934 [info ] [Thread-2 (]: 2 of 12 START sql view model takehome_schema.stg_product__stores ............... [RUN]
[0m21:44:43.468960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_takehome_db_takehome_schema, now model.takehome_wh.stg_product__devices)
[0m21:44:43.469944 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.takehome_wh.stg_product__stores'
[0m21:44:43.473493 [debug] [Thread-1 (]: Began compiling node model.takehome_wh.stg_product__devices
[0m21:44:43.474561 [debug] [Thread-2 (]: Began compiling node model.takehome_wh.stg_product__stores
[0m21:44:43.490417 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome_wh.stg_product__devices"
[0m21:44:43.494579 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome_wh.stg_product__stores"
[0m21:44:43.496974 [debug] [Thread-2 (]: Began executing node model.takehome_wh.stg_product__stores
[0m21:44:43.504441 [debug] [Thread-1 (]: Began executing node model.takehome_wh.stg_product__devices
[0m21:44:43.521853 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome_wh.stg_product__stores"
[0m21:44:43.524780 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome_wh.stg_product__devices"
[0m21:44:43.525990 [debug] [Thread-1 (]: Using snowflake connection "model.takehome_wh.stg_product__devices"
[0m21:44:43.526634 [debug] [Thread-2 (]: Using snowflake connection "model.takehome_wh.stg_product__stores"
[0m21:44:43.526917 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__devices: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.stg_product__devices"} */
create or replace   view takehome_db.takehome_schema.stg_product__devices
  
   as (
    with
    devices as (select * from read_replica.product.device),

    final as (
        select
            id as pk_device_id,
            type as device_type,
            store_id,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from
            devices
    )

select *
from final
  );
[0m21:44:43.527207 [debug] [Thread-2 (]: On model.takehome_wh.stg_product__stores: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.stg_product__stores"} */
create or replace   view takehome_db.takehome_schema.stg_product__stores
  
   as (
    with
    stores as (select * from read_replica.product.store),

    final as (
        select
            id as pk_store_id,
            name as store_name,
            address as store_address,
            city as store_city,
            country as store_country,
            typology as store_device_typology,
            customer_id,

            created_at as store_created_at,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from
            stores
    )

select *
from final
  );
[0m21:44:43.527475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:44:43.527703 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:44:44.099487 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.572 seconds
[0m21:44:44.135187 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__devices: Close
[0m21:44:44.136509 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.609 seconds
[0m21:44:44.141094 [debug] [Thread-2 (]: On model.takehome_wh.stg_product__stores: Close
[0m21:44:44.314393 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '280af204-91d2-4174-b9d5-3713ced687fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125a17010>]}
[0m21:44:44.315582 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '280af204-91d2-4174-b9d5-3713ced687fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125a17b80>]}
[0m21:44:44.316849 [info ] [Thread-2 (]: 2 of 12 OK created sql view model takehome_schema.stg_product__stores .......... [[32mSUCCESS 1[0m in 0.84s]
[0m21:44:44.317827 [info ] [Thread-1 (]: 1 of 12 OK created sql view model takehome_schema.stg_product__devices ......... [[32mSUCCESS 1[0m in 0.84s]
[0m21:44:44.318734 [debug] [Thread-2 (]: Finished running node model.takehome_wh.stg_product__stores
[0m21:44:44.319449 [debug] [Thread-1 (]: Finished running node model.takehome_wh.stg_product__devices
[0m21:44:44.320030 [debug] [Thread-2 (]: Began running node model.takehome_wh.stg_product__transactions
[0m21:44:44.324615 [debug] [Thread-1 (]: Began running node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m21:44:44.326061 [info ] [Thread-2 (]: 3 of 12 START sql view model takehome_schema.stg_product__transactions ......... [RUN]
[0m21:44:44.326932 [info ] [Thread-1 (]: 4 of 12 START test not_null_stg_product__stores_pk_store_id .................... [RUN]
[0m21:44:44.327801 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome_wh.stg_product__stores, now model.takehome_wh.stg_product__transactions)
[0m21:44:44.328473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.takehome_wh.stg_product__devices, now test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696)
[0m21:44:44.330855 [debug] [Thread-2 (]: Began compiling node model.takehome_wh.stg_product__transactions
[0m21:44:44.331781 [debug] [Thread-1 (]: Began compiling node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m21:44:44.336808 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome_wh.stg_product__transactions"
[0m21:44:44.351330 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"
[0m21:44:44.423843 [debug] [Thread-2 (]: Began executing node model.takehome_wh.stg_product__transactions
[0m21:44:44.426570 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome_wh.stg_product__transactions"
[0m21:44:44.427689 [debug] [Thread-2 (]: Using snowflake connection "model.takehome_wh.stg_product__transactions"
[0m21:44:44.427996 [debug] [Thread-2 (]: On model.takehome_wh.stg_product__transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.stg_product__transactions"} */
create or replace   view takehome_db.takehome_schema.stg_product__transactions
  
   as (
    with
    transactions as (select * from read_replica.product.transactions),

    final as (
        select
            id as pk_transaction_id,
            device_id,
            product_name as transaction_product_name,
            product_sku as transaction_product_sku,
            amount as transaction_amount_eur,
            status as transaction_status,

            -- ideally, sensitive information such as credit card numbers
            -- and CVVs should not be stored in a data warehouse
            -- these sensitive information will not be included in downstream
            -- models in this project
            
            -- if an analysis requires these two fields, and product
            -- database remain unencrypted, perform tokenization

            created_at as transaction_created_at,
            happened_at as transaction_happened_at,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from transactions
    )

select *
from final
  );
[0m21:44:44.428287 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:44:44.441245 [debug] [Thread-1 (]: Began executing node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m21:44:44.458911 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"
[0m21:44:44.460236 [debug] [Thread-1 (]: Using snowflake connection "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"
[0m21:44:44.460498 [debug] [Thread-1 (]: On test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pk_store_id
from takehome_db.takehome_schema.stg_product__stores
where pk_store_id is null



      
    ) dbt_internal_test
[0m21:44:44.460735 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:44:44.942931 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.482 seconds
[0m21:44:44.948510 [debug] [Thread-1 (]: On test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696: Close
[0m21:44:44.951257 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.523 seconds
[0m21:44:44.955503 [debug] [Thread-2 (]: On model.takehome_wh.stg_product__transactions: Close
[0m21:44:45.107866 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '280af204-91d2-4174-b9d5-3713ced687fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125e239d0>]}
[0m21:44:45.110564 [info ] [Thread-2 (]: 3 of 12 OK created sql view model takehome_schema.stg_product__transactions .... [[32mSUCCESS 1[0m in 0.78s]
[0m21:44:45.111624 [debug] [Thread-2 (]: Finished running node model.takehome_wh.stg_product__transactions
[0m21:44:45.113451 [debug] [Thread-2 (]: Began running node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m21:44:45.114503 [info ] [Thread-1 (]: 4 of 12 PASS not_null_stg_product__stores_pk_store_id .......................... [[32mPASS[0m in 0.79s]
[0m21:44:45.115106 [info ] [Thread-2 (]: 5 of 12 START test unique_stg_product__stores_pk_store_id ...................... [RUN]
[0m21:44:45.115861 [debug] [Thread-1 (]: Finished running node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m21:44:45.116501 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome_wh.stg_product__transactions, now test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e)
[0m21:44:45.117072 [debug] [Thread-1 (]: Began running node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m21:44:45.117734 [debug] [Thread-2 (]: Began compiling node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m21:44:45.118366 [info ] [Thread-1 (]: 6 of 12 START test not_null_stg_product__devices_pk_device_id .................. [RUN]
[0m21:44:45.126174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696, now test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941)
[0m21:44:45.132244 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"
[0m21:44:45.132818 [debug] [Thread-1 (]: Began compiling node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m21:44:45.138709 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"
[0m21:44:45.139644 [debug] [Thread-2 (]: Began executing node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m21:44:45.142198 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"
[0m21:44:45.142572 [debug] [Thread-1 (]: Began executing node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m21:44:45.144914 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"
[0m21:44:45.146955 [debug] [Thread-2 (]: Using snowflake connection "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"
[0m21:44:45.147820 [debug] [Thread-2 (]: On test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    pk_store_id as unique_field,
    count(*) as n_records

from takehome_db.takehome_schema.stg_product__stores
where pk_store_id is not null
group by pk_store_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:44:45.148160 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:44:45.148945 [debug] [Thread-1 (]: Using snowflake connection "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"
[0m21:44:45.149808 [debug] [Thread-1 (]: On test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pk_device_id
from takehome_db.takehome_schema.stg_product__devices
where pk_device_id is null



      
    ) dbt_internal_test
[0m21:44:45.150140 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:44:45.705853 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.555 seconds
[0m21:44:45.710408 [debug] [Thread-1 (]: On test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941: Close
[0m21:44:45.733366 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.585 seconds
[0m21:44:45.739465 [debug] [Thread-2 (]: On test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e: Close
[0m21:44:45.886573 [info ] [Thread-1 (]: 6 of 12 PASS not_null_stg_product__devices_pk_device_id ........................ [[32mPASS[0m in 0.76s]
[0m21:44:45.889464 [debug] [Thread-1 (]: Finished running node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m21:44:45.890250 [debug] [Thread-1 (]: Began running node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m21:44:45.890987 [info ] [Thread-1 (]: 7 of 12 START test unique_stg_product__devices_pk_device_id .................... [RUN]
[0m21:44:45.892000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941, now test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505)
[0m21:44:45.892811 [debug] [Thread-1 (]: Began compiling node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m21:44:45.904368 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"
[0m21:44:45.905622 [debug] [Thread-1 (]: Began executing node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m21:44:45.908452 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"
[0m21:44:45.910850 [debug] [Thread-1 (]: Using snowflake connection "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"
[0m21:44:45.911362 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    pk_device_id as unique_field,
    count(*) as n_records

from takehome_db.takehome_schema.stg_product__devices
where pk_device_id is not null
group by pk_device_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:44:45.913110 [info ] [Thread-2 (]: 5 of 12 PASS unique_stg_product__stores_pk_store_id ............................ [[32mPASS[0m in 0.80s]
[0m21:44:45.914335 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:44:45.915025 [debug] [Thread-2 (]: Finished running node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m21:44:45.916179 [debug] [Thread-2 (]: Began running node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m21:44:45.916941 [info ] [Thread-2 (]: 8 of 12 START test not_null_stg_product__transactions_pk_transaction_id ........ [RUN]
[0m21:44:45.917528 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e, now test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc)
[0m21:44:45.917898 [debug] [Thread-2 (]: Began compiling node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m21:44:45.924296 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"
[0m21:44:45.925073 [debug] [Thread-2 (]: Began executing node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m21:44:45.932003 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"
[0m21:44:45.933624 [debug] [Thread-2 (]: Using snowflake connection "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"
[0m21:44:45.933973 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pk_transaction_id
from takehome_db.takehome_schema.stg_product__transactions
where pk_transaction_id is null



      
    ) dbt_internal_test
[0m21:44:45.934282 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:44:46.390046 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.456 seconds
[0m21:44:46.393064 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc: Close
[0m21:44:46.398086 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.484 seconds
[0m21:44:46.399855 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505: Close
[0m21:44:46.550231 [info ] [Thread-1 (]: 7 of 12 PASS unique_stg_product__devices_pk_device_id .......................... [[32mPASS[0m in 0.66s]
[0m21:44:46.552163 [info ] [Thread-2 (]: 8 of 12 PASS not_null_stg_product__transactions_pk_transaction_id .............. [[32mPASS[0m in 0.63s]
[0m21:44:46.556766 [debug] [Thread-1 (]: Finished running node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m21:44:46.557899 [debug] [Thread-2 (]: Finished running node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m21:44:46.558916 [debug] [Thread-1 (]: Began running node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m21:44:46.560124 [debug] [Thread-2 (]: Began running node model.takehome_wh.dim_devices
[0m21:44:46.561162 [info ] [Thread-1 (]: 9 of 12 START test unique_stg_product__transactions_pk_transaction_id .......... [RUN]
[0m21:44:46.563059 [info ] [Thread-2 (]: 10 of 12 START sql table model takehome_schema.dim_devices ..................... [RUN]
[0m21:44:46.563668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505, now test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df)
[0m21:44:46.564010 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc, now model.takehome_wh.dim_devices)
[0m21:44:46.564283 [debug] [Thread-1 (]: Began compiling node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m21:44:46.564516 [debug] [Thread-2 (]: Began compiling node model.takehome_wh.dim_devices
[0m21:44:46.636212 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome_wh.dim_devices"
[0m21:44:46.640997 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"
[0m21:44:46.641892 [debug] [Thread-2 (]: Began executing node model.takehome_wh.dim_devices
[0m21:44:46.642130 [debug] [Thread-1 (]: Began executing node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m21:44:46.658720 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome_wh.dim_devices"
[0m21:44:46.660682 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"
[0m21:44:46.661609 [debug] [Thread-1 (]: Using snowflake connection "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"
[0m21:44:46.663431 [debug] [Thread-2 (]: Using snowflake connection "model.takehome_wh.dim_devices"
[0m21:44:46.664472 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    pk_transaction_id as unique_field,
    count(*) as n_records

from takehome_db.takehome_schema.stg_product__transactions
where pk_transaction_id is not null
group by pk_transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:44:46.664900 [debug] [Thread-2 (]: On model.takehome_wh.dim_devices: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.dim_devices"} */
create or replace transient table takehome_db.takehome_schema.dim_devices
         as
        (with
    -- import CTEs

    stores as (select * from takehome_db.takehome_schema.stg_product__stores),

    devices as (select * from takehome_db.takehome_schema.stg_product__devices),

    -- logical CTEs
    final as (
        select
            devices.pk_device_id,
            devices.device_type,
            devices.store_id,
            stores.store_name,
            stores.store_address,
            stores.store_city,
            stores.store_country,
            stores.store_device_typology,
            stores.store_created_at,
            stores.customer_id,
            
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from devices
        left join stores on devices.store_id = stores.pk_store_id
    )

select *
from final
        );
[0m21:44:46.665161 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:44:46.665378 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:44:47.184511 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.519 seconds
[0m21:44:47.190135 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df: Close
[0m21:44:47.357546 [info ] [Thread-1 (]: 9 of 12 PASS unique_stg_product__transactions_pk_transaction_id ................ [[32mPASS[0m in 0.79s]
[0m21:44:47.359229 [debug] [Thread-1 (]: Finished running node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m21:44:47.360231 [debug] [Thread-1 (]: Began running node model.takehome_wh.fct_transactions
[0m21:44:47.361115 [info ] [Thread-1 (]: 11 of 12 START sql table model takehome_schema.fct_transactions ................ [RUN]
[0m21:44:47.361767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df, now model.takehome_wh.fct_transactions)
[0m21:44:47.363929 [debug] [Thread-1 (]: Began compiling node model.takehome_wh.fct_transactions
[0m21:44:47.373704 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome_wh.fct_transactions"
[0m21:44:47.374844 [debug] [Thread-1 (]: Began executing node model.takehome_wh.fct_transactions
[0m21:44:47.382469 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome_wh.fct_transactions"
[0m21:44:47.384610 [debug] [Thread-1 (]: Using snowflake connection "model.takehome_wh.fct_transactions"
[0m21:44:47.385136 [debug] [Thread-1 (]: On model.takehome_wh.fct_transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.fct_transactions"} */
create or replace transient table takehome_db.takehome_schema.fct_transactions
         as
        (with
    -- import CTEs
    transactions as (select * from takehome_db.takehome_schema.stg_product__transactions),

    stores as (select * from takehome_db.takehome_schema.stg_product__stores),

    devices as (select * from takehome_db.takehome_schema.stg_product__devices),

    -- logical CTEs
    final as (
        select
            transactions.pk_transaction_id,
            transaction_happened_at,
            transaction_status,
            transaction_product_name,
            transaction_product_sku,
            transaction_amount_eur,

            device_id,
            devices.device_type,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from transactions
        left join devices on transactions.device_id = devices.pk_device_id
    )

select *
from final
        );
[0m21:44:47.385594 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:44:47.643049 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.977 seconds
[0m21:44:47.647914 [debug] [Thread-2 (]: On model.takehome_wh.dim_devices: Close
[0m21:44:47.811738 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '280af204-91d2-4174-b9d5-3713ced687fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076a1de0>]}
[0m21:44:47.815074 [info ] [Thread-2 (]: 10 of 12 OK created sql table model takehome_schema.dim_devices ................ [[32mSUCCESS 1[0m in 1.25s]
[0m21:44:47.816351 [debug] [Thread-2 (]: Finished running node model.takehome_wh.dim_devices
[0m21:44:48.231370 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.846 seconds
[0m21:44:48.237845 [debug] [Thread-1 (]: On model.takehome_wh.fct_transactions: Close
[0m21:44:48.433681 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '280af204-91d2-4174-b9d5-3713ced687fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123992aa0>]}
[0m21:44:48.435632 [info ] [Thread-1 (]: 11 of 12 OK created sql table model takehome_schema.fct_transactions ........... [[32mSUCCESS 1[0m in 1.07s]
[0m21:44:48.436835 [debug] [Thread-1 (]: Finished running node model.takehome_wh.fct_transactions
[0m21:44:48.439665 [debug] [Thread-2 (]: Began running node model.takehome_wh.rpt_device_performance
[0m21:44:48.440869 [info ] [Thread-2 (]: 12 of 12 START sql view model takehome_schema.rpt_device_performance ........... [RUN]
[0m21:44:48.442080 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome_wh.dim_devices, now model.takehome_wh.rpt_device_performance)
[0m21:44:48.442957 [debug] [Thread-2 (]: Began compiling node model.takehome_wh.rpt_device_performance
[0m21:44:48.449697 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome_wh.rpt_device_performance"
[0m21:44:48.450954 [debug] [Thread-2 (]: Began executing node model.takehome_wh.rpt_device_performance
[0m21:44:48.456599 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome_wh.rpt_device_performance"
[0m21:44:48.458291 [debug] [Thread-2 (]: Using snowflake connection "model.takehome_wh.rpt_device_performance"
[0m21:44:48.458760 [debug] [Thread-2 (]: On model.takehome_wh.rpt_device_performance: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.rpt_device_performance"} */
create or replace   view takehome_db.takehome_schema.rpt_device_performance
  
   as (
    with
    -- import CTEs
    transactions as (select * from takehome_db.takehome_schema.fct_transactions),

    devices as (select * from takehome_db.takehome_schema.dim_devices),

    -- logical CTEs
    final as (
        select
            devices.* exclude dbt_updated_at,
        from devices
        left join transactions on devices.pk_device_id = transactions.device_id
    )

select *
from final
  );
[0m21:44:48.459184 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:44:50.095198 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.636 seconds
[0m21:44:50.100728 [debug] [Thread-2 (]: On model.takehome_wh.rpt_device_performance: Close
[0m21:44:50.262902 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '280af204-91d2-4174-b9d5-3713ced687fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125ba3e50>]}
[0m21:44:50.264984 [info ] [Thread-2 (]: 12 of 12 OK created sql view model takehome_schema.rpt_device_performance ...... [[32mSUCCESS 1[0m in 1.82s]
[0m21:44:50.266181 [debug] [Thread-2 (]: Finished running node model.takehome_wh.rpt_device_performance
[0m21:44:50.268375 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:44:50.268955 [debug] [MainThread]: Connection 'model.takehome_wh.fct_transactions' was properly closed.
[0m21:44:50.269314 [debug] [MainThread]: Connection 'model.takehome_wh.rpt_device_performance' was properly closed.
[0m21:44:50.269854 [info ] [MainThread]: 
[0m21:44:50.273284 [info ] [MainThread]: Finished running 4 view models, 6 data tests, 2 table models in 0 hours 0 minutes and 8.25 seconds (8.25s).
[0m21:44:50.277899 [debug] [MainThread]: Command end result
[0m21:44:50.320709 [info ] [MainThread]: 
[0m21:44:50.321277 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:44:50.321537 [info ] [MainThread]: 
[0m21:44:50.321790 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m21:44:50.324289 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 8.996335, "process_user_time": 2.364548, "process_kernel_time": 0.320984, "process_mem_max_rss": "148570112", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:44:50.324782 [debug] [MainThread]: Command `dbt build` succeeded at 21:44:50.324722 after 9.00 seconds
[0m21:44:50.325093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10737bd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125e1f7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125e1fb50>]}
[0m21:44:50.325390 [debug] [MainThread]: Flushing usage events
[0m21:45:52.098866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10306bd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d9bfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d9b8b0>]}


============================== 21:45:52.102110 | b17d58d9-ccb4-466f-a469-b0fd7b6c32ca ==============================
[0m21:45:52.102110 [info ] [MainThread]: Running with dbt=1.8.8
[0m21:45:52.102476 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/cedric.conol/Documents/takehome/', 'log_path': '/Users/cedric.conol/Documents/takehome/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build', 'introspect': 'True', 'target_path': 'target', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:45:52.328061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b17d58d9-ccb4-466f-a469-b0fd7b6c32ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107707040>]}
[0m21:45:52.353798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b17d58d9-ccb4-466f-a469-b0fd7b6c32ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a607f0>]}
[0m21:45:52.354314 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:45:52.367348 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m21:45:52.468326 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:45:52.468730 [debug] [MainThread]: Partial parsing: updated file: takehome_wh://models/reports/rpt_device_performance.sql
[0m21:45:52.621722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b17d58d9-ccb4-466f-a469-b0fd7b6c32ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105923e0>]}
[0m21:45:52.696173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b17d58d9-ccb4-466f-a469-b0fd7b6c32ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103e2e00>]}
[0m21:45:52.696502 [info ] [MainThread]: Found 6 models, 6 data tests, 3 sources, 570 macros
[0m21:45:52.697725 [info ] [MainThread]: 
[0m21:45:52.698041 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:45:52.700689 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_takehome_db'
[0m21:45:52.708199 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db"
[0m21:45:52.708485 [debug] [ThreadPool]: On list_takehome_db: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db"} */
show terse schemas in database takehome_db
    limit 10000
[0m21:45:52.708670 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:45:53.234967 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.526 seconds
[0m21:45:53.238336 [debug] [ThreadPool]: On list_takehome_db: Close
[0m21:45:53.409903 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome_db, now list_takehome_db_takehome_schema)
[0m21:45:53.427226 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db_takehome_schema"
[0m21:45:53.427989 [debug] [ThreadPool]: On list_takehome_db_takehome_schema: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db_takehome_schema"} */
show objects in takehome_db.takehome_schema limit 10000
[0m21:45:53.428430 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:45:53.970826 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.542 seconds
[0m21:45:53.972938 [debug] [ThreadPool]: On list_takehome_db_takehome_schema: Close
[0m21:45:54.146533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b17d58d9-ccb4-466f-a469-b0fd7b6c32ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102effe20>]}
[0m21:45:54.164068 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m21:45:54.171823 [info ] [MainThread]: 
[0m21:45:54.186999 [debug] [Thread-1 (]: Began running node model.takehome_wh.stg_product__devices
[0m21:45:54.187755 [debug] [Thread-2 (]: Began running node model.takehome_wh.stg_product__stores
[0m21:45:54.188411 [info ] [Thread-1 (]: 1 of 12 START sql view model takehome_schema.stg_product__devices .............. [RUN]
[0m21:45:54.189594 [info ] [Thread-2 (]: 2 of 12 START sql view model takehome_schema.stg_product__stores ............... [RUN]
[0m21:45:54.192622 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_takehome_db_takehome_schema, now model.takehome_wh.stg_product__devices)
[0m21:45:54.193877 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.takehome_wh.stg_product__stores'
[0m21:45:54.194688 [debug] [Thread-1 (]: Began compiling node model.takehome_wh.stg_product__devices
[0m21:45:54.195513 [debug] [Thread-2 (]: Began compiling node model.takehome_wh.stg_product__stores
[0m21:45:54.210363 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome_wh.stg_product__devices"
[0m21:45:54.212920 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome_wh.stg_product__stores"
[0m21:45:54.213610 [debug] [Thread-2 (]: Began executing node model.takehome_wh.stg_product__stores
[0m21:45:54.213851 [debug] [Thread-1 (]: Began executing node model.takehome_wh.stg_product__devices
[0m21:45:54.248345 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome_wh.stg_product__devices"
[0m21:45:54.249021 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome_wh.stg_product__stores"
[0m21:45:54.250657 [debug] [Thread-1 (]: Using snowflake connection "model.takehome_wh.stg_product__devices"
[0m21:45:54.251335 [debug] [Thread-2 (]: Using snowflake connection "model.takehome_wh.stg_product__stores"
[0m21:45:54.251662 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__devices: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.stg_product__devices"} */
create or replace   view takehome_db.takehome_schema.stg_product__devices
  
   as (
    with
    devices as (select * from read_replica.product.device),

    final as (
        select
            id as pk_device_id,
            type as device_type,
            store_id,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from
            devices
    )

select *
from final
  );
[0m21:45:54.251907 [debug] [Thread-2 (]: On model.takehome_wh.stg_product__stores: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.stg_product__stores"} */
create or replace   view takehome_db.takehome_schema.stg_product__stores
  
   as (
    with
    stores as (select * from read_replica.product.store),

    final as (
        select
            id as pk_store_id,
            name as store_name,
            address as store_address,
            city as store_city,
            country as store_country,
            typology as store_device_typology,
            customer_id,

            created_at as store_created_at,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from
            stores
    )

select *
from final
  );
[0m21:45:54.252121 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:45:54.252334 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:45:54.797316 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.545 seconds
[0m21:45:54.848136 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__devices: Close
[0m21:45:54.867394 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.615 seconds
[0m21:45:54.869059 [debug] [Thread-2 (]: On model.takehome_wh.stg_product__stores: Close
[0m21:45:55.017565 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b17d58d9-ccb4-466f-a469-b0fd7b6c32ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076df6d0>]}
[0m21:45:55.019765 [info ] [Thread-1 (]: 1 of 12 OK created sql view model takehome_schema.stg_product__devices ......... [[32mSUCCESS 1[0m in 0.83s]
[0m21:45:55.020790 [debug] [Thread-1 (]: Finished running node model.takehome_wh.stg_product__devices
[0m21:45:55.021551 [debug] [Thread-1 (]: Began running node model.takehome_wh.stg_product__transactions
[0m21:45:55.022865 [info ] [Thread-1 (]: 3 of 12 START sql view model takehome_schema.stg_product__transactions ......... [RUN]
[0m21:45:55.023797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.takehome_wh.stg_product__devices, now model.takehome_wh.stg_product__transactions)
[0m21:45:55.030534 [debug] [Thread-1 (]: Began compiling node model.takehome_wh.stg_product__transactions
[0m21:45:55.035943 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome_wh.stg_product__transactions"
[0m21:45:55.037013 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b17d58d9-ccb4-466f-a469-b0fd7b6c32ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e57190>]}
[0m21:45:55.037914 [info ] [Thread-2 (]: 2 of 12 OK created sql view model takehome_schema.stg_product__stores .......... [[32mSUCCESS 1[0m in 0.84s]
[0m21:45:55.038552 [debug] [Thread-2 (]: Finished running node model.takehome_wh.stg_product__stores
[0m21:45:55.038806 [debug] [Thread-1 (]: Began executing node model.takehome_wh.stg_product__transactions
[0m21:45:55.039224 [debug] [Thread-2 (]: Began running node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m21:45:55.043505 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome_wh.stg_product__transactions"
[0m21:45:55.043921 [info ] [Thread-2 (]: 4 of 12 START test not_null_stg_product__devices_pk_device_id .................. [RUN]
[0m21:45:55.044381 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome_wh.stg_product__stores, now test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941)
[0m21:45:55.044661 [debug] [Thread-2 (]: Began compiling node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m21:45:55.045332 [debug] [Thread-1 (]: Using snowflake connection "model.takehome_wh.stg_product__transactions"
[0m21:45:55.053576 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"
[0m21:45:55.054001 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.stg_product__transactions"} */
create or replace   view takehome_db.takehome_schema.stg_product__transactions
  
   as (
    with
    transactions as (select * from read_replica.product.transactions),

    final as (
        select
            id as pk_transaction_id,
            device_id,
            product_name as transaction_product_name,
            product_sku as transaction_product_sku,
            amount as transaction_amount_eur,
            status as transaction_status,

            -- ideally, sensitive information such as credit card numbers
            -- and CVVs should not be stored in a data warehouse
            -- these sensitive information will not be included in downstream
            -- models in this project
            
            -- if an analysis requires these two fields, and product
            -- database remain unencrypted, perform tokenization

            created_at as transaction_created_at,
            happened_at as transaction_happened_at,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from transactions
    )

select *
from final
  );
[0m21:45:55.054396 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:45:55.055135 [debug] [Thread-2 (]: Began executing node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m21:45:55.068871 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"
[0m21:45:55.069992 [debug] [Thread-2 (]: Using snowflake connection "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"
[0m21:45:55.070248 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pk_device_id
from takehome_db.takehome_schema.stg_product__devices
where pk_device_id is null



      
    ) dbt_internal_test
[0m21:45:55.070488 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:45:55.639528 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.569 seconds
[0m21:45:55.647624 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941: Close
[0m21:45:55.686453 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.632 seconds
[0m21:45:55.693657 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__transactions: Close
[0m21:45:55.976714 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b17d58d9-ccb4-466f-a469-b0fd7b6c32ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ff6290>]}
[0m21:45:55.978551 [info ] [Thread-1 (]: 3 of 12 OK created sql view model takehome_schema.stg_product__transactions .... [[32mSUCCESS 1[0m in 0.95s]
[0m21:45:55.979961 [debug] [Thread-1 (]: Finished running node model.takehome_wh.stg_product__transactions
[0m21:45:55.980916 [debug] [Thread-1 (]: Began running node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m21:45:55.982268 [info ] [Thread-2 (]: 4 of 12 PASS not_null_stg_product__devices_pk_device_id ........................ [[32mPASS[0m in 0.94s]
[0m21:45:55.985604 [info ] [Thread-1 (]: 5 of 12 START test unique_stg_product__devices_pk_device_id .................... [RUN]
[0m21:45:55.987069 [debug] [Thread-2 (]: Finished running node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m21:45:55.988103 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.takehome_wh.stg_product__transactions, now test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505)
[0m21:45:55.989061 [debug] [Thread-2 (]: Began running node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m21:45:55.991189 [debug] [Thread-1 (]: Began compiling node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m21:45:55.992611 [info ] [Thread-2 (]: 6 of 12 START test not_null_stg_product__stores_pk_store_id .................... [RUN]
[0m21:45:56.005082 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"
[0m21:45:56.005685 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941, now test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696)
[0m21:45:56.006321 [debug] [Thread-2 (]: Began compiling node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m21:45:56.012323 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"
[0m21:45:56.013030 [debug] [Thread-1 (]: Began executing node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m21:45:56.016738 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"
[0m21:45:56.017687 [debug] [Thread-2 (]: Began executing node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m21:45:56.020225 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"
[0m21:45:56.021020 [debug] [Thread-1 (]: Using snowflake connection "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"
[0m21:45:56.021396 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    pk_device_id as unique_field,
    count(*) as n_records

from takehome_db.takehome_schema.stg_product__devices
where pk_device_id is not null
group by pk_device_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:45:56.021746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:45:56.022306 [debug] [Thread-2 (]: Using snowflake connection "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"
[0m21:45:56.023354 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pk_store_id
from takehome_db.takehome_schema.stg_product__stores
where pk_store_id is null



      
    ) dbt_internal_test
[0m21:45:56.024622 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:45:56.537704 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.516 seconds
[0m21:45:56.543053 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505: Close
[0m21:45:56.546746 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.522 seconds
[0m21:45:56.551773 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696: Close
[0m21:45:56.712693 [info ] [Thread-1 (]: 5 of 12 PASS unique_stg_product__devices_pk_device_id .......................... [[32mPASS[0m in 0.72s]
[0m21:45:56.713521 [debug] [Thread-1 (]: Finished running node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m21:45:56.713872 [debug] [Thread-1 (]: Began running node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m21:45:56.714394 [info ] [Thread-2 (]: 6 of 12 PASS not_null_stg_product__stores_pk_store_id .......................... [[32mPASS[0m in 0.71s]
[0m21:45:56.714635 [info ] [Thread-1 (]: 7 of 12 START test unique_stg_product__stores_pk_store_id ...................... [RUN]
[0m21:45:56.715202 [debug] [Thread-2 (]: Finished running node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m21:45:56.716336 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505, now test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e)
[0m21:45:56.717310 [debug] [Thread-2 (]: Began running node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m21:45:56.718015 [debug] [Thread-1 (]: Began compiling node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m21:45:56.718564 [info ] [Thread-2 (]: 8 of 12 START test not_null_stg_product__transactions_pk_transaction_id ........ [RUN]
[0m21:45:56.727247 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696, now test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc)
[0m21:45:56.730646 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"
[0m21:45:56.731484 [debug] [Thread-2 (]: Began compiling node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m21:45:56.738700 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"
[0m21:45:56.739834 [debug] [Thread-1 (]: Began executing node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m21:45:56.744804 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"
[0m21:45:56.745294 [debug] [Thread-2 (]: Began executing node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m21:45:56.748103 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"
[0m21:45:56.750193 [debug] [Thread-1 (]: Using snowflake connection "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"
[0m21:45:56.751031 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    pk_store_id as unique_field,
    count(*) as n_records

from takehome_db.takehome_schema.stg_product__stores
where pk_store_id is not null
group by pk_store_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:45:56.752472 [debug] [Thread-2 (]: Using snowflake connection "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"
[0m21:45:56.752837 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:45:56.753197 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pk_transaction_id
from takehome_db.takehome_schema.stg_product__transactions
where pk_transaction_id is null



      
    ) dbt_internal_test
[0m21:45:56.754010 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:45:57.244850 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.492 seconds
[0m21:45:57.246582 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e: Close
[0m21:45:57.268446 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.514 seconds
[0m21:45:57.269931 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc: Close
[0m21:45:57.411196 [info ] [Thread-1 (]: 7 of 12 PASS unique_stg_product__stores_pk_store_id ............................ [[32mPASS[0m in 0.70s]
[0m21:45:57.412353 [debug] [Thread-1 (]: Finished running node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m21:45:57.412964 [debug] [Thread-1 (]: Began running node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m21:45:57.413657 [info ] [Thread-1 (]: 9 of 12 START test unique_stg_product__transactions_pk_transaction_id .......... [RUN]
[0m21:45:57.414317 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e, now test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df)
[0m21:45:57.414800 [debug] [Thread-1 (]: Began compiling node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m21:45:57.493206 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"
[0m21:45:57.494203 [debug] [Thread-1 (]: Began executing node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m21:45:57.495932 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"
[0m21:45:57.496326 [info ] [Thread-2 (]: 8 of 12 PASS not_null_stg_product__transactions_pk_transaction_id .............. [[32mPASS[0m in 0.77s]
[0m21:45:57.496854 [debug] [Thread-2 (]: Finished running node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m21:45:57.497177 [debug] [Thread-2 (]: Began running node model.takehome_wh.dim_devices
[0m21:45:57.498394 [debug] [Thread-1 (]: Using snowflake connection "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"
[0m21:45:57.497547 [info ] [Thread-2 (]: 10 of 12 START sql table model takehome_schema.dim_devices ..................... [RUN]
[0m21:45:57.498892 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    pk_transaction_id as unique_field,
    count(*) as n_records

from takehome_db.takehome_schema.stg_product__transactions
where pk_transaction_id is not null
group by pk_transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:45:57.500052 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc, now model.takehome_wh.dim_devices)
[0m21:45:57.500329 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:45:57.500537 [debug] [Thread-2 (]: Began compiling node model.takehome_wh.dim_devices
[0m21:45:57.503493 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome_wh.dim_devices"
[0m21:45:57.504808 [debug] [Thread-2 (]: Began executing node model.takehome_wh.dim_devices
[0m21:45:57.522008 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome_wh.dim_devices"
[0m21:45:57.523718 [debug] [Thread-2 (]: Using snowflake connection "model.takehome_wh.dim_devices"
[0m21:45:57.525207 [debug] [Thread-2 (]: On model.takehome_wh.dim_devices: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.dim_devices"} */
create or replace transient table takehome_db.takehome_schema.dim_devices
         as
        (with
    -- import CTEs

    stores as (select * from takehome_db.takehome_schema.stg_product__stores),

    devices as (select * from takehome_db.takehome_schema.stg_product__devices),

    -- logical CTEs
    final as (
        select
            devices.pk_device_id,
            devices.device_type,
            devices.store_id,
            stores.store_name,
            stores.store_address,
            stores.store_city,
            stores.store_country,
            stores.store_device_typology,
            stores.store_created_at,
            stores.customer_id,
            
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from devices
        left join stores on devices.store_id = stores.pk_store_id
    )

select *
from final
        );
[0m21:45:57.526194 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:45:58.049423 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.549 seconds
[0m21:45:58.051977 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df: Close
[0m21:45:58.246836 [info ] [Thread-1 (]: 9 of 12 PASS unique_stg_product__transactions_pk_transaction_id ................ [[32mPASS[0m in 0.83s]
[0m21:45:58.248487 [debug] [Thread-1 (]: Finished running node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m21:45:58.252208 [debug] [Thread-1 (]: Began running node model.takehome_wh.fct_transactions
[0m21:45:58.253221 [info ] [Thread-1 (]: 11 of 12 START sql table model takehome_schema.fct_transactions ................ [RUN]
[0m21:45:58.254059 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df, now model.takehome_wh.fct_transactions)
[0m21:45:58.254776 [debug] [Thread-1 (]: Began compiling node model.takehome_wh.fct_transactions
[0m21:45:58.264575 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome_wh.fct_transactions"
[0m21:45:58.268537 [debug] [Thread-1 (]: Began executing node model.takehome_wh.fct_transactions
[0m21:45:58.272881 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome_wh.fct_transactions"
[0m21:45:58.276665 [debug] [Thread-1 (]: Using snowflake connection "model.takehome_wh.fct_transactions"
[0m21:45:58.277218 [debug] [Thread-1 (]: On model.takehome_wh.fct_transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.fct_transactions"} */
create or replace transient table takehome_db.takehome_schema.fct_transactions
         as
        (with
    -- import CTEs
    transactions as (select * from takehome_db.takehome_schema.stg_product__transactions),

    stores as (select * from takehome_db.takehome_schema.stg_product__stores),

    devices as (select * from takehome_db.takehome_schema.stg_product__devices),

    -- logical CTEs
    final as (
        select
            transactions.pk_transaction_id,
            transaction_happened_at,
            transaction_status,
            transaction_product_name,
            transaction_product_sku,
            transaction_amount_eur,

            device_id,
            devices.device_type,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from transactions
        left join devices on transactions.device_id = devices.pk_device_id
    )

select *
from final
        );
[0m21:45:58.277627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:45:58.430905 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.905 seconds
[0m21:45:58.435517 [debug] [Thread-2 (]: On model.takehome_wh.dim_devices: Close
[0m21:45:58.588383 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b17d58d9-ccb4-466f-a469-b0fd7b6c32ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ff6d70>]}
[0m21:45:58.589227 [info ] [Thread-2 (]: 10 of 12 OK created sql table model takehome_schema.dim_devices ................ [[32mSUCCESS 1[0m in 1.09s]
[0m21:45:58.589705 [debug] [Thread-2 (]: Finished running node model.takehome_wh.dim_devices
[0m21:45:59.353892 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.076 seconds
[0m21:45:59.356776 [debug] [Thread-1 (]: On model.takehome_wh.fct_transactions: Close
[0m21:45:59.526019 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b17d58d9-ccb4-466f-a469-b0fd7b6c32ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110363a30>]}
[0m21:45:59.526735 [info ] [Thread-1 (]: 11 of 12 OK created sql table model takehome_schema.fct_transactions ........... [[32mSUCCESS 1[0m in 1.27s]
[0m21:45:59.527173 [debug] [Thread-1 (]: Finished running node model.takehome_wh.fct_transactions
[0m21:45:59.527745 [debug] [Thread-2 (]: Began running node model.takehome_wh.rpt_device_performance
[0m21:45:59.528161 [info ] [Thread-2 (]: 12 of 12 START sql view model takehome_schema.rpt_device_performance ........... [RUN]
[0m21:45:59.528499 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome_wh.dim_devices, now model.takehome_wh.rpt_device_performance)
[0m21:45:59.528749 [debug] [Thread-2 (]: Began compiling node model.takehome_wh.rpt_device_performance
[0m21:45:59.531808 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome_wh.rpt_device_performance"
[0m21:45:59.534031 [debug] [Thread-2 (]: Began executing node model.takehome_wh.rpt_device_performance
[0m21:45:59.536767 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome_wh.rpt_device_performance"
[0m21:45:59.537967 [debug] [Thread-2 (]: Using snowflake connection "model.takehome_wh.rpt_device_performance"
[0m21:45:59.538248 [debug] [Thread-2 (]: On model.takehome_wh.rpt_device_performance: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.rpt_device_performance"} */
create or replace   view takehome_db.takehome_schema.rpt_device_performance
  
   as (
    with
    -- import CTEs
    transactions as (select * from takehome_db.takehome_schema.fct_transactions),

    devices as (select * from takehome_db.takehome_schema.dim_devices),

    -- logical CTEs
    final as (
        select
            devices.* exclude dbt_updated_at,
            transactions.* exclude dbt_updated_at,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from devices
        left join transactions on devices.pk_device_id = transactions.device_id
    )

select *
from final
  );
[0m21:45:59.538506 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:46:00.062785 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01b7f89a-3201-4d0e-0000-000ab12a8cb9
[0m21:46:00.063495 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002025 (42S21): SQL compilation error:
duplicate column name 'DEVICE_TYPE'
[0m21:46:00.063983 [debug] [Thread-2 (]: On model.takehome_wh.rpt_device_performance: Close
[0m21:46:00.231146 [debug] [Thread-2 (]: Database Error in model rpt_device_performance (models/reports/rpt_device_performance.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'DEVICE_TYPE'
  compiled code at target/run/takehome_wh/models/reports/rpt_device_performance.sql
[0m21:46:00.231914 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b17d58d9-ccb4-466f-a469-b0fd7b6c32ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076df190>]}
[0m21:46:00.234448 [error] [Thread-2 (]: 12 of 12 ERROR creating sql view model takehome_schema.rpt_device_performance .. [[31mERROR[0m in 0.70s]
[0m21:46:00.235256 [debug] [Thread-2 (]: Finished running node model.takehome_wh.rpt_device_performance
[0m21:46:00.236510 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:46:00.236839 [debug] [MainThread]: Connection 'model.takehome_wh.fct_transactions' was properly closed.
[0m21:46:00.237107 [debug] [MainThread]: Connection 'model.takehome_wh.rpt_device_performance' was properly closed.
[0m21:46:00.237496 [info ] [MainThread]: 
[0m21:46:00.237823 [info ] [MainThread]: Finished running 4 view models, 6 data tests, 2 table models in 0 hours 0 minutes and 7.54 seconds (7.54s).
[0m21:46:00.239426 [debug] [MainThread]: Command end result
[0m21:46:00.279903 [info ] [MainThread]: 
[0m21:46:00.280373 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:46:00.280569 [info ] [MainThread]: 
[0m21:46:00.280822 [error] [MainThread]:   Database Error in model rpt_device_performance (models/reports/rpt_device_performance.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'DEVICE_TYPE'
  compiled code at target/run/takehome_wh/models/reports/rpt_device_performance.sql
[0m21:46:00.281025 [info ] [MainThread]: 
[0m21:46:00.281226 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=0 TOTAL=12
[0m21:46:00.284499 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 8.230743, "process_user_time": 2.156623, "process_kernel_time": 0.319317, "process_mem_max_rss": "143491072", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:46:00.285448 [debug] [MainThread]: Command `dbt build` failed at 21:46:00.285384 after 8.23 seconds
[0m21:46:00.285741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10306bd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103e05e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110563430>]}
[0m21:46:00.285974 [debug] [MainThread]: Flushing usage events
[0m21:46:39.017703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a23c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f9bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f9b850>]}


============================== 21:46:39.021085 | 59f862cf-2639-471e-902b-0e949c6395f1 ==============================
[0m21:46:39.021085 [info ] [MainThread]: Running with dbt=1.8.8
[0m21:46:39.021442 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cedric.conol/Documents/takehome/', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/cedric.conol/Documents/takehome/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build', 'target_path': 'target', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:46:39.254465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59f862cf-2639-471e-902b-0e949c6395f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a1a950>]}
[0m21:46:39.282709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59f862cf-2639-471e-902b-0e949c6395f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ad9b40>]}
[0m21:46:39.283508 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:46:39.297571 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m21:46:39.416382 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:46:39.416785 [debug] [MainThread]: Partial parsing: updated file: takehome_wh://models/marts/fct_transactions.sql
[0m21:46:39.576737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59f862cf-2639-471e-902b-0e949c6395f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112296350>]}
[0m21:46:39.652367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59f862cf-2639-471e-902b-0e949c6395f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120e18d0>]}
[0m21:46:39.652708 [info ] [MainThread]: Found 6 models, 6 data tests, 3 sources, 570 macros
[0m21:46:39.653953 [info ] [MainThread]: 
[0m21:46:39.654325 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:46:39.657212 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_takehome_db'
[0m21:46:39.665320 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db"
[0m21:46:39.665582 [debug] [ThreadPool]: On list_takehome_db: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db"} */
show terse schemas in database takehome_db
    limit 10000
[0m21:46:39.665747 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:46:40.786829 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.121 seconds
[0m21:46:40.791323 [debug] [ThreadPool]: On list_takehome_db: Close
[0m21:46:40.962735 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome_db, now list_takehome_db_takehome_schema)
[0m21:46:40.972513 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db_takehome_schema"
[0m21:46:40.973015 [debug] [ThreadPool]: On list_takehome_db_takehome_schema: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db_takehome_schema"} */
show objects in takehome_db.takehome_schema limit 10000
[0m21:46:40.973910 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:46:41.495849 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.522 seconds
[0m21:46:41.500904 [debug] [ThreadPool]: On list_takehome_db_takehome_schema: Close
[0m21:46:41.671124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59f862cf-2639-471e-902b-0e949c6395f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c6c160>]}
[0m21:46:41.672442 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m21:46:41.672967 [info ] [MainThread]: 
[0m21:46:41.678746 [debug] [Thread-1 (]: Began running node model.takehome_wh.stg_product__devices
[0m21:46:41.679801 [debug] [Thread-2 (]: Began running node model.takehome_wh.stg_product__stores
[0m21:46:41.680946 [info ] [Thread-1 (]: 1 of 12 START sql view model takehome_schema.stg_product__devices .............. [RUN]
[0m21:46:41.683052 [info ] [Thread-2 (]: 2 of 12 START sql view model takehome_schema.stg_product__stores ............... [RUN]
[0m21:46:41.683668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_takehome_db_takehome_schema, now model.takehome_wh.stg_product__devices)
[0m21:46:41.684098 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.takehome_wh.stg_product__stores'
[0m21:46:41.685006 [debug] [Thread-1 (]: Began compiling node model.takehome_wh.stg_product__devices
[0m21:46:41.685689 [debug] [Thread-2 (]: Began compiling node model.takehome_wh.stg_product__stores
[0m21:46:41.700838 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome_wh.stg_product__devices"
[0m21:46:41.704317 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome_wh.stg_product__stores"
[0m21:46:41.705518 [debug] [Thread-1 (]: Began executing node model.takehome_wh.stg_product__devices
[0m21:46:41.705888 [debug] [Thread-2 (]: Began executing node model.takehome_wh.stg_product__stores
[0m21:46:41.731560 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome_wh.stg_product__devices"
[0m21:46:41.735524 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome_wh.stg_product__stores"
[0m21:46:41.736740 [debug] [Thread-2 (]: Using snowflake connection "model.takehome_wh.stg_product__stores"
[0m21:46:41.737286 [debug] [Thread-1 (]: Using snowflake connection "model.takehome_wh.stg_product__devices"
[0m21:46:41.737555 [debug] [Thread-2 (]: On model.takehome_wh.stg_product__stores: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.stg_product__stores"} */
create or replace   view takehome_db.takehome_schema.stg_product__stores
  
   as (
    with
    stores as (select * from read_replica.product.store),

    final as (
        select
            id as pk_store_id,
            name as store_name,
            address as store_address,
            city as store_city,
            country as store_country,
            typology as store_device_typology,
            customer_id,

            created_at as store_created_at,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from
            stores
    )

select *
from final
  );
[0m21:46:41.737825 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__devices: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.stg_product__devices"} */
create or replace   view takehome_db.takehome_schema.stg_product__devices
  
   as (
    with
    devices as (select * from read_replica.product.device),

    final as (
        select
            id as pk_device_id,
            type as device_type,
            store_id,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from
            devices
    )

select *
from final
  );
[0m21:46:41.738069 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:46:41.738292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:46:42.355438 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.617 seconds
[0m21:46:42.389527 [debug] [Thread-2 (]: On model.takehome_wh.stg_product__stores: Close
[0m21:46:42.391295 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.653 seconds
[0m21:46:42.394686 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__devices: Close
[0m21:46:42.596465 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59f862cf-2639-471e-902b-0e949c6395f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a1b640>]}
[0m21:46:42.598226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59f862cf-2639-471e-902b-0e949c6395f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112997e50>]}
[0m21:46:42.600452 [info ] [Thread-2 (]: 2 of 12 OK created sql view model takehome_schema.stg_product__stores .......... [[32mSUCCESS 1[0m in 0.91s]
[0m21:46:42.601421 [info ] [Thread-1 (]: 1 of 12 OK created sql view model takehome_schema.stg_product__devices ......... [[32mSUCCESS 1[0m in 0.91s]
[0m21:46:42.602041 [debug] [Thread-2 (]: Finished running node model.takehome_wh.stg_product__stores
[0m21:46:42.602419 [debug] [Thread-1 (]: Finished running node model.takehome_wh.stg_product__devices
[0m21:46:42.603435 [debug] [Thread-2 (]: Began running node model.takehome_wh.stg_product__transactions
[0m21:46:42.605315 [debug] [Thread-1 (]: Began running node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m21:46:42.607159 [info ] [Thread-2 (]: 3 of 12 START sql view model takehome_schema.stg_product__transactions ......... [RUN]
[0m21:46:42.608549 [info ] [Thread-1 (]: 4 of 12 START test not_null_stg_product__stores_pk_store_id .................... [RUN]
[0m21:46:42.609242 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome_wh.stg_product__stores, now model.takehome_wh.stg_product__transactions)
[0m21:46:42.609942 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.takehome_wh.stg_product__devices, now test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696)
[0m21:46:42.611539 [debug] [Thread-2 (]: Began compiling node model.takehome_wh.stg_product__transactions
[0m21:46:42.612880 [debug] [Thread-1 (]: Began compiling node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m21:46:42.627243 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome_wh.stg_product__transactions"
[0m21:46:42.637737 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"
[0m21:46:42.641256 [debug] [Thread-1 (]: Began executing node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m21:46:42.642073 [debug] [Thread-2 (]: Began executing node model.takehome_wh.stg_product__transactions
[0m21:46:42.652977 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"
[0m21:46:42.655246 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome_wh.stg_product__transactions"
[0m21:46:42.656080 [debug] [Thread-1 (]: Using snowflake connection "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"
[0m21:46:42.656347 [debug] [Thread-1 (]: On test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pk_store_id
from takehome_db.takehome_schema.stg_product__stores
where pk_store_id is null



      
    ) dbt_internal_test
[0m21:46:42.658177 [debug] [Thread-2 (]: Using snowflake connection "model.takehome_wh.stg_product__transactions"
[0m21:46:42.658597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:46:42.658951 [debug] [Thread-2 (]: On model.takehome_wh.stg_product__transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.stg_product__transactions"} */
create or replace   view takehome_db.takehome_schema.stg_product__transactions
  
   as (
    with
    transactions as (select * from read_replica.product.transactions),

    final as (
        select
            id as pk_transaction_id,
            device_id,
            product_name as transaction_product_name,
            product_sku as transaction_product_sku,
            amount as transaction_amount_eur,
            status as transaction_status,

            -- ideally, sensitive information such as credit card numbers
            -- and CVVs should not be stored in a data warehouse
            -- these sensitive information will not be included in downstream
            -- models in this project
            
            -- if an analysis requires these two fields, and product
            -- database remain unencrypted, perform tokenization

            created_at as transaction_created_at,
            happened_at as transaction_happened_at,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from transactions
    )

select *
from final
  );
[0m21:46:42.659531 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:46:43.162822 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.504 seconds
[0m21:46:43.170874 [debug] [Thread-1 (]: On test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696: Close
[0m21:46:43.292521 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.633 seconds
[0m21:46:43.296488 [debug] [Thread-2 (]: On model.takehome_wh.stg_product__transactions: Close
[0m21:46:43.336486 [info ] [Thread-1 (]: 4 of 12 PASS not_null_stg_product__stores_pk_store_id .......................... [[32mPASS[0m in 0.73s]
[0m21:46:43.338018 [debug] [Thread-1 (]: Finished running node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m21:46:43.338811 [debug] [Thread-1 (]: Began running node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m21:46:43.339628 [info ] [Thread-1 (]: 5 of 12 START test unique_stg_product__stores_pk_store_id ...................... [RUN]
[0m21:46:43.341789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696, now test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e)
[0m21:46:43.342989 [debug] [Thread-1 (]: Began compiling node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m21:46:43.355928 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"
[0m21:46:43.358006 [debug] [Thread-1 (]: Began executing node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m21:46:43.361587 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"
[0m21:46:43.362897 [debug] [Thread-1 (]: Using snowflake connection "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"
[0m21:46:43.363286 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    pk_store_id as unique_field,
    count(*) as n_records

from takehome_db.takehome_schema.stg_product__stores
where pk_store_id is not null
group by pk_store_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:46:43.363654 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:46:43.461544 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59f862cf-2639-471e-902b-0e949c6395f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129c9660>]}
[0m21:46:43.462414 [info ] [Thread-2 (]: 3 of 12 OK created sql view model takehome_schema.stg_product__transactions .... [[32mSUCCESS 1[0m in 0.85s]
[0m21:46:43.463013 [debug] [Thread-2 (]: Finished running node model.takehome_wh.stg_product__transactions
[0m21:46:43.463432 [debug] [Thread-2 (]: Began running node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m21:46:43.463976 [info ] [Thread-2 (]: 6 of 12 START test not_null_stg_product__devices_pk_device_id .................. [RUN]
[0m21:46:43.464536 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome_wh.stg_product__transactions, now test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941)
[0m21:46:43.464925 [debug] [Thread-2 (]: Began compiling node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m21:46:43.470341 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"
[0m21:46:43.471534 [debug] [Thread-2 (]: Began executing node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m21:46:43.476898 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"
[0m21:46:43.477907 [debug] [Thread-2 (]: Using snowflake connection "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"
[0m21:46:43.478258 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pk_device_id
from takehome_db.takehome_schema.stg_product__devices
where pk_device_id is null



      
    ) dbt_internal_test
[0m21:46:43.478544 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:46:43.829396 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.465 seconds
[0m21:46:43.835823 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e: Close
[0m21:46:43.934263 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.456 seconds
[0m21:46:43.935812 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941: Close
[0m21:46:43.982493 [info ] [Thread-1 (]: 5 of 12 PASS unique_stg_product__stores_pk_store_id ............................ [[32mPASS[0m in 0.64s]
[0m21:46:43.983539 [debug] [Thread-1 (]: Finished running node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m21:46:43.983960 [debug] [Thread-1 (]: Began running node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m21:46:43.984307 [info ] [Thread-1 (]: 7 of 12 START test unique_stg_product__devices_pk_device_id .................... [RUN]
[0m21:46:43.984708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e, now test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505)
[0m21:46:43.984989 [debug] [Thread-1 (]: Began compiling node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m21:46:43.988234 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"
[0m21:46:43.988923 [debug] [Thread-1 (]: Began executing node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m21:46:43.993355 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"
[0m21:46:43.994446 [debug] [Thread-1 (]: Using snowflake connection "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"
[0m21:46:43.994740 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    pk_device_id as unique_field,
    count(*) as n_records

from takehome_db.takehome_schema.stg_product__devices
where pk_device_id is not null
group by pk_device_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:46:43.994980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:46:44.084994 [info ] [Thread-2 (]: 6 of 12 PASS not_null_stg_product__devices_pk_device_id ........................ [[32mPASS[0m in 0.62s]
[0m21:46:44.085574 [debug] [Thread-2 (]: Finished running node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m21:46:44.085903 [debug] [Thread-2 (]: Began running node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m21:46:44.086195 [info ] [Thread-2 (]: 8 of 12 START test not_null_stg_product__transactions_pk_transaction_id ........ [RUN]
[0m21:46:44.086528 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941, now test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc)
[0m21:46:44.086895 [debug] [Thread-2 (]: Began compiling node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m21:46:44.091177 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"
[0m21:46:44.092851 [debug] [Thread-2 (]: Began executing node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m21:46:44.095146 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"
[0m21:46:44.096072 [debug] [Thread-2 (]: Using snowflake connection "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"
[0m21:46:44.096335 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pk_transaction_id
from takehome_db.takehome_schema.stg_product__transactions
where pk_transaction_id is null



      
    ) dbt_internal_test
[0m21:46:44.096575 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:46:44.492749 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.498 seconds
[0m21:46:44.496173 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505: Close
[0m21:46:44.616665 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.520 seconds
[0m21:46:44.620733 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc: Close
[0m21:46:44.679520 [info ] [Thread-1 (]: 7 of 12 PASS unique_stg_product__devices_pk_device_id .......................... [[32mPASS[0m in 0.69s]
[0m21:46:44.681101 [debug] [Thread-1 (]: Finished running node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m21:46:44.682566 [debug] [Thread-1 (]: Began running node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m21:46:44.684108 [info ] [Thread-1 (]: 9 of 12 START test unique_stg_product__transactions_pk_transaction_id .......... [RUN]
[0m21:46:44.685558 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505, now test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df)
[0m21:46:44.686435 [debug] [Thread-1 (]: Began compiling node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m21:46:44.775695 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"
[0m21:46:44.776965 [debug] [Thread-1 (]: Began executing node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m21:46:44.778868 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"
[0m21:46:44.779869 [debug] [Thread-1 (]: Using snowflake connection "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"
[0m21:46:44.780174 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    pk_transaction_id as unique_field,
    count(*) as n_records

from takehome_db.takehome_schema.stg_product__transactions
where pk_transaction_id is not null
group by pk_transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:46:44.780488 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:46:44.861989 [info ] [Thread-2 (]: 8 of 12 PASS not_null_stg_product__transactions_pk_transaction_id .............. [[32mPASS[0m in 0.78s]
[0m21:46:44.862699 [debug] [Thread-2 (]: Finished running node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m21:46:44.863060 [debug] [Thread-2 (]: Began running node model.takehome_wh.dim_devices
[0m21:46:44.863561 [info ] [Thread-2 (]: 10 of 12 START sql table model takehome_schema.dim_devices ..................... [RUN]
[0m21:46:44.863966 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc, now model.takehome_wh.dim_devices)
[0m21:46:44.864262 [debug] [Thread-2 (]: Began compiling node model.takehome_wh.dim_devices
[0m21:46:44.868157 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome_wh.dim_devices"
[0m21:46:44.869770 [debug] [Thread-2 (]: Began executing node model.takehome_wh.dim_devices
[0m21:46:44.887107 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome_wh.dim_devices"
[0m21:46:44.888551 [debug] [Thread-2 (]: Using snowflake connection "model.takehome_wh.dim_devices"
[0m21:46:44.888811 [debug] [Thread-2 (]: On model.takehome_wh.dim_devices: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.dim_devices"} */
create or replace transient table takehome_db.takehome_schema.dim_devices
         as
        (with
    -- import CTEs

    stores as (select * from takehome_db.takehome_schema.stg_product__stores),

    devices as (select * from takehome_db.takehome_schema.stg_product__devices),

    -- logical CTEs
    final as (
        select
            devices.pk_device_id,
            devices.device_type,
            devices.store_id,
            stores.store_name,
            stores.store_address,
            stores.store_city,
            stores.store_country,
            stores.store_device_typology,
            stores.store_created_at,
            stores.customer_id,
            
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from devices
        left join stores on devices.store_id = stores.pk_store_id
    )

select *
from final
        );
[0m21:46:44.889047 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:46:45.306153 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.525 seconds
[0m21:46:45.312138 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df: Close
[0m21:46:45.494604 [info ] [Thread-1 (]: 9 of 12 PASS unique_stg_product__transactions_pk_transaction_id ................ [[32mPASS[0m in 0.81s]
[0m21:46:45.496070 [debug] [Thread-1 (]: Finished running node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m21:46:45.497371 [debug] [Thread-1 (]: Began running node model.takehome_wh.fct_transactions
[0m21:46:45.498089 [info ] [Thread-1 (]: 11 of 12 START sql table model takehome_schema.fct_transactions ................ [RUN]
[0m21:46:45.499496 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df, now model.takehome_wh.fct_transactions)
[0m21:46:45.500198 [debug] [Thread-1 (]: Began compiling node model.takehome_wh.fct_transactions
[0m21:46:45.507806 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome_wh.fct_transactions"
[0m21:46:45.509239 [debug] [Thread-1 (]: Began executing node model.takehome_wh.fct_transactions
[0m21:46:45.511320 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome_wh.fct_transactions"
[0m21:46:45.512288 [debug] [Thread-1 (]: Using snowflake connection "model.takehome_wh.fct_transactions"
[0m21:46:45.512525 [debug] [Thread-1 (]: On model.takehome_wh.fct_transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.fct_transactions"} */
create or replace transient table takehome_db.takehome_schema.fct_transactions
         as
        (with
    -- import CTEs
    transactions as (select * from takehome_db.takehome_schema.stg_product__transactions),

    stores as (select * from takehome_db.takehome_schema.stg_product__stores),

    devices as (select * from takehome_db.takehome_schema.stg_product__devices),

    -- logical CTEs
    final as (
        select
            transactions.pk_transaction_id,
            transaction_happened_at,
            transaction_status,
            transaction_product_name,
            transaction_product_sku,
            transaction_amount_eur,

            device_id,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from transactions
        left join devices on transactions.device_id = devices.pk_device_id
    )

select *
from final
        );
[0m21:46:45.512744 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:46:45.770979 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.882 seconds
[0m21:46:45.774749 [debug] [Thread-2 (]: On model.takehome_wh.dim_devices: Close
[0m21:46:45.924345 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59f862cf-2639-471e-902b-0e949c6395f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c3e830>]}
[0m21:46:45.926082 [info ] [Thread-2 (]: 10 of 12 OK created sql table model takehome_schema.dim_devices ................ [[32mSUCCESS 1[0m in 1.06s]
[0m21:46:45.926949 [debug] [Thread-2 (]: Finished running node model.takehome_wh.dim_devices
[0m21:46:46.425888 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.913 seconds
[0m21:46:46.430240 [debug] [Thread-1 (]: On model.takehome_wh.fct_transactions: Close
[0m21:46:46.593284 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59f862cf-2639-471e-902b-0e949c6395f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128878b0>]}
[0m21:46:46.594925 [info ] [Thread-1 (]: 11 of 12 OK created sql table model takehome_schema.fct_transactions ........... [[32mSUCCESS 1[0m in 1.09s]
[0m21:46:46.596027 [debug] [Thread-1 (]: Finished running node model.takehome_wh.fct_transactions
[0m21:46:46.597454 [debug] [Thread-2 (]: Began running node model.takehome_wh.rpt_device_performance
[0m21:46:46.599550 [info ] [Thread-2 (]: 12 of 12 START sql view model takehome_schema.rpt_device_performance ........... [RUN]
[0m21:46:46.600820 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome_wh.dim_devices, now model.takehome_wh.rpt_device_performance)
[0m21:46:46.601763 [debug] [Thread-2 (]: Began compiling node model.takehome_wh.rpt_device_performance
[0m21:46:46.610153 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome_wh.rpt_device_performance"
[0m21:46:46.611485 [debug] [Thread-2 (]: Began executing node model.takehome_wh.rpt_device_performance
[0m21:46:46.617731 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome_wh.rpt_device_performance"
[0m21:46:46.619619 [debug] [Thread-2 (]: Using snowflake connection "model.takehome_wh.rpt_device_performance"
[0m21:46:46.620154 [debug] [Thread-2 (]: On model.takehome_wh.rpt_device_performance: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.rpt_device_performance"} */
create or replace   view takehome_db.takehome_schema.rpt_device_performance
  
   as (
    with
    -- import CTEs
    transactions as (select * from takehome_db.takehome_schema.fct_transactions),

    devices as (select * from takehome_db.takehome_schema.dim_devices),

    -- logical CTEs
    final as (
        select
            devices.* exclude dbt_updated_at,
            transactions.* exclude dbt_updated_at,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from devices
        left join transactions on devices.pk_device_id = transactions.device_id
    )

select *
from final
  );
[0m21:46:46.620600 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:46:47.300597 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.680 seconds
[0m21:46:47.304593 [debug] [Thread-2 (]: On model.takehome_wh.rpt_device_performance: Close
[0m21:46:47.475707 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59f862cf-2639-471e-902b-0e949c6395f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e965c0>]}
[0m21:46:47.477047 [info ] [Thread-2 (]: 12 of 12 OK created sql view model takehome_schema.rpt_device_performance ...... [[32mSUCCESS 1[0m in 0.87s]
[0m21:46:47.478110 [debug] [Thread-2 (]: Finished running node model.takehome_wh.rpt_device_performance
[0m21:46:47.480359 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:46:47.481033 [debug] [MainThread]: Connection 'model.takehome_wh.fct_transactions' was properly closed.
[0m21:46:47.481490 [debug] [MainThread]: Connection 'model.takehome_wh.rpt_device_performance' was properly closed.
[0m21:46:47.483878 [info ] [MainThread]: 
[0m21:46:47.484890 [info ] [MainThread]: Finished running 4 view models, 6 data tests, 2 table models in 0 hours 0 minutes and 7.83 seconds (7.83s).
[0m21:46:47.488189 [debug] [MainThread]: Command end result
[0m21:46:47.529901 [info ] [MainThread]: 
[0m21:46:47.530416 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:46:47.530672 [info ] [MainThread]: 
[0m21:46:47.530924 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m21:46:47.533912 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 8.563448, "process_user_time": 2.275828, "process_kernel_time": 0.322121, "process_mem_max_rss": "142049280", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:46:47.534401 [debug] [MainThread]: Command `dbt build` succeeded at 21:46:47.534342 after 8.56 seconds
[0m21:46:47.534686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a23c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120e18d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112812410>]}
[0m21:46:47.534950 [debug] [MainThread]: Flushing usage events
[0m21:55:31.938938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10574bca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10749bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10749b850>]}


============================== 21:55:31.942360 | 9974a02d-c7f9-42f0-855c-067c1df02e43 ==============================
[0m21:55:31.942360 [info ] [MainThread]: Running with dbt=1.8.8
[0m21:55:31.942711 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cedric.conol/Documents/takehome/', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/cedric.conol/Documents/takehome/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt build', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'target', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:55:32.194671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9974a02d-c7f9-42f0-855c-067c1df02e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a41510>]}
[0m21:55:32.220900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9974a02d-c7f9-42f0-855c-067c1df02e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114df1c0>]}
[0m21:55:32.221647 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:55:32.235076 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m21:55:32.298660 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:55:32.299028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9974a02d-c7f9-42f0-855c-067c1df02e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068d9030>]}
[0m21:55:33.515165 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.takehome_wh.mart
[0m21:55:33.521618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9974a02d-c7f9-42f0-855c-067c1df02e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ef56c0>]}
[0m21:55:33.602191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9974a02d-c7f9-42f0-855c-067c1df02e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c978b0>]}
[0m21:55:33.602544 [info ] [MainThread]: Found 6 models, 6 data tests, 3 sources, 570 macros
[0m21:55:33.603804 [info ] [MainThread]: 
[0m21:55:33.604124 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:55:33.607409 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_takehome_db'
[0m21:55:33.607699 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_takehome_db'
[0m21:55:33.615230 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db"
[0m21:55:33.616857 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db"
[0m21:55:33.617146 [debug] [ThreadPool]: On list_takehome_db: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db"} */
show terse schemas in database takehome_db
    limit 10000
[0m21:55:33.617386 [debug] [ThreadPool]: On list_takehome_db: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db"} */
show terse schemas in database takehome_db
    limit 10000
[0m21:55:33.617588 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:55:33.617793 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:55:34.206707 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.589 seconds
[0m21:55:34.207978 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.590 seconds
[0m21:55:34.210256 [debug] [ThreadPool]: On list_takehome_db: Close
[0m21:55:34.212320 [debug] [ThreadPool]: On list_takehome_db: Close
[0m21:55:34.393266 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db"
[0m21:55:34.395078 [debug] [ThreadPool]: On list_takehome_db: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db"} */
show terse schemas in database takehome_db
    limit 10000
[0m21:55:34.396109 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:55:34.875734 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.480 seconds
[0m21:55:34.877223 [debug] [ThreadPool]: On list_takehome_db: Close
[0m21:55:35.059998 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome_db, now create_takehome_db_takehome_schema_staging)
[0m21:55:35.060624 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome_db, now create_takehome_db_takehome_schema_reporting)
[0m21:55:35.061349 [debug] [ThreadPool]: Creating schema "database: "takehome_db"
schema: "takehome_schema_staging"
"
[0m21:55:35.061906 [debug] [ThreadPool]: Creating schema "database: "takehome_db"
schema: "takehome_schema_reporting"
"
[0m21:55:35.069965 [debug] [ThreadPool]: Using snowflake connection "create_takehome_db_takehome_schema_staging"
[0m21:55:35.074479 [debug] [ThreadPool]: Using snowflake connection "create_takehome_db_takehome_schema_reporting"
[0m21:55:35.075385 [debug] [ThreadPool]: On create_takehome_db_takehome_schema_staging: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "create_takehome_db_takehome_schema_staging"} */
create schema if not exists takehome_db.takehome_schema_staging
[0m21:55:35.075805 [debug] [ThreadPool]: On create_takehome_db_takehome_schema_reporting: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "create_takehome_db_takehome_schema_reporting"} */
create schema if not exists takehome_db.takehome_schema_reporting
[0m21:55:35.076134 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:55:35.076441 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:55:35.532269 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.455 seconds
[0m21:55:35.534541 [debug] [ThreadPool]: On create_takehome_db_takehome_schema_reporting: Close
[0m21:55:35.538379 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.462 seconds
[0m21:55:35.542708 [debug] [ThreadPool]: On create_takehome_db_takehome_schema_staging: Close
[0m21:55:35.705498 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_takehome_db_takehome_schema_staging, now list_takehome_db_takehome_schema_staging)
[0m21:55:35.707476 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_takehome_db_takehome_schema_reporting, now list_takehome_db_takehome_schema_reporting)
[0m21:55:35.724774 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db_takehome_schema_staging"
[0m21:55:35.727925 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db_takehome_schema_reporting"
[0m21:55:35.728410 [debug] [ThreadPool]: On list_takehome_db_takehome_schema_staging: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db_takehome_schema_staging"} */
show objects in takehome_db.takehome_schema_staging limit 10000
[0m21:55:35.728792 [debug] [ThreadPool]: On list_takehome_db_takehome_schema_reporting: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db_takehome_schema_reporting"} */
show objects in takehome_db.takehome_schema_reporting limit 10000
[0m21:55:35.729152 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:55:35.729486 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:55:36.227971 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.499 seconds
[0m21:55:36.229417 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.500 seconds
[0m21:55:36.233038 [debug] [ThreadPool]: On list_takehome_db_takehome_schema_staging: Close
[0m21:55:36.235237 [debug] [ThreadPool]: On list_takehome_db_takehome_schema_reporting: Close
[0m21:55:36.408429 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome_db_takehome_schema_staging, now list_takehome_db_takehome_schema)
[0m21:55:36.416056 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db_takehome_schema"
[0m21:55:36.417083 [debug] [ThreadPool]: On list_takehome_db_takehome_schema: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db_takehome_schema"} */
show objects in takehome_db.takehome_schema limit 10000
[0m21:55:36.417532 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:55:36.951098 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.533 seconds
[0m21:55:36.954349 [debug] [ThreadPool]: On list_takehome_db_takehome_schema: Close
[0m21:55:37.132362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9974a02d-c7f9-42f0-855c-067c1df02e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127eac20>]}
[0m21:55:37.133836 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m21:55:37.134683 [info ] [MainThread]: 
[0m21:55:37.140148 [debug] [Thread-1 (]: Began running node model.takehome_wh.stg_product__devices
[0m21:55:37.141386 [debug] [Thread-2 (]: Began running node model.takehome_wh.stg_product__stores
[0m21:55:37.142399 [info ] [Thread-1 (]: 1 of 12 START sql view model takehome_schema_staging.stg_product__devices ...... [RUN]
[0m21:55:37.143505 [info ] [Thread-2 (]: 2 of 12 START sql view model takehome_schema_staging.stg_product__stores ....... [RUN]
[0m21:55:37.144913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_takehome_db_takehome_schema, now model.takehome_wh.stg_product__devices)
[0m21:55:37.145642 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_takehome_db_takehome_schema_reporting, now model.takehome_wh.stg_product__stores)
[0m21:55:37.146260 [debug] [Thread-1 (]: Began compiling node model.takehome_wh.stg_product__devices
[0m21:55:37.146754 [debug] [Thread-2 (]: Began compiling node model.takehome_wh.stg_product__stores
[0m21:55:37.165472 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome_wh.stg_product__stores"
[0m21:55:37.167585 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome_wh.stg_product__devices"
[0m21:55:37.168527 [debug] [Thread-2 (]: Began executing node model.takehome_wh.stg_product__stores
[0m21:55:37.168869 [debug] [Thread-1 (]: Began executing node model.takehome_wh.stg_product__devices
[0m21:55:37.192602 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome_wh.stg_product__stores"
[0m21:55:37.195275 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome_wh.stg_product__devices"
[0m21:55:37.196394 [debug] [Thread-2 (]: Using snowflake connection "model.takehome_wh.stg_product__stores"
[0m21:55:37.196948 [debug] [Thread-1 (]: Using snowflake connection "model.takehome_wh.stg_product__devices"
[0m21:55:37.197278 [debug] [Thread-2 (]: On model.takehome_wh.stg_product__stores: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.stg_product__stores"} */
create or replace   view takehome_db.takehome_schema_staging.stg_product__stores
  
   as (
    with
    stores as (select * from read_replica.product.store),

    final as (
        select
            id as pk_store_id,
            name as store_name,
            address as store_address,
            city as store_city,
            country as store_country,
            typology as store_device_typology,
            customer_id,

            created_at as store_created_at,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from
            stores
    )

select *
from final
  );
[0m21:55:37.198751 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__devices: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.stg_product__devices"} */
create or replace   view takehome_db.takehome_schema_staging.stg_product__devices
  
   as (
    with
    devices as (select * from read_replica.product.device),

    final as (
        select
            id as pk_device_id,
            type as device_type,
            store_id,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from
            devices
    )

select *
from final
  );
[0m21:55:37.199341 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:55:37.199600 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:55:37.768565 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.569 seconds
[0m21:55:37.770060 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.570 seconds
[0m21:55:37.802284 [debug] [Thread-2 (]: On model.takehome_wh.stg_product__stores: Close
[0m21:55:37.804575 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__devices: Close
[0m21:55:37.969886 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9974a02d-c7f9-42f0-855c-067c1df02e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114df640>]}
[0m21:55:37.971822 [info ] [Thread-2 (]: 2 of 12 OK created sql view model takehome_schema_staging.stg_product__stores .. [[32mSUCCESS 1[0m in 0.82s]
[0m21:55:37.974304 [debug] [Thread-2 (]: Finished running node model.takehome_wh.stg_product__stores
[0m21:55:37.975341 [debug] [Thread-2 (]: Began running node model.takehome_wh.stg_product__transactions
[0m21:55:37.976650 [info ] [Thread-2 (]: 3 of 12 START sql view model takehome_schema_staging.stg_product__transactions . [RUN]
[0m21:55:37.977647 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome_wh.stg_product__stores, now model.takehome_wh.stg_product__transactions)
[0m21:55:37.978265 [debug] [Thread-2 (]: Began compiling node model.takehome_wh.stg_product__transactions
[0m21:55:37.985792 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome_wh.stg_product__transactions"
[0m21:55:37.990346 [debug] [Thread-2 (]: Began executing node model.takehome_wh.stg_product__transactions
[0m21:55:37.991612 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9974a02d-c7f9-42f0-855c-067c1df02e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11300cca0>]}
[0m21:55:37.995770 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome_wh.stg_product__transactions"
[0m21:55:37.996493 [info ] [Thread-1 (]: 1 of 12 OK created sql view model takehome_schema_staging.stg_product__devices . [[32mSUCCESS 1[0m in 0.85s]
[0m21:55:37.997862 [debug] [Thread-1 (]: Finished running node model.takehome_wh.stg_product__devices
[0m21:55:37.998611 [debug] [Thread-1 (]: Began running node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m21:55:38.000692 [debug] [Thread-2 (]: Using snowflake connection "model.takehome_wh.stg_product__transactions"
[0m21:55:37.999510 [info ] [Thread-1 (]: 4 of 12 START test not_null_stg_product__stores_pk_store_id .................... [RUN]
[0m21:55:38.001298 [debug] [Thread-2 (]: On model.takehome_wh.stg_product__transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.stg_product__transactions"} */
create or replace   view takehome_db.takehome_schema_staging.stg_product__transactions
  
   as (
    with
    transactions as (select * from read_replica.product.transactions),

    final as (
        select
            id as pk_transaction_id,
            device_id,
            product_name as transaction_product_name,
            product_sku as transaction_product_sku,
            amount as transaction_amount_eur,
            status as transaction_status,

            -- ideally, sensitive information such as credit card numbers
            -- and CVVs should not be stored in a data warehouse
            -- these sensitive information will not be included in downstream
            -- models in this project
            
            -- if an analysis requires these two fields, and product
            -- database remain unencrypted, perform tokenization

            created_at as transaction_created_at,
            happened_at as transaction_happened_at,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from transactions
    )

select *
from final
  );
[0m21:55:38.001829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.takehome_wh.stg_product__devices, now test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696)
[0m21:55:38.002192 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:55:38.002524 [debug] [Thread-1 (]: Began compiling node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m21:55:38.017427 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"
[0m21:55:38.018844 [debug] [Thread-1 (]: Began executing node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m21:55:38.033454 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"
[0m21:55:38.034869 [debug] [Thread-1 (]: Using snowflake connection "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"
[0m21:55:38.035149 [debug] [Thread-1 (]: On test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pk_store_id
from takehome_db.takehome_schema_staging.stg_product__stores
where pk_store_id is null



      
    ) dbt_internal_test
[0m21:55:38.035395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:55:38.551469 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.516 seconds
[0m21:55:38.560108 [debug] [Thread-1 (]: On test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696: Close
[0m21:55:38.576327 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.574 seconds
[0m21:55:38.581056 [debug] [Thread-2 (]: On model.takehome_wh.stg_product__transactions: Close
[0m21:55:38.739923 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9974a02d-c7f9-42f0-855c-067c1df02e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130c3bb0>]}
[0m21:55:38.738330 [info ] [Thread-1 (]: 4 of 12 PASS not_null_stg_product__stores_pk_store_id .......................... [[32mPASS[0m in 0.74s]
[0m21:55:38.741984 [info ] [Thread-2 (]: 3 of 12 OK created sql view model takehome_schema_staging.stg_product__transactions  [[32mSUCCESS 1[0m in 0.76s]
[0m21:55:38.743117 [debug] [Thread-1 (]: Finished running node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m21:55:38.744048 [debug] [Thread-2 (]: Finished running node model.takehome_wh.stg_product__transactions
[0m21:55:38.745088 [debug] [Thread-1 (]: Began running node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m21:55:38.746189 [debug] [Thread-2 (]: Began running node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m21:55:38.747212 [info ] [Thread-1 (]: 5 of 12 START test unique_stg_product__stores_pk_store_id ...................... [RUN]
[0m21:55:38.750280 [info ] [Thread-2 (]: 6 of 12 START test not_null_stg_product__devices_pk_device_id .................. [RUN]
[0m21:55:38.751742 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696, now test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e)
[0m21:55:38.752501 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome_wh.stg_product__transactions, now test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941)
[0m21:55:38.753141 [debug] [Thread-1 (]: Began compiling node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m21:55:38.753720 [debug] [Thread-2 (]: Began compiling node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m21:55:38.763978 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"
[0m21:55:38.768916 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"
[0m21:55:38.771042 [debug] [Thread-2 (]: Began executing node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m21:55:38.771412 [debug] [Thread-1 (]: Began executing node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m21:55:38.774181 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"
[0m21:55:38.777247 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"
[0m21:55:38.778611 [debug] [Thread-1 (]: Using snowflake connection "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"
[0m21:55:38.779221 [debug] [Thread-2 (]: Using snowflake connection "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"
[0m21:55:38.779586 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    pk_store_id as unique_field,
    count(*) as n_records

from takehome_db.takehome_schema_staging.stg_product__stores
where pk_store_id is not null
group by pk_store_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:55:38.779939 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pk_device_id
from takehome_db.takehome_schema_staging.stg_product__devices
where pk_device_id is null



      
    ) dbt_internal_test
[0m21:55:38.780252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:55:38.780550 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:55:39.375229 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.595 seconds
[0m21:55:39.380251 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e: Close
[0m21:55:39.386748 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.606 seconds
[0m21:55:39.391570 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941: Close
[0m21:55:39.536714 [info ] [Thread-1 (]: 5 of 12 PASS unique_stg_product__stores_pk_store_id ............................ [[32mPASS[0m in 0.78s]
[0m21:55:39.538344 [debug] [Thread-1 (]: Finished running node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m21:55:39.540084 [debug] [Thread-1 (]: Began running node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m21:55:39.541174 [info ] [Thread-1 (]: 7 of 12 START test unique_stg_product__devices_pk_device_id .................... [RUN]
[0m21:55:39.542012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e, now test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505)
[0m21:55:39.542796 [debug] [Thread-1 (]: Began compiling node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m21:55:39.553392 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"
[0m21:55:39.556380 [debug] [Thread-1 (]: Began executing node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m21:55:39.560995 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"
[0m21:55:39.562818 [debug] [Thread-1 (]: Using snowflake connection "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"
[0m21:55:39.563323 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    pk_device_id as unique_field,
    count(*) as n_records

from takehome_db.takehome_schema_staging.stg_product__devices
where pk_device_id is not null
group by pk_device_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:55:39.564329 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:55:39.568022 [info ] [Thread-2 (]: 6 of 12 PASS not_null_stg_product__devices_pk_device_id ........................ [[32mPASS[0m in 0.82s]
[0m21:55:39.569334 [debug] [Thread-2 (]: Finished running node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m21:55:39.569813 [debug] [Thread-2 (]: Began running node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m21:55:39.570264 [info ] [Thread-2 (]: 8 of 12 START test not_null_stg_product__transactions_pk_transaction_id ........ [RUN]
[0m21:55:39.570723 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941, now test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc)
[0m21:55:39.571119 [debug] [Thread-2 (]: Began compiling node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m21:55:39.577665 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"
[0m21:55:39.579029 [debug] [Thread-2 (]: Began executing node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m21:55:39.583649 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"
[0m21:55:39.584870 [debug] [Thread-2 (]: Using snowflake connection "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"
[0m21:55:39.585182 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pk_transaction_id
from takehome_db.takehome_schema_staging.stg_product__transactions
where pk_transaction_id is null



      
    ) dbt_internal_test
[0m21:55:39.585464 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:55:40.077553 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.514 seconds
[0m21:55:40.079161 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.494 seconds
[0m21:55:40.083927 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505: Close
[0m21:55:40.093381 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc: Close
[0m21:55:40.274839 [info ] [Thread-1 (]: 7 of 12 PASS unique_stg_product__devices_pk_device_id .......................... [[32mPASS[0m in 0.73s]
[0m21:55:40.276734 [debug] [Thread-1 (]: Finished running node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m21:55:40.277778 [debug] [Thread-1 (]: Began running node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m21:55:40.279329 [info ] [Thread-2 (]: 8 of 12 PASS not_null_stg_product__transactions_pk_transaction_id .............. [[32mPASS[0m in 0.71s]
[0m21:55:40.280120 [info ] [Thread-1 (]: 9 of 12 START test unique_stg_product__transactions_pk_transaction_id .......... [RUN]
[0m21:55:40.283697 [debug] [Thread-2 (]: Finished running node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m21:55:40.284964 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505, now test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df)
[0m21:55:40.286227 [debug] [Thread-2 (]: Began running node model.takehome_wh.dim_devices
[0m21:55:40.287488 [debug] [Thread-1 (]: Began compiling node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m21:55:40.288440 [info ] [Thread-2 (]: 10 of 12 START sql view model takehome_schema.dim_devices ...................... [RUN]
[0m21:55:40.298513 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc, now model.takehome_wh.dim_devices)
[0m21:55:40.297084 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"
[0m21:55:40.299892 [debug] [Thread-2 (]: Began compiling node model.takehome_wh.dim_devices
[0m21:55:40.304829 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome_wh.dim_devices"
[0m21:55:40.306367 [debug] [Thread-1 (]: Began executing node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m21:55:40.311258 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"
[0m21:55:40.311758 [debug] [Thread-2 (]: Began executing node model.takehome_wh.dim_devices
[0m21:55:40.319094 [debug] [Thread-2 (]: Dropping relation "TAKEHOME_DB"."TAKEHOME_SCHEMA"."DIM_DEVICES" because it is of type table
[0m21:55:40.326524 [debug] [Thread-1 (]: Using snowflake connection "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"
[0m21:55:40.328696 [debug] [Thread-2 (]: Applying DROP to: "TAKEHOME_DB"."TAKEHOME_SCHEMA"."DIM_DEVICES"
[0m21:55:40.329183 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    pk_transaction_id as unique_field,
    count(*) as n_records

from takehome_db.takehome_schema_staging.stg_product__transactions
where pk_transaction_id is not null
group by pk_transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:55:40.334277 [debug] [Thread-2 (]: Using snowflake connection "model.takehome_wh.dim_devices"
[0m21:55:40.334664 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:55:40.334933 [debug] [Thread-2 (]: On model.takehome_wh.dim_devices: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.dim_devices"} */
drop table if exists "TAKEHOME_DB"."TAKEHOME_SCHEMA"."DIM_DEVICES" cascade
[0m21:55:40.335803 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:55:40.851090 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.515 seconds
[0m21:55:40.855032 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome_wh.dim_devices"
[0m21:55:40.858889 [debug] [Thread-2 (]: Using snowflake connection "model.takehome_wh.dim_devices"
[0m21:55:40.859997 [debug] [Thread-2 (]: On model.takehome_wh.dim_devices: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.dim_devices"} */
create or replace   view takehome_db.takehome_schema.dim_devices
  
   as (
    with
    -- import CTEs

    stores as (select * from takehome_db.takehome_schema_staging.stg_product__stores),

    devices as (select * from takehome_db.takehome_schema_staging.stg_product__devices),

    -- logical CTEs
    final as (
        select
            devices.pk_device_id,
            devices.device_type,
            devices.store_id,
            stores.store_name,
            stores.store_address,
            stores.store_city,
            stores.store_country,
            stores.store_device_typology,
            stores.store_created_at,
            stores.customer_id,
            
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from devices
        left join stores on devices.store_id = stores.pk_store_id
    )

select *
from final
  );
[0m21:55:40.883803 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.549 seconds
[0m21:55:40.888265 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df: Close
[0m21:55:41.057594 [info ] [Thread-1 (]: 9 of 12 PASS unique_stg_product__transactions_pk_transaction_id ................ [[32mPASS[0m in 0.77s]
[0m21:55:41.058795 [debug] [Thread-1 (]: Finished running node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m21:55:41.059954 [debug] [Thread-1 (]: Began running node model.takehome_wh.fct_transactions
[0m21:55:41.061181 [info ] [Thread-1 (]: 11 of 12 START sql view model takehome_schema.fct_transactions ................. [RUN]
[0m21:55:41.062247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df, now model.takehome_wh.fct_transactions)
[0m21:55:41.062996 [debug] [Thread-1 (]: Began compiling node model.takehome_wh.fct_transactions
[0m21:55:41.073672 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome_wh.fct_transactions"
[0m21:55:41.076271 [debug] [Thread-1 (]: Began executing node model.takehome_wh.fct_transactions
[0m21:55:41.080765 [debug] [Thread-1 (]: Dropping relation "TAKEHOME_DB"."TAKEHOME_SCHEMA"."FCT_TRANSACTIONS" because it is of type table
[0m21:55:41.084784 [debug] [Thread-1 (]: Applying DROP to: "TAKEHOME_DB"."TAKEHOME_SCHEMA"."FCT_TRANSACTIONS"
[0m21:55:41.085867 [debug] [Thread-1 (]: Using snowflake connection "model.takehome_wh.fct_transactions"
[0m21:55:41.086264 [debug] [Thread-1 (]: On model.takehome_wh.fct_transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.fct_transactions"} */
drop table if exists "TAKEHOME_DB"."TAKEHOME_SCHEMA"."FCT_TRANSACTIONS" cascade
[0m21:55:41.086613 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:55:41.129640 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.269 seconds
[0m21:55:41.133506 [debug] [Thread-2 (]: On model.takehome_wh.dim_devices: Close
[0m21:55:41.294949 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9974a02d-c7f9-42f0-855c-067c1df02e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111aae7a0>]}
[0m21:55:41.296773 [info ] [Thread-2 (]: 10 of 12 OK created sql view model takehome_schema.dim_devices ................. [[32mSUCCESS 1[0m in 1.00s]
[0m21:55:41.299838 [debug] [Thread-2 (]: Finished running node model.takehome_wh.dim_devices
[0m21:55:41.567495 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.481 seconds
[0m21:55:41.575810 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome_wh.fct_transactions"
[0m21:55:41.579344 [debug] [Thread-1 (]: Using snowflake connection "model.takehome_wh.fct_transactions"
[0m21:55:41.580386 [debug] [Thread-1 (]: On model.takehome_wh.fct_transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.fct_transactions"} */
create or replace   view takehome_db.takehome_schema.fct_transactions
  
   as (
    with
    -- import CTEs
    transactions as (select * from takehome_db.takehome_schema_staging.stg_product__transactions),

    stores as (select * from takehome_db.takehome_schema_staging.stg_product__stores),

    devices as (select * from takehome_db.takehome_schema_staging.stg_product__devices),

    -- logical CTEs
    final as (
        select
            transactions.pk_transaction_id,
            transaction_happened_at,
            transaction_status,
            transaction_product_name,
            transaction_product_sku,
            transaction_amount_eur,

            device_id,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from transactions
        left join devices on transactions.device_id = devices.pk_device_id
    )

select *
from final
  );
[0m21:55:42.771397 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.188 seconds
[0m21:55:42.775738 [debug] [Thread-1 (]: On model.takehome_wh.fct_transactions: Close
[0m21:55:42.938668 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9974a02d-c7f9-42f0-855c-067c1df02e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e56740>]}
[0m21:55:42.944073 [info ] [Thread-1 (]: 11 of 12 OK created sql view model takehome_schema.fct_transactions ............ [[32mSUCCESS 1[0m in 1.88s]
[0m21:55:42.945034 [debug] [Thread-1 (]: Finished running node model.takehome_wh.fct_transactions
[0m21:55:42.946151 [debug] [Thread-2 (]: Began running node model.takehome_wh.rpt_device_performance
[0m21:55:42.947098 [info ] [Thread-2 (]: 12 of 12 START sql table model takehome_schema_reporting.rpt_device_performance  [RUN]
[0m21:55:42.949269 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome_wh.dim_devices, now model.takehome_wh.rpt_device_performance)
[0m21:55:42.949769 [debug] [Thread-2 (]: Began compiling node model.takehome_wh.rpt_device_performance
[0m21:55:42.963590 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome_wh.rpt_device_performance"
[0m21:55:42.970346 [debug] [Thread-2 (]: Began executing node model.takehome_wh.rpt_device_performance
[0m21:55:42.999228 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome_wh.rpt_device_performance"
[0m21:55:43.001091 [debug] [Thread-2 (]: Using snowflake connection "model.takehome_wh.rpt_device_performance"
[0m21:55:43.001407 [debug] [Thread-2 (]: On model.takehome_wh.rpt_device_performance: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.rpt_device_performance"} */
create or replace transient table takehome_db.takehome_schema_reporting.rpt_device_performance
         as
        (with
    -- import CTEs
    transactions as (select * from takehome_db.takehome_schema.fct_transactions),

    devices as (select * from takehome_db.takehome_schema.dim_devices),

    -- logical CTEs
    final as (
        select
            devices.* exclude dbt_updated_at,
            transactions.* exclude dbt_updated_at,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from devices
        left join transactions on devices.pk_device_id = transactions.device_id
    )

select *
from final
        );
[0m21:55:43.001659 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:55:44.035531 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.034 seconds
[0m21:55:44.037993 [debug] [Thread-2 (]: On model.takehome_wh.rpt_device_performance: Close
[0m21:55:44.202197 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9974a02d-c7f9-42f0-855c-067c1df02e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e7cc40>]}
[0m21:55:44.203299 [info ] [Thread-2 (]: 12 of 12 OK created sql table model takehome_schema_reporting.rpt_device_performance  [[32mSUCCESS 1[0m in 1.25s]
[0m21:55:44.204228 [debug] [Thread-2 (]: Finished running node model.takehome_wh.rpt_device_performance
[0m21:55:44.207275 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:55:44.207727 [debug] [MainThread]: Connection 'model.takehome_wh.fct_transactions' was properly closed.
[0m21:55:44.207995 [debug] [MainThread]: Connection 'model.takehome_wh.rpt_device_performance' was properly closed.
[0m21:55:44.208530 [info ] [MainThread]: 
[0m21:55:44.208919 [info ] [MainThread]: Finished running 5 view models, 6 data tests, 1 table model in 0 hours 0 minutes and 10.60 seconds (10.60s).
[0m21:55:44.211524 [debug] [MainThread]: Command end result
[0m21:55:44.259046 [info ] [MainThread]: 
[0m21:55:44.259510 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:55:44.259748 [info ] [MainThread]: 
[0m21:55:44.259998 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m21:55:44.262128 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 12.368796, "process_user_time": 3.58031, "process_kernel_time": 0.410823, "process_mem_max_rss": "140738560", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:55:44.262740 [debug] [MainThread]: Command `dbt build` succeeded at 21:55:44.262681 after 12.37 seconds
[0m21:55:44.263072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10574bca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068c3820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107499960>]}
[0m21:55:44.263341 [debug] [MainThread]: Flushing usage events
[0m21:58:40.384833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10427bcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10679bf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10679b880>]}


============================== 21:58:40.388491 | 490a27b2-2cd7-4eb2-b9bb-bcc023db537c ==============================
[0m21:58:40.388491 [info ] [MainThread]: Running with dbt=1.8.8
[0m21:58:40.388891 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/cedric.conol/Documents/takehome/', 'log_path': '/Users/cedric.conol/Documents/takehome/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'target', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:58:40.623974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '490a27b2-2cd7-4eb2-b9bb-bcc023db537c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f04eb0>]}
[0m21:58:40.652853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '490a27b2-2cd7-4eb2-b9bb-bcc023db537c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ac43d0>]}
[0m21:58:40.653680 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:58:40.668608 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m21:58:40.774098 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 0 files changed.
[0m21:58:40.774478 [debug] [MainThread]: Partial parsing: added file: takehome_wh://models/mart/fct_transactions.sql
[0m21:58:40.774682 [debug] [MainThread]: Partial parsing: added file: takehome_wh://models/mart/dim_devices.sql
[0m21:58:40.774893 [debug] [MainThread]: Partial parsing: deleted file: takehome_wh://models/marts/dim_devices.sql
[0m21:58:40.775064 [debug] [MainThread]: Partial parsing: deleted file: takehome_wh://models/marts/fct_transactions.sql
[0m21:58:40.937137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '490a27b2-2cd7-4eb2-b9bb-bcc023db537c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b8fe80>]}
[0m21:58:41.011092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '490a27b2-2cd7-4eb2-b9bb-bcc023db537c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110970be0>]}
[0m21:58:41.011413 [info ] [MainThread]: Found 6 models, 6 data tests, 3 sources, 570 macros
[0m21:58:41.012610 [info ] [MainThread]: 
[0m21:58:41.012928 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:58:41.015798 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_takehome_db'
[0m21:58:41.016089 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_takehome_db'
[0m21:58:41.024138 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db"
[0m21:58:41.025501 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db"
[0m21:58:41.025720 [debug] [ThreadPool]: On list_takehome_db: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db"} */
show terse schemas in database takehome_db
    limit 10000
[0m21:58:41.025914 [debug] [ThreadPool]: On list_takehome_db: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db"} */
show terse schemas in database takehome_db
    limit 10000
[0m21:58:41.026102 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:58:41.026272 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:58:41.539002 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.513 seconds
[0m21:58:41.541131 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.515 seconds
[0m21:58:41.543531 [debug] [ThreadPool]: On list_takehome_db: Close
[0m21:58:41.546878 [debug] [ThreadPool]: On list_takehome_db: Close
[0m21:58:41.705737 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db"
[0m21:58:41.706537 [debug] [ThreadPool]: On list_takehome_db: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db"} */
show terse schemas in database takehome_db
    limit 10000
[0m21:58:41.706980 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:58:42.203585 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.497 seconds
[0m21:58:42.207131 [debug] [ThreadPool]: On list_takehome_db: Close
[0m21:58:42.373937 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome_db, now create_takehome_db_takehome_schema_reporting)
[0m21:58:42.374367 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome_db, now create_takehome_db_takehome_schema_staging)
[0m21:58:42.374835 [debug] [ThreadPool]: Creating schema "database: "takehome_db"
schema: "takehome_schema_reporting"
"
[0m21:58:42.375193 [debug] [ThreadPool]: Creating schema "database: "takehome_db"
schema: "takehome_schema_staging"
"
[0m21:58:42.380860 [debug] [ThreadPool]: Using snowflake connection "create_takehome_db_takehome_schema_reporting"
[0m21:58:42.383019 [debug] [ThreadPool]: Using snowflake connection "create_takehome_db_takehome_schema_staging"
[0m21:58:42.383353 [debug] [ThreadPool]: On create_takehome_db_takehome_schema_reporting: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "create_takehome_db_takehome_schema_reporting"} */
create schema if not exists takehome_db.takehome_schema_reporting
[0m21:58:42.383592 [debug] [ThreadPool]: On create_takehome_db_takehome_schema_staging: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "create_takehome_db_takehome_schema_staging"} */
create schema if not exists takehome_db.takehome_schema_staging
[0m21:58:42.383814 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:58:42.384020 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:58:42.849289 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.465 seconds
[0m21:58:42.851203 [debug] [ThreadPool]: On create_takehome_db_takehome_schema_staging: Close
[0m21:58:42.875790 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.492 seconds
[0m21:58:42.878207 [debug] [ThreadPool]: On create_takehome_db_takehome_schema_reporting: Close
[0m21:58:43.018631 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_takehome_db_takehome_schema_staging, now create_takehome_db_takehome_schema_mart)
[0m21:58:43.020052 [debug] [ThreadPool]: Creating schema "database: "takehome_db"
schema: "takehome_schema_mart"
"
[0m21:58:43.026551 [debug] [ThreadPool]: Using snowflake connection "create_takehome_db_takehome_schema_mart"
[0m21:58:43.027458 [debug] [ThreadPool]: On create_takehome_db_takehome_schema_mart: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "create_takehome_db_takehome_schema_mart"} */
create schema if not exists takehome_db.takehome_schema_mart
[0m21:58:43.027873 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:58:43.533557 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.506 seconds
[0m21:58:43.535649 [debug] [ThreadPool]: On create_takehome_db_takehome_schema_mart: Close
[0m21:58:43.693560 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_takehome_db_takehome_schema_mart, now list_takehome_db_takehome_schema_reporting)
[0m21:58:43.695451 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_takehome_db_takehome_schema_reporting, now list_takehome_db_takehome_schema_staging)
[0m21:58:43.715376 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db_takehome_schema_reporting"
[0m21:58:43.719879 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db_takehome_schema_staging"
[0m21:58:43.722882 [debug] [ThreadPool]: On list_takehome_db_takehome_schema_reporting: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db_takehome_schema_reporting"} */
show objects in takehome_db.takehome_schema_reporting limit 10000
[0m21:58:43.723804 [debug] [ThreadPool]: On list_takehome_db_takehome_schema_staging: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db_takehome_schema_staging"} */
show objects in takehome_db.takehome_schema_staging limit 10000
[0m21:58:43.724379 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:58:43.724728 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:58:44.205332 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.480 seconds
[0m21:58:44.207912 [debug] [ThreadPool]: On list_takehome_db_takehome_schema_staging: Close
[0m21:58:44.211444 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.487 seconds
[0m21:58:44.214856 [debug] [ThreadPool]: On list_takehome_db_takehome_schema_reporting: Close
[0m21:58:44.382525 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome_db_takehome_schema_reporting, now list_takehome_db_takehome_schema_mart)
[0m21:58:44.390412 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db_takehome_schema_mart"
[0m21:58:44.391214 [debug] [ThreadPool]: On list_takehome_db_takehome_schema_mart: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db_takehome_schema_mart"} */
show objects in takehome_db.takehome_schema_mart limit 10000
[0m21:58:44.391628 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:58:44.806262 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.415 seconds
[0m21:58:44.807319 [debug] [ThreadPool]: On list_takehome_db_takehome_schema_mart: Close
[0m21:58:44.957558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '490a27b2-2cd7-4eb2-b9bb-bcc023db537c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131fc340>]}
[0m21:58:44.959037 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m21:58:44.959711 [info ] [MainThread]: 
[0m21:58:44.964987 [debug] [Thread-1 (]: Began running node model.takehome_wh.stg_product__devices
[0m21:58:44.965731 [debug] [Thread-2 (]: Began running node model.takehome_wh.stg_product__stores
[0m21:58:44.966709 [info ] [Thread-1 (]: 1 of 12 START sql view model takehome_schema_staging.stg_product__devices ...... [RUN]
[0m21:58:44.967368 [info ] [Thread-2 (]: 2 of 12 START sql view model takehome_schema_staging.stg_product__stores ....... [RUN]
[0m21:58:44.967916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_takehome_db_takehome_schema_mart, now model.takehome_wh.stg_product__devices)
[0m21:58:44.968322 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_takehome_db_takehome_schema_staging, now model.takehome_wh.stg_product__stores)
[0m21:58:44.968677 [debug] [Thread-1 (]: Began compiling node model.takehome_wh.stg_product__devices
[0m21:58:44.968993 [debug] [Thread-2 (]: Began compiling node model.takehome_wh.stg_product__stores
[0m21:58:44.992715 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome_wh.stg_product__devices"
[0m21:58:44.986910 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome_wh.stg_product__stores"
[0m21:58:44.994125 [debug] [Thread-2 (]: Began executing node model.takehome_wh.stg_product__stores
[0m21:58:44.994499 [debug] [Thread-1 (]: Began executing node model.takehome_wh.stg_product__devices
[0m21:58:45.023753 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome_wh.stg_product__stores"
[0m21:58:45.026877 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome_wh.stg_product__devices"
[0m21:58:45.028064 [debug] [Thread-1 (]: Using snowflake connection "model.takehome_wh.stg_product__devices"
[0m21:58:45.028669 [debug] [Thread-2 (]: Using snowflake connection "model.takehome_wh.stg_product__stores"
[0m21:58:45.029489 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__devices: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.stg_product__devices"} */
create or replace   view takehome_db.takehome_schema_staging.stg_product__devices
  
   as (
    with
    devices as (select * from read_replica.product.device),

    final as (
        select
            id as pk_device_id,
            type as device_type,
            store_id,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from
            devices
    )

select *
from final
  );
[0m21:58:45.031347 [debug] [Thread-2 (]: On model.takehome_wh.stg_product__stores: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.stg_product__stores"} */
create or replace   view takehome_db.takehome_schema_staging.stg_product__stores
  
   as (
    with
    stores as (select * from read_replica.product.store),

    final as (
        select
            id as pk_store_id,
            name as store_name,
            address as store_address,
            city as store_city,
            country as store_country,
            typology as store_device_typology,
            customer_id,

            created_at as store_created_at,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from
            stores
    )

select *
from final
  );
[0m21:58:45.031659 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:58:45.031911 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:58:45.586551 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.555 seconds
[0m21:58:45.620226 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__devices: Close
[0m21:58:45.622008 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.590 seconds
[0m21:58:45.625090 [debug] [Thread-2 (]: On model.takehome_wh.stg_product__stores: Close
[0m21:58:45.785988 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '490a27b2-2cd7-4eb2-b9bb-bcc023db537c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133b7760>]}
[0m21:58:45.789647 [info ] [Thread-2 (]: 2 of 12 OK created sql view model takehome_schema_staging.stg_product__stores .. [[32mSUCCESS 1[0m in 0.82s]
[0m21:58:45.793179 [debug] [Thread-2 (]: Finished running node model.takehome_wh.stg_product__stores
[0m21:58:45.794332 [debug] [Thread-2 (]: Began running node model.takehome_wh.stg_product__transactions
[0m21:58:45.797856 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '490a27b2-2cd7-4eb2-b9bb-bcc023db537c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ddf6a0>]}
[0m21:58:45.799740 [info ] [Thread-2 (]: 3 of 12 START sql view model takehome_schema_staging.stg_product__transactions . [RUN]
[0m21:58:45.801341 [info ] [Thread-1 (]: 1 of 12 OK created sql view model takehome_schema_staging.stg_product__devices . [[32mSUCCESS 1[0m in 0.83s]
[0m21:58:45.802196 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome_wh.stg_product__stores, now model.takehome_wh.stg_product__transactions)
[0m21:58:45.802789 [debug] [Thread-1 (]: Finished running node model.takehome_wh.stg_product__devices
[0m21:58:45.803149 [debug] [Thread-2 (]: Began compiling node model.takehome_wh.stg_product__transactions
[0m21:58:45.803646 [debug] [Thread-1 (]: Began running node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m21:58:45.811614 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome_wh.stg_product__transactions"
[0m21:58:45.816587 [info ] [Thread-1 (]: 4 of 12 START test not_null_stg_product__stores_pk_store_id .................... [RUN]
[0m21:58:45.817905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.takehome_wh.stg_product__devices, now test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696)
[0m21:58:45.819302 [debug] [Thread-1 (]: Began compiling node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m21:58:45.819694 [debug] [Thread-2 (]: Began executing node model.takehome_wh.stg_product__transactions
[0m21:58:45.843456 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"
[0m21:58:45.849559 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome_wh.stg_product__transactions"
[0m21:58:45.850816 [debug] [Thread-1 (]: Began executing node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m21:58:45.852888 [debug] [Thread-2 (]: Using snowflake connection "model.takehome_wh.stg_product__transactions"
[0m21:58:45.957887 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"
[0m21:58:45.958995 [debug] [Thread-2 (]: On model.takehome_wh.stg_product__transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.stg_product__transactions"} */
create or replace   view takehome_db.takehome_schema_staging.stg_product__transactions
  
   as (
    with
    transactions as (select * from read_replica.product.transactions),

    final as (
        select
            id as pk_transaction_id,
            device_id,
            product_name as transaction_product_name,
            product_sku as transaction_product_sku,
            amount as transaction_amount_eur,
            status as transaction_status,

            -- ideally, sensitive information such as credit card numbers
            -- and CVVs should not be stored in a data warehouse
            -- these sensitive information will not be included in downstream
            -- models in this project
            
            -- if an analysis requires these two fields, and product
            -- database remain unencrypted, perform tokenization

            created_at as transaction_created_at,
            happened_at as transaction_happened_at,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from transactions
    )

select *
from final
  );
[0m21:58:45.959433 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:58:45.960742 [debug] [Thread-1 (]: Using snowflake connection "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"
[0m21:58:45.961023 [debug] [Thread-1 (]: On test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pk_store_id
from takehome_db.takehome_schema_staging.stg_product__stores
where pk_store_id is null



      
    ) dbt_internal_test
[0m21:58:45.961246 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:58:46.459993 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.498 seconds
[0m21:58:46.472602 [debug] [Thread-1 (]: On test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696: Close
[0m21:58:46.534140 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.574 seconds
[0m21:58:46.539943 [debug] [Thread-2 (]: On model.takehome_wh.stg_product__transactions: Close
[0m21:58:46.637941 [info ] [Thread-1 (]: 4 of 12 PASS not_null_stg_product__stores_pk_store_id .......................... [[32mPASS[0m in 0.82s]
[0m21:58:46.640000 [debug] [Thread-1 (]: Finished running node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m21:58:46.641348 [debug] [Thread-1 (]: Began running node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m21:58:46.642648 [info ] [Thread-1 (]: 5 of 12 START test unique_stg_product__stores_pk_store_id ...................... [RUN]
[0m21:58:46.644115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696, now test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e)
[0m21:58:46.644944 [debug] [Thread-1 (]: Began compiling node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m21:58:46.661020 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"
[0m21:58:46.665590 [debug] [Thread-1 (]: Began executing node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m21:58:46.669070 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"
[0m21:58:46.670424 [debug] [Thread-1 (]: Using snowflake connection "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"
[0m21:58:46.673128 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    pk_store_id as unique_field,
    count(*) as n_records

from takehome_db.takehome_schema_staging.stg_product__stores
where pk_store_id is not null
group by pk_store_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:58:46.673596 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:58:46.699104 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '490a27b2-2cd7-4eb2-b9bb-bcc023db537c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11364f250>]}
[0m21:58:46.700253 [info ] [Thread-2 (]: 3 of 12 OK created sql view model takehome_schema_staging.stg_product__transactions  [[32mSUCCESS 1[0m in 0.90s]
[0m21:58:46.700767 [debug] [Thread-2 (]: Finished running node model.takehome_wh.stg_product__transactions
[0m21:58:46.702029 [debug] [Thread-2 (]: Began running node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m21:58:46.703039 [info ] [Thread-2 (]: 6 of 12 START test not_null_stg_product__devices_pk_device_id .................. [RUN]
[0m21:58:46.703583 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome_wh.stg_product__transactions, now test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941)
[0m21:58:46.703944 [debug] [Thread-2 (]: Began compiling node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m21:58:46.708763 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"
[0m21:58:46.709969 [debug] [Thread-2 (]: Began executing node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m21:58:46.715240 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"
[0m21:58:46.716193 [debug] [Thread-2 (]: Using snowflake connection "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"
[0m21:58:46.716488 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pk_device_id
from takehome_db.takehome_schema_staging.stg_product__devices
where pk_device_id is null



      
    ) dbt_internal_test
[0m21:58:46.716759 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:58:47.185194 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.511 seconds
[0m21:58:47.189314 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e: Close
[0m21:58:47.203248 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.486 seconds
[0m21:58:47.206938 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941: Close
[0m21:58:47.353688 [info ] [Thread-1 (]: 5 of 12 PASS unique_stg_product__stores_pk_store_id ............................ [[32mPASS[0m in 0.71s]
[0m21:58:47.355311 [debug] [Thread-1 (]: Finished running node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m21:58:47.356209 [debug] [Thread-1 (]: Began running node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m21:58:47.357135 [info ] [Thread-1 (]: 7 of 12 START test unique_stg_product__devices_pk_device_id .................... [RUN]
[0m21:58:47.359724 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e, now test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505)
[0m21:58:47.360791 [debug] [Thread-1 (]: Began compiling node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m21:58:47.370227 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"
[0m21:58:47.372191 [debug] [Thread-1 (]: Began executing node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m21:58:47.377920 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"
[0m21:58:47.378811 [info ] [Thread-2 (]: 6 of 12 PASS not_null_stg_product__devices_pk_device_id ........................ [[32mPASS[0m in 0.68s]
[0m21:58:47.379794 [debug] [Thread-2 (]: Finished running node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m21:58:47.380371 [debug] [Thread-2 (]: Began running node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m21:58:47.380891 [info ] [Thread-2 (]: 8 of 12 START test not_null_stg_product__transactions_pk_transaction_id ........ [RUN]
[0m21:58:47.381823 [debug] [Thread-1 (]: Using snowflake connection "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"
[0m21:58:47.382348 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941, now test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc)
[0m21:58:47.382787 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    pk_device_id as unique_field,
    count(*) as n_records

from takehome_db.takehome_schema_staging.stg_product__devices
where pk_device_id is not null
group by pk_device_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:58:47.385066 [debug] [Thread-2 (]: Began compiling node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m21:58:47.385734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:58:47.390353 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"
[0m21:58:47.395238 [debug] [Thread-2 (]: Began executing node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m21:58:47.399329 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"
[0m21:58:47.403227 [debug] [Thread-2 (]: Using snowflake connection "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"
[0m21:58:47.403706 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pk_transaction_id
from takehome_db.takehome_schema_staging.stg_product__transactions
where pk_transaction_id is null



      
    ) dbt_internal_test
[0m21:58:47.404530 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:58:47.945985 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.560 seconds
[0m21:58:47.952452 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505: Close
[0m21:58:47.955936 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.551 seconds
[0m21:58:47.960619 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc: Close
[0m21:58:48.124239 [info ] [Thread-2 (]: 8 of 12 PASS not_null_stg_product__transactions_pk_transaction_id .............. [[32mPASS[0m in 0.74s]
[0m21:58:48.126860 [info ] [Thread-1 (]: 7 of 12 PASS unique_stg_product__devices_pk_device_id .......................... [[32mPASS[0m in 0.77s]
[0m21:58:48.128280 [debug] [Thread-2 (]: Finished running node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m21:58:48.128846 [debug] [Thread-1 (]: Finished running node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m21:58:48.129344 [debug] [Thread-2 (]: Began running node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m21:58:48.130022 [info ] [Thread-2 (]: 9 of 12 START test unique_stg_product__transactions_pk_transaction_id .......... [RUN]
[0m21:58:48.130667 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc, now test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df)
[0m21:58:48.131012 [debug] [Thread-2 (]: Began compiling node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m21:58:48.135846 [debug] [Thread-1 (]: Began running node model.takehome_wh.dim_devices
[0m21:58:48.143561 [info ] [Thread-1 (]: 10 of 12 START sql table model takehome_schema_mart.dim_devices ................ [RUN]
[0m21:58:48.146586 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"
[0m21:58:48.147939 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505, now model.takehome_wh.dim_devices)
[0m21:58:48.148966 [debug] [Thread-1 (]: Began compiling node model.takehome_wh.dim_devices
[0m21:58:48.157422 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome_wh.dim_devices"
[0m21:58:48.160123 [debug] [Thread-2 (]: Began executing node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m21:58:48.163563 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"
[0m21:58:48.164242 [debug] [Thread-1 (]: Began executing node model.takehome_wh.dim_devices
[0m21:58:48.170868 [debug] [Thread-2 (]: Using snowflake connection "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"
[0m21:58:48.188183 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome_wh.dim_devices"
[0m21:58:48.188580 [debug] [Thread-2 (]: On test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    pk_transaction_id as unique_field,
    count(*) as n_records

from takehome_db.takehome_schema_staging.stg_product__transactions
where pk_transaction_id is not null
group by pk_transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:58:48.189020 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:58:48.190498 [debug] [Thread-1 (]: Using snowflake connection "model.takehome_wh.dim_devices"
[0m21:58:48.190764 [debug] [Thread-1 (]: On model.takehome_wh.dim_devices: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.dim_devices"} */
create or replace transient table takehome_db.takehome_schema_mart.dim_devices
         as
        (with
    -- import CTEs

    stores as (select * from takehome_db.takehome_schema_staging.stg_product__stores),

    devices as (select * from takehome_db.takehome_schema_staging.stg_product__devices),

    -- logical CTEs
    final as (
        select
            devices.pk_device_id,
            devices.device_type,
            devices.store_id,
            stores.store_name,
            stores.store_address,
            stores.store_city,
            stores.store_country,
            stores.store_device_typology,
            stores.store_created_at,
            stores.customer_id,
            
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from devices
        left join stores on devices.store_id = stores.pk_store_id
    )

select *
from final
        );
[0m21:58:48.191249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:58:48.689634 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.501 seconds
[0m21:58:48.691164 [debug] [Thread-2 (]: On test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df: Close
[0m21:58:48.853139 [info ] [Thread-2 (]: 9 of 12 PASS unique_stg_product__transactions_pk_transaction_id ................ [[32mPASS[0m in 0.72s]
[0m21:58:48.853774 [debug] [Thread-2 (]: Finished running node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m21:58:48.854222 [debug] [Thread-2 (]: Began running node model.takehome_wh.fct_transactions
[0m21:58:48.854566 [info ] [Thread-2 (]: 11 of 12 START sql table model takehome_schema_mart.fct_transactions ........... [RUN]
[0m21:58:48.854894 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df, now model.takehome_wh.fct_transactions)
[0m21:58:48.855138 [debug] [Thread-2 (]: Began compiling node model.takehome_wh.fct_transactions
[0m21:58:48.860723 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome_wh.fct_transactions"
[0m21:58:48.861616 [debug] [Thread-2 (]: Began executing node model.takehome_wh.fct_transactions
[0m21:58:48.863949 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome_wh.fct_transactions"
[0m21:58:48.865124 [debug] [Thread-2 (]: Using snowflake connection "model.takehome_wh.fct_transactions"
[0m21:58:48.865391 [debug] [Thread-2 (]: On model.takehome_wh.fct_transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.fct_transactions"} */
create or replace transient table takehome_db.takehome_schema_mart.fct_transactions
         as
        (with
    -- import CTEs
    transactions as (select * from takehome_db.takehome_schema_staging.stg_product__transactions),

    stores as (select * from takehome_db.takehome_schema_staging.stg_product__stores),

    devices as (select * from takehome_db.takehome_schema_staging.stg_product__devices),

    -- logical CTEs
    final as (
        select
            transactions.pk_transaction_id,
            transaction_happened_at,
            transaction_status,
            transaction_product_name,
            transaction_product_sku,
            transaction_amount_eur,

            device_id,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from transactions
        left join devices on transactions.device_id = devices.pk_device_id
    )

select *
from final
        );
[0m21:58:48.865628 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:58:49.135968 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.944 seconds
[0m21:58:49.148640 [debug] [Thread-1 (]: On model.takehome_wh.dim_devices: Close
[0m21:58:49.306571 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '490a27b2-2cd7-4eb2-b9bb-bcc023db537c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d75450>]}
[0m21:58:49.307190 [info ] [Thread-1 (]: 10 of 12 OK created sql table model takehome_schema_mart.dim_devices ........... [[32mSUCCESS 1[0m in 1.16s]
[0m21:58:49.308199 [debug] [Thread-1 (]: Finished running node model.takehome_wh.dim_devices
[0m21:58:49.799237 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.934 seconds
[0m21:58:49.802385 [debug] [Thread-2 (]: On model.takehome_wh.fct_transactions: Close
[0m21:58:49.956831 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '490a27b2-2cd7-4eb2-b9bb-bcc023db537c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133ec550>]}
[0m21:58:49.957519 [info ] [Thread-2 (]: 11 of 12 OK created sql table model takehome_schema_mart.fct_transactions ...... [[32mSUCCESS 1[0m in 1.10s]
[0m21:58:49.958401 [debug] [Thread-2 (]: Finished running node model.takehome_wh.fct_transactions
[0m21:58:49.960438 [debug] [Thread-1 (]: Began running node model.takehome_wh.rpt_device_performance
[0m21:58:49.961564 [info ] [Thread-1 (]: 12 of 12 START sql table model takehome_schema_reporting.rpt_device_performance  [RUN]
[0m21:58:49.962029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.takehome_wh.dim_devices, now model.takehome_wh.rpt_device_performance)
[0m21:58:49.962291 [debug] [Thread-1 (]: Began compiling node model.takehome_wh.rpt_device_performance
[0m21:58:49.965718 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome_wh.rpt_device_performance"
[0m21:58:49.968189 [debug] [Thread-1 (]: Began executing node model.takehome_wh.rpt_device_performance
[0m21:58:49.973457 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome_wh.rpt_device_performance"
[0m21:58:49.976482 [debug] [Thread-1 (]: Using snowflake connection "model.takehome_wh.rpt_device_performance"
[0m21:58:49.977900 [debug] [Thread-1 (]: On model.takehome_wh.rpt_device_performance: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.rpt_device_performance"} */
create or replace transient table takehome_db.takehome_schema_reporting.rpt_device_performance
         as
        (with
    -- import CTEs
    transactions as (select * from takehome_db.takehome_schema_mart.fct_transactions),

    devices as (select * from takehome_db.takehome_schema_mart.dim_devices),

    -- logical CTEs
    final as (
        select
            devices.* exclude dbt_updated_at,
            transactions.* exclude dbt_updated_at,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from devices
        left join transactions on devices.pk_device_id = transactions.device_id
    )

select *
from final
        );
[0m21:58:49.978238 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:58:50.929045 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.950 seconds
[0m21:58:50.934595 [debug] [Thread-1 (]: On model.takehome_wh.rpt_device_performance: Close
[0m21:58:51.095049 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '490a27b2-2cd7-4eb2-b9bb-bcc023db537c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133ab190>]}
[0m21:58:51.096017 [info ] [Thread-1 (]: 12 of 12 OK created sql table model takehome_schema_reporting.rpt_device_performance  [[32mSUCCESS 1[0m in 1.13s]
[0m21:58:51.096532 [debug] [Thread-1 (]: Finished running node model.takehome_wh.rpt_device_performance
[0m21:58:51.097711 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:58:51.098035 [debug] [MainThread]: Connection 'model.takehome_wh.rpt_device_performance' was properly closed.
[0m21:58:51.098235 [debug] [MainThread]: Connection 'model.takehome_wh.fct_transactions' was properly closed.
[0m21:58:51.098739 [info ] [MainThread]: 
[0m21:58:51.103208 [info ] [MainThread]: Finished running 3 view models, 6 data tests, 3 table models in 0 hours 0 minutes and 10.09 seconds (10.09s).
[0m21:58:51.105679 [debug] [MainThread]: Command end result
[0m21:58:51.236761 [info ] [MainThread]: 
[0m21:58:51.237342 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:58:51.238155 [info ] [MainThread]: 
[0m21:58:51.238837 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m21:58:51.247522 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 10.911552, "process_user_time": 2.623156, "process_kernel_time": 0.394102, "process_mem_max_rss": "144195584", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:58:51.253903 [debug] [MainThread]: Command `dbt build` succeeded at 21:58:51.253701 after 10.92 seconds
[0m21:58:51.254947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10427bcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ad7b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ac43d0>]}
[0m21:58:51.255528 [debug] [MainThread]: Flushing usage events
[0m22:00:43.604193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104333cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cabf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cab880>]}


============================== 22:00:43.607862 | 79cec0db-d001-42fd-9aa9-efac08235f3a ==============================
[0m22:00:43.607862 [info ] [MainThread]: Running with dbt=1.8.8
[0m22:00:43.608223 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cedric.conol/Documents/takehome/', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/cedric.conol/Documents/takehome/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'target', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m22:00:43.775908 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "takehome_wh", target "dev" invalid: 'schema' is a required property
[0m22:00:43.777340 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 0.22219338, "process_user_time": 0.734298, "process_kernel_time": 0.175769, "process_mem_max_rss": "113524736", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:00:43.777706 [debug] [MainThread]: Command `dbt build` failed at 22:00:43.777656 after 0.22 seconds
[0m22:00:43.777920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104333cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059def80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050d5e10>]}
[0m22:00:43.778124 [debug] [MainThread]: Flushing usage events
[0m22:05:35.580387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d23c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10999bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10999b850>]}


============================== 22:05:35.583834 | 712a678e-90ee-43c8-941c-13eb9bb8fea5 ==============================
[0m22:05:35.583834 [info ] [MainThread]: Running with dbt=1.8.8
[0m22:05:35.584178 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cedric.conol/Documents/takehome/', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/cedric.conol/Documents/takehome/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build', 'introspect': 'True', 'target_path': 'target', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:35.809805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '712a678e-90ee-43c8-941c-13eb9bb8fea5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f41510>]}
[0m22:05:35.838825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '712a678e-90ee-43c8-941c-13eb9bb8fea5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6df1c0>]}
[0m22:05:35.839704 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:05:35.860588 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m22:05:35.943438 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m22:05:35.943997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '712a678e-90ee-43c8-941c-13eb9bb8fea5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bd9030>]}
[0m22:05:36.924031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '712a678e-90ee-43c8-941c-13eb9bb8fea5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac458d0>]}
[0m22:05:37.008847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '712a678e-90ee-43c8-941c-13eb9bb8fea5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac39e40>]}
[0m22:05:37.009203 [info ] [MainThread]: Found 6 models, 6 data tests, 3 sources, 570 macros
[0m22:05:37.010454 [info ] [MainThread]: 
[0m22:05:37.010787 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:05:37.013972 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_takehome_db'
[0m22:05:37.014261 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_takehome_db'
[0m22:05:37.021739 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db"
[0m22:05:37.023410 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db"
[0m22:05:37.023629 [debug] [ThreadPool]: On list_takehome_db: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db"} */
show terse schemas in database takehome_db
    limit 10000
[0m22:05:37.023803 [debug] [ThreadPool]: On list_takehome_db: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db"} */
show terse schemas in database takehome_db
    limit 10000
[0m22:05:37.023969 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:37.024129 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:37.993508 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.969 seconds
[0m22:05:37.997941 [debug] [ThreadPool]: On list_takehome_db: Close
[0m22:05:38.181293 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db"
[0m22:05:38.182098 [debug] [ThreadPool]: On list_takehome_db: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db"} */
show terse schemas in database takehome_db
    limit 10000
[0m22:05:38.182439 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:38.259858 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.235 seconds
[0m22:05:38.261447 [debug] [ThreadPool]: On list_takehome_db: Close
[0m22:05:38.626367 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.444 seconds
[0m22:05:38.632462 [debug] [ThreadPool]: On list_takehome_db: Close
[0m22:05:39.032546 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome_db, now list_takehome_db_takehome_schema_staging)
[0m22:05:39.033504 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome_db, now list_takehome_db_takehome_schema_mart)
[0m22:05:39.049878 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db_takehome_schema_staging"
[0m22:05:39.052844 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db_takehome_schema_mart"
[0m22:05:39.053378 [debug] [ThreadPool]: On list_takehome_db_takehome_schema_staging: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db_takehome_schema_staging"} */
show objects in takehome_db.takehome_schema_staging limit 10000
[0m22:05:39.053781 [debug] [ThreadPool]: On list_takehome_db_takehome_schema_mart: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db_takehome_schema_mart"} */
show objects in takehome_db.takehome_schema_mart limit 10000
[0m22:05:39.054493 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:39.054931 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:39.566374 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.512 seconds
[0m22:05:39.568447 [debug] [ThreadPool]: On list_takehome_db_takehome_schema_staging: Close
[0m22:05:39.573052 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.518 seconds
[0m22:05:39.574678 [debug] [ThreadPool]: On list_takehome_db_takehome_schema_mart: Close
[0m22:05:39.733114 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome_db_takehome_schema_mart, now list_takehome_db_takehome_schema_reporting)
[0m22:05:39.738783 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db_takehome_schema_reporting"
[0m22:05:39.739472 [debug] [ThreadPool]: On list_takehome_db_takehome_schema_reporting: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db_takehome_schema_reporting"} */
show objects in takehome_db.takehome_schema_reporting limit 10000
[0m22:05:39.739751 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:40.228355 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.488 seconds
[0m22:05:40.231331 [debug] [ThreadPool]: On list_takehome_db_takehome_schema_reporting: Close
[0m22:05:40.565623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '712a678e-90ee-43c8-941c-13eb9bb8fea5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b12a5f0>]}
[0m22:05:40.566670 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m22:05:40.567029 [info ] [MainThread]: 
[0m22:05:40.569195 [debug] [Thread-1 (]: Began running node model.takehome_wh.stg_product__devices
[0m22:05:40.569505 [debug] [Thread-2 (]: Began running node model.takehome_wh.stg_product__stores
[0m22:05:40.570076 [info ] [Thread-1 (]: 1 of 12 START sql view model takehome_schema_staging.stg_product__devices ...... [RUN]
[0m22:05:40.570548 [info ] [Thread-2 (]: 2 of 12 START sql view model takehome_schema_staging.stg_product__stores ....... [RUN]
[0m22:05:40.571531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_takehome_db_takehome_schema_staging, now model.takehome_wh.stg_product__devices)
[0m22:05:40.571849 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_takehome_db_takehome_schema_reporting, now model.takehome_wh.stg_product__stores)
[0m22:05:40.572207 [debug] [Thread-1 (]: Began compiling node model.takehome_wh.stg_product__devices
[0m22:05:40.572677 [debug] [Thread-2 (]: Began compiling node model.takehome_wh.stg_product__stores
[0m22:05:40.582347 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome_wh.stg_product__devices"
[0m22:05:40.585972 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome_wh.stg_product__stores"
[0m22:05:40.586950 [debug] [Thread-1 (]: Began executing node model.takehome_wh.stg_product__devices
[0m22:05:40.587238 [debug] [Thread-2 (]: Began executing node model.takehome_wh.stg_product__stores
[0m22:05:40.608040 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome_wh.stg_product__devices"
[0m22:05:40.610382 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome_wh.stg_product__stores"
[0m22:05:40.611407 [debug] [Thread-1 (]: Using snowflake connection "model.takehome_wh.stg_product__devices"
[0m22:05:40.612180 [debug] [Thread-2 (]: Using snowflake connection "model.takehome_wh.stg_product__stores"
[0m22:05:40.612468 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__devices: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.stg_product__devices"} */
create or replace   view takehome_db.takehome_schema_staging.stg_product__devices
  
   as (
    with
    devices as (select * from read_replica.product.device),

    final as (
        select
            id as pk_device_id,
            type as device_type,
            store_id,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from
            devices
    )

select *
from final
  );
[0m22:05:40.612746 [debug] [Thread-2 (]: On model.takehome_wh.stg_product__stores: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.stg_product__stores"} */
create or replace   view takehome_db.takehome_schema_staging.stg_product__stores
  
   as (
    with
    stores as (select * from read_replica.product.store),

    final as (
        select
            id as pk_store_id,
            name as store_name,
            address as store_address,
            city as store_city,
            country as store_country,
            typology as store_device_typology,
            customer_id,

            created_at as store_created_at,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from
            stores
    )

select *
from final
  );
[0m22:05:40.613393 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:40.613672 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:05:41.316192 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.703 seconds
[0m22:05:41.347951 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__devices: Close
[0m22:05:41.411712 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.798 seconds
[0m22:05:41.416550 [debug] [Thread-2 (]: On model.takehome_wh.stg_product__stores: Close
[0m22:05:41.528386 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '712a678e-90ee-43c8-941c-13eb9bb8fea5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a940340>]}
[0m22:05:41.531596 [info ] [Thread-1 (]: 1 of 12 OK created sql view model takehome_schema_staging.stg_product__devices . [[32mSUCCESS 1[0m in 0.95s]
[0m22:05:41.532747 [debug] [Thread-1 (]: Finished running node model.takehome_wh.stg_product__devices
[0m22:05:41.533442 [debug] [Thread-1 (]: Began running node model.takehome_wh.stg_product__transactions
[0m22:05:41.534873 [info ] [Thread-1 (]: 3 of 12 START sql view model takehome_schema_staging.stg_product__transactions . [RUN]
[0m22:05:41.535951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.takehome_wh.stg_product__devices, now model.takehome_wh.stg_product__transactions)
[0m22:05:41.536618 [debug] [Thread-1 (]: Began compiling node model.takehome_wh.stg_product__transactions
[0m22:05:41.543605 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome_wh.stg_product__transactions"
[0m22:05:41.548003 [debug] [Thread-1 (]: Began executing node model.takehome_wh.stg_product__transactions
[0m22:05:41.552801 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome_wh.stg_product__transactions"
[0m22:05:41.555463 [debug] [Thread-1 (]: Using snowflake connection "model.takehome_wh.stg_product__transactions"
[0m22:05:41.556244 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.stg_product__transactions"} */
create or replace   view takehome_db.takehome_schema_staging.stg_product__transactions
  
   as (
    with
    transactions as (select * from read_replica.product.transactions),

    final as (
        select
            id as pk_transaction_id,
            device_id,
            product_name as transaction_product_name,
            product_sku as transaction_product_sku,
            amount as transaction_amount_eur,
            status as transaction_status,

            -- ideally, sensitive information such as credit card numbers
            -- and CVVs should not be stored in a data warehouse
            -- these sensitive information will not be included in downstream
            -- models in this project
            
            -- if an analysis requires these two fields, and product
            -- database remain unencrypted, perform tokenization

            created_at as transaction_created_at,
            happened_at as transaction_happened_at,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from transactions
    )

select *
from final
  );
[0m22:05:41.556573 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:41.589992 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '712a678e-90ee-43c8-941c-13eb9bb8fea5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfe2d40>]}
[0m22:05:41.590668 [info ] [Thread-2 (]: 2 of 12 OK created sql view model takehome_schema_staging.stg_product__stores .. [[32mSUCCESS 1[0m in 1.02s]
[0m22:05:41.591105 [debug] [Thread-2 (]: Finished running node model.takehome_wh.stg_product__stores
[0m22:05:41.591437 [debug] [Thread-2 (]: Began running node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m22:05:41.592091 [info ] [Thread-2 (]: 4 of 12 START test not_null_stg_product__devices_pk_device_id .................. [RUN]
[0m22:05:41.592744 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome_wh.stg_product__stores, now test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941)
[0m22:05:41.593204 [debug] [Thread-2 (]: Began compiling node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m22:05:41.608931 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"
[0m22:05:41.610329 [debug] [Thread-2 (]: Began executing node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m22:05:41.625247 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"
[0m22:05:41.626585 [debug] [Thread-2 (]: Using snowflake connection "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"
[0m22:05:41.626913 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pk_device_id
from takehome_db.takehome_schema_staging.stg_product__devices
where pk_device_id is null



      
    ) dbt_internal_test
[0m22:05:41.627179 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:05:42.110082 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.553 seconds
[0m22:05:42.112025 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__transactions: Close
[0m22:05:42.135404 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.508 seconds
[0m22:05:42.141285 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941: Close
[0m22:05:42.276895 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '712a678e-90ee-43c8-941c-13eb9bb8fea5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a941090>]}
[0m22:05:42.278809 [info ] [Thread-1 (]: 3 of 12 OK created sql view model takehome_schema_staging.stg_product__transactions  [[32mSUCCESS 1[0m in 0.74s]
[0m22:05:42.281843 [debug] [Thread-1 (]: Finished running node model.takehome_wh.stg_product__transactions
[0m22:05:42.282878 [debug] [Thread-1 (]: Began running node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m22:05:42.283846 [info ] [Thread-1 (]: 5 of 12 START test unique_stg_product__devices_pk_device_id .................... [RUN]
[0m22:05:42.284916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.takehome_wh.stg_product__transactions, now test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505)
[0m22:05:42.285916 [debug] [Thread-1 (]: Began compiling node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m22:05:42.299349 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"
[0m22:05:42.300193 [debug] [Thread-1 (]: Began executing node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m22:05:42.304033 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"
[0m22:05:42.306750 [debug] [Thread-1 (]: Using snowflake connection "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"
[0m22:05:42.307570 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    pk_device_id as unique_field,
    count(*) as n_records

from takehome_db.takehome_schema_staging.stg_product__devices
where pk_device_id is not null
group by pk_device_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:05:42.307972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:42.309921 [info ] [Thread-2 (]: 4 of 12 PASS not_null_stg_product__devices_pk_device_id ........................ [[32mPASS[0m in 0.72s]
[0m22:05:42.310454 [debug] [Thread-2 (]: Finished running node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m22:05:42.310870 [debug] [Thread-2 (]: Began running node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m22:05:42.311211 [info ] [Thread-2 (]: 6 of 12 START test not_null_stg_product__stores_pk_store_id .................... [RUN]
[0m22:05:42.311540 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941, now test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696)
[0m22:05:42.311843 [debug] [Thread-2 (]: Began compiling node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m22:05:42.317889 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"
[0m22:05:42.319623 [debug] [Thread-2 (]: Began executing node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m22:05:42.325099 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"
[0m22:05:42.326218 [debug] [Thread-2 (]: Using snowflake connection "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"
[0m22:05:42.326540 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pk_store_id
from takehome_db.takehome_schema_staging.stg_product__stores
where pk_store_id is null



      
    ) dbt_internal_test
[0m22:05:42.326824 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:05:42.879497 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.571 seconds
[0m22:05:42.881123 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505: Close
[0m22:05:42.898625 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.572 seconds
[0m22:05:42.901260 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696: Close
[0m22:05:43.039690 [info ] [Thread-1 (]: 5 of 12 PASS unique_stg_product__devices_pk_device_id .......................... [[32mPASS[0m in 0.76s]
[0m22:05:43.040281 [debug] [Thread-1 (]: Finished running node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m22:05:43.040620 [debug] [Thread-1 (]: Began running node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m22:05:43.040939 [info ] [Thread-1 (]: 7 of 12 START test unique_stg_product__stores_pk_store_id ...................... [RUN]
[0m22:05:43.041267 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505, now test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e)
[0m22:05:43.041496 [debug] [Thread-1 (]: Began compiling node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m22:05:43.046950 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"
[0m22:05:43.047654 [debug] [Thread-1 (]: Began executing node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m22:05:43.052997 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"
[0m22:05:43.056609 [debug] [Thread-1 (]: Using snowflake connection "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"
[0m22:05:43.057574 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    pk_store_id as unique_field,
    count(*) as n_records

from takehome_db.takehome_schema_staging.stg_product__stores
where pk_store_id is not null
group by pk_store_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:05:43.058942 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:43.091710 [info ] [Thread-2 (]: 6 of 12 PASS not_null_stg_product__stores_pk_store_id .......................... [[32mPASS[0m in 0.78s]
[0m22:05:43.095787 [debug] [Thread-2 (]: Finished running node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m22:05:43.096436 [debug] [Thread-2 (]: Began running node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m22:05:43.096900 [info ] [Thread-2 (]: 8 of 12 START test not_null_stg_product__transactions_pk_transaction_id ........ [RUN]
[0m22:05:43.097443 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696, now test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc)
[0m22:05:43.098089 [debug] [Thread-2 (]: Began compiling node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m22:05:43.107352 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"
[0m22:05:43.113400 [debug] [Thread-2 (]: Began executing node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m22:05:43.116516 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"
[0m22:05:43.123380 [debug] [Thread-2 (]: Using snowflake connection "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"
[0m22:05:43.123729 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pk_transaction_id
from takehome_db.takehome_schema_staging.stg_product__transactions
where pk_transaction_id is null



      
    ) dbt_internal_test
[0m22:05:43.123937 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:05:43.728450 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.604 seconds
[0m22:05:43.733052 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc: Close
[0m22:05:43.737413 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.678 seconds
[0m22:05:43.740767 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e: Close
[0m22:05:43.921591 [info ] [Thread-2 (]: 8 of 12 PASS not_null_stg_product__transactions_pk_transaction_id .............. [[32mPASS[0m in 0.82s]
[0m22:05:43.922603 [info ] [Thread-1 (]: 7 of 12 PASS unique_stg_product__stores_pk_store_id ............................ [[32mPASS[0m in 0.88s]
[0m22:05:43.923842 [debug] [Thread-2 (]: Finished running node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m22:05:43.924651 [debug] [Thread-1 (]: Finished running node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m22:05:43.927275 [debug] [Thread-2 (]: Began running node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m22:05:43.929439 [debug] [Thread-1 (]: Began running node model.takehome_wh.dim_devices
[0m22:05:43.929925 [info ] [Thread-2 (]: 9 of 12 START test unique_stg_product__transactions_pk_transaction_id .......... [RUN]
[0m22:05:43.930482 [info ] [Thread-1 (]: 10 of 12 START sql table model takehome_schema_mart.dim_devices ................ [RUN]
[0m22:05:43.931199 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc, now test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df)
[0m22:05:43.931722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e, now model.takehome_wh.dim_devices)
[0m22:05:43.932103 [debug] [Thread-2 (]: Began compiling node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m22:05:43.932396 [debug] [Thread-1 (]: Began compiling node model.takehome_wh.dim_devices
[0m22:05:43.941048 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"
[0m22:05:43.946615 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome_wh.dim_devices"
[0m22:05:43.947825 [debug] [Thread-1 (]: Began executing node model.takehome_wh.dim_devices
[0m22:05:43.948142 [debug] [Thread-2 (]: Began executing node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m22:05:44.040693 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"
[0m22:05:44.063582 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome_wh.dim_devices"
[0m22:05:44.064377 [debug] [Thread-2 (]: Using snowflake connection "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"
[0m22:05:44.064684 [debug] [Thread-2 (]: On test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    pk_transaction_id as unique_field,
    count(*) as n_records

from takehome_db.takehome_schema_staging.stg_product__transactions
where pk_transaction_id is not null
group by pk_transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:05:44.064938 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:05:44.065670 [debug] [Thread-1 (]: Using snowflake connection "model.takehome_wh.dim_devices"
[0m22:05:44.066034 [debug] [Thread-1 (]: On model.takehome_wh.dim_devices: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.dim_devices"} */
create or replace transient table takehome_db.takehome_schema_mart.dim_devices
         as
        (with
    -- import CTEs

    stores as (select * from takehome_db.takehome_schema_staging.stg_product__stores),

    devices as (select * from takehome_db.takehome_schema_staging.stg_product__devices),

    -- logical CTEs
    final as (
        select
            devices.pk_device_id,
            devices.device_type,
            devices.store_id,
            stores.store_name,
            stores.store_address,
            stores.store_city,
            stores.store_country,
            stores.store_device_typology,
            stores.store_created_at,
            stores.customer_id,
            
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from devices
        left join stores on devices.store_id = stores.pk_store_id
    )

select *
from final
        );
[0m22:05:44.069499 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:44.556836 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.492 seconds
[0m22:05:44.563731 [debug] [Thread-2 (]: On test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df: Close
[0m22:05:44.737408 [info ] [Thread-2 (]: 9 of 12 PASS unique_stg_product__transactions_pk_transaction_id ................ [[32mPASS[0m in 0.81s]
[0m22:05:44.738491 [debug] [Thread-2 (]: Finished running node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m22:05:44.739307 [debug] [Thread-2 (]: Began running node model.takehome_wh.fct_transactions
[0m22:05:44.739717 [info ] [Thread-2 (]: 11 of 12 START sql table model takehome_schema_mart.fct_transactions ........... [RUN]
[0m22:05:44.740404 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df, now model.takehome_wh.fct_transactions)
[0m22:05:44.740886 [debug] [Thread-2 (]: Began compiling node model.takehome_wh.fct_transactions
[0m22:05:44.748515 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome_wh.fct_transactions"
[0m22:05:44.749931 [debug] [Thread-2 (]: Began executing node model.takehome_wh.fct_transactions
[0m22:05:44.756194 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome_wh.fct_transactions"
[0m22:05:44.759589 [debug] [Thread-2 (]: Using snowflake connection "model.takehome_wh.fct_transactions"
[0m22:05:44.761338 [debug] [Thread-2 (]: On model.takehome_wh.fct_transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.fct_transactions"} */
create or replace transient table takehome_db.takehome_schema_mart.fct_transactions
         as
        (with
    -- import CTEs
    transactions as (select * from takehome_db.takehome_schema_staging.stg_product__transactions),

    stores as (select * from takehome_db.takehome_schema_staging.stg_product__stores),

    devices as (select * from takehome_db.takehome_schema_staging.stg_product__devices),

    -- logical CTEs
    final as (
        select
            transactions.pk_transaction_id,
            transaction_happened_at,
            transaction_status,
            transaction_product_name,
            transaction_product_sku,
            transaction_amount_eur,

            device_id,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from transactions
        left join devices on transactions.device_id = devices.pk_device_id
    )

select *
from final
        );
[0m22:05:44.762155 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:05:44.910873 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.842 seconds
[0m22:05:44.912918 [debug] [Thread-1 (]: On model.takehome_wh.dim_devices: Close
[0m22:05:45.095348 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '712a678e-90ee-43c8-941c-13eb9bb8fea5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a844220>]}
[0m22:05:45.096787 [info ] [Thread-1 (]: 10 of 12 OK created sql table model takehome_schema_mart.dim_devices ........... [[32mSUCCESS 1[0m in 1.16s]
[0m22:05:45.098146 [debug] [Thread-1 (]: Finished running node model.takehome_wh.dim_devices
[0m22:05:45.629440 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.867 seconds
[0m22:05:45.637024 [debug] [Thread-2 (]: On model.takehome_wh.fct_transactions: Close
[0m22:05:45.794874 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '712a678e-90ee-43c8-941c-13eb9bb8fea5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af90310>]}
[0m22:05:45.795753 [info ] [Thread-2 (]: 11 of 12 OK created sql table model takehome_schema_mart.fct_transactions ...... [[32mSUCCESS 1[0m in 1.05s]
[0m22:05:45.796592 [debug] [Thread-2 (]: Finished running node model.takehome_wh.fct_transactions
[0m22:05:45.797432 [debug] [Thread-1 (]: Began running node model.takehome_wh.rpt_device_performance
[0m22:05:45.798055 [info ] [Thread-1 (]: 12 of 12 START sql table model takehome_schema_reporting.rpt_device_performance  [RUN]
[0m22:05:45.798752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.takehome_wh.dim_devices, now model.takehome_wh.rpt_device_performance)
[0m22:05:45.799196 [debug] [Thread-1 (]: Began compiling node model.takehome_wh.rpt_device_performance
[0m22:05:45.806257 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome_wh.rpt_device_performance"
[0m22:05:45.807322 [debug] [Thread-1 (]: Began executing node model.takehome_wh.rpt_device_performance
[0m22:05:45.812239 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome_wh.rpt_device_performance"
[0m22:05:45.813612 [debug] [Thread-1 (]: Using snowflake connection "model.takehome_wh.rpt_device_performance"
[0m22:05:45.813987 [debug] [Thread-1 (]: On model.takehome_wh.rpt_device_performance: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.rpt_device_performance"} */
create or replace transient table takehome_db.takehome_schema_reporting.rpt_device_performance
         as
        (with
    -- import CTEs
    transactions as (select * from takehome_db.takehome_schema_mart.fct_transactions),

    devices as (select * from takehome_db.takehome_schema_mart.dim_devices),

    -- logical CTEs
    final as (
        select
            devices.* exclude dbt_updated_at,
            transactions.* exclude dbt_updated_at,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from devices
        left join transactions on devices.pk_device_id = transactions.device_id
    )

select *
from final
        );
[0m22:05:45.814371 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:46.786869 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.972 seconds
[0m22:05:46.794458 [debug] [Thread-1 (]: On model.takehome_wh.rpt_device_performance: Close
[0m22:05:46.957129 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '712a678e-90ee-43c8-941c-13eb9bb8fea5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac070d0>]}
[0m22:05:46.961595 [info ] [Thread-1 (]: 12 of 12 OK created sql table model takehome_schema_reporting.rpt_device_performance  [[32mSUCCESS 1[0m in 1.16s]
[0m22:05:46.962757 [debug] [Thread-1 (]: Finished running node model.takehome_wh.rpt_device_performance
[0m22:05:46.964625 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:46.965270 [debug] [MainThread]: Connection 'model.takehome_wh.rpt_device_performance' was properly closed.
[0m22:05:46.965711 [debug] [MainThread]: Connection 'model.takehome_wh.fct_transactions' was properly closed.
[0m22:05:46.966321 [info ] [MainThread]: 
[0m22:05:46.969420 [info ] [MainThread]: Finished running 3 view models, 6 data tests, 3 table models in 0 hours 0 minutes and 9.96 seconds (9.96s).
[0m22:05:46.971982 [debug] [MainThread]: Command end result
[0m22:05:47.019432 [info ] [MainThread]: 
[0m22:05:47.019931 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:47.020212 [info ] [MainThread]: 
[0m22:05:47.020456 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m22:05:47.022042 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 11.485509, "process_user_time": 3.178955, "process_kernel_time": 0.38756, "process_mem_max_rss": "135790592", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:47.022463 [debug] [MainThread]: Command `dbt build` succeeded at 22:05:47.022407 after 11.49 seconds
[0m22:05:47.022748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d23c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acb7040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fa2d40>]}
[0m22:05:47.023011 [debug] [MainThread]: Flushing usage events
[0m22:09:57.920833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062d3d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11089bf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11089b880>]}


============================== 22:09:57.923985 | dba52a89-8d8c-413e-a710-1e386a72598e ==============================
[0m22:09:57.923985 [info ] [MainThread]: Running with dbt=1.8.8
[0m22:09:57.924346 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cedric.conol/Documents/takehome/', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/cedric.conol/Documents/takehome/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'target', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:09:58.083891 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "takehome_wh", target "dev" invalid: 'schema' is a required property
[0m22:09:58.085392 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 0.2103807, "process_user_time": 0.687571, "process_kernel_time": 0.14735, "process_mem_max_rss": "113016832", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:09:58.085723 [debug] [MainThread]: Command `dbt build` failed at 22:09:58.085675 after 0.21 seconds
[0m22:09:58.085927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062d3d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110537340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114ddcf0>]}
[0m22:09:58.086260 [debug] [MainThread]: Flushing usage events
[0m22:10:58.533965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ddbd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106753fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067538b0>]}


============================== 22:10:58.537689 | a1c39d53-650a-4bc0-8406-f7babe9ac3a7 ==============================
[0m22:10:58.537689 [info ] [MainThread]: Running with dbt=1.8.8
[0m22:10:58.538045 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cedric.conol/Documents/takehome/', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/cedric.conol/Documents/takehome/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'target', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:10:58.766526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1c39d53-650a-4bc0-8406-f7babe9ac3a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10738beb0>]}
[0m22:10:58.792985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1c39d53-650a-4bc0-8406-f7babe9ac3a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10540e080>]}
[0m22:10:58.793809 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:10:58.818908 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m22:10:58.904885 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m22:10:58.905362 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m22:10:58.905640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a1c39d53-650a-4bc0-8406-f7babe9ac3a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b90d90>]}
[0m22:10:59.859254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1c39d53-650a-4bc0-8406-f7babe9ac3a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077e13f0>]}
[0m22:10:59.936495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1c39d53-650a-4bc0-8406-f7babe9ac3a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107594dc0>]}
[0m22:10:59.936862 [info ] [MainThread]: Found 6 models, 6 data tests, 3 sources, 570 macros
[0m22:10:59.938143 [info ] [MainThread]: 
[0m22:10:59.938473 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:10:59.941680 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_takehome_db'
[0m22:10:59.941979 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_takehome_db'
[0m22:10:59.949708 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db"
[0m22:10:59.951242 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db"
[0m22:10:59.951455 [debug] [ThreadPool]: On list_takehome_db: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db"} */
show terse schemas in database takehome_db
    limit 10000
[0m22:10:59.951674 [debug] [ThreadPool]: On list_takehome_db: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db"} */
show terse schemas in database takehome_db
    limit 10000
[0m22:10:59.951889 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:10:59.952065 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:11:00.515328 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.563 seconds
[0m22:11:00.524324 [debug] [ThreadPool]: On list_takehome_db: Close
[0m22:11:00.532418 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.580 seconds
[0m22:11:00.539491 [debug] [ThreadPool]: On list_takehome_db: Close
[0m22:11:00.727422 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db"
[0m22:11:00.730475 [debug] [ThreadPool]: On list_takehome_db: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db"} */
show terse schemas in database takehome_db
    limit 10000
[0m22:11:00.731293 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:11:01.224749 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.493 seconds
[0m22:11:01.227976 [debug] [ThreadPool]: On list_takehome_db: Close
[0m22:11:01.405952 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome_db, now create_takehome_db_tmp_schema_reporting)
[0m22:11:01.406859 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome_db, now create_takehome_db_tmp_schema_staging)
[0m22:11:01.407854 [debug] [ThreadPool]: Creating schema "database: "takehome_db"
schema: "tmp_schema_reporting"
"
[0m22:11:01.408669 [debug] [ThreadPool]: Creating schema "database: "takehome_db"
schema: "tmp_schema_staging"
"
[0m22:11:01.421633 [debug] [ThreadPool]: Using snowflake connection "create_takehome_db_tmp_schema_reporting"
[0m22:11:01.424577 [debug] [ThreadPool]: Using snowflake connection "create_takehome_db_tmp_schema_staging"
[0m22:11:01.425069 [debug] [ThreadPool]: On create_takehome_db_tmp_schema_reporting: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "create_takehome_db_tmp_schema_reporting"} */
create schema if not exists takehome_db.tmp_schema_reporting
[0m22:11:01.425352 [debug] [ThreadPool]: On create_takehome_db_tmp_schema_staging: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "create_takehome_db_tmp_schema_staging"} */
create schema if not exists takehome_db.tmp_schema_staging
[0m22:11:01.425602 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:11:01.425826 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:11:01.926035 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.500 seconds
[0m22:11:01.927162 [debug] [ThreadPool]: On create_takehome_db_tmp_schema_reporting: Close
[0m22:11:01.940315 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.514 seconds
[0m22:11:01.941365 [debug] [ThreadPool]: On create_takehome_db_tmp_schema_staging: Close
[0m22:11:02.071251 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_takehome_db_tmp_schema_reporting, now create_takehome_db_tmp_schema_mart)
[0m22:11:02.071885 [debug] [ThreadPool]: Creating schema "database: "takehome_db"
schema: "tmp_schema_mart"
"
[0m22:11:02.074347 [debug] [ThreadPool]: Using snowflake connection "create_takehome_db_tmp_schema_mart"
[0m22:11:02.074745 [debug] [ThreadPool]: On create_takehome_db_tmp_schema_mart: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "create_takehome_db_tmp_schema_mart"} */
create schema if not exists takehome_db.tmp_schema_mart
[0m22:11:02.075094 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:11:02.506516 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.431 seconds
[0m22:11:02.509314 [debug] [ThreadPool]: On create_takehome_db_tmp_schema_mart: Close
[0m22:11:02.663780 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_takehome_db_tmp_schema_mart, now list_takehome_db_tmp_schema_reporting)
[0m22:11:02.665429 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_takehome_db_tmp_schema_staging, now list_takehome_db_tmp_schema_staging)
[0m22:11:02.683274 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db_tmp_schema_reporting"
[0m22:11:02.686947 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db_tmp_schema_staging"
[0m22:11:02.687467 [debug] [ThreadPool]: On list_takehome_db_tmp_schema_reporting: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db_tmp_schema_reporting"} */
show objects in takehome_db.tmp_schema_reporting limit 10000
[0m22:11:02.687860 [debug] [ThreadPool]: On list_takehome_db_tmp_schema_staging: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db_tmp_schema_staging"} */
show objects in takehome_db.tmp_schema_staging limit 10000
[0m22:11:02.688277 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:11:02.688667 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:11:03.138598 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.450 seconds
[0m22:11:03.144602 [debug] [ThreadPool]: On list_takehome_db_tmp_schema_reporting: Close
[0m22:11:03.176324 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.488 seconds
[0m22:11:03.179398 [debug] [ThreadPool]: On list_takehome_db_tmp_schema_staging: Close
[0m22:11:03.295417 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome_db_tmp_schema_reporting, now list_takehome_db_tmp_schema_mart)
[0m22:11:03.302777 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db_tmp_schema_mart"
[0m22:11:03.303855 [debug] [ThreadPool]: On list_takehome_db_tmp_schema_mart: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db_tmp_schema_mart"} */
show objects in takehome_db.tmp_schema_mart limit 10000
[0m22:11:03.304436 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:11:03.772414 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.468 seconds
[0m22:11:03.776505 [debug] [ThreadPool]: On list_takehome_db_tmp_schema_mart: Close
[0m22:11:03.943043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1c39d53-650a-4bc0-8406-f7babe9ac3a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c17e20>]}
[0m22:11:03.944648 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m22:11:03.945368 [info ] [MainThread]: 
[0m22:11:03.950726 [debug] [Thread-1 (]: Began running node model.takehome_wh.stg_product__devices
[0m22:11:03.951542 [debug] [Thread-2 (]: Began running node model.takehome_wh.stg_product__stores
[0m22:11:03.952852 [info ] [Thread-1 (]: 1 of 12 START sql view model tmp_schema_staging.stg_product__devices ........... [RUN]
[0m22:11:03.953825 [info ] [Thread-2 (]: 2 of 12 START sql view model tmp_schema_staging.stg_product__stores ............ [RUN]
[0m22:11:03.954747 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_takehome_db_tmp_schema_mart, now model.takehome_wh.stg_product__devices)
[0m22:11:03.955619 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_takehome_db_tmp_schema_staging, now model.takehome_wh.stg_product__stores)
[0m22:11:03.956386 [debug] [Thread-1 (]: Began compiling node model.takehome_wh.stg_product__devices
[0m22:11:03.957597 [debug] [Thread-2 (]: Began compiling node model.takehome_wh.stg_product__stores
[0m22:11:03.970845 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome_wh.stg_product__devices"
[0m22:11:03.977066 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome_wh.stg_product__stores"
[0m22:11:03.978083 [debug] [Thread-2 (]: Began executing node model.takehome_wh.stg_product__stores
[0m22:11:03.978407 [debug] [Thread-1 (]: Began executing node model.takehome_wh.stg_product__devices
[0m22:11:04.001513 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome_wh.stg_product__stores"
[0m22:11:04.004384 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome_wh.stg_product__devices"
[0m22:11:04.006128 [debug] [Thread-2 (]: Using snowflake connection "model.takehome_wh.stg_product__stores"
[0m22:11:04.007216 [debug] [Thread-1 (]: Using snowflake connection "model.takehome_wh.stg_product__devices"
[0m22:11:04.008089 [debug] [Thread-2 (]: On model.takehome_wh.stg_product__stores: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.stg_product__stores"} */
create or replace   view takehome_db.tmp_schema_staging.stg_product__stores
  
   as (
    with
    stores as (select * from read_replica.product.store),

    final as (
        select
            id as pk_store_id,
            name as store_name,
            address as store_address,
            city as store_city,
            country as store_country,
            typology as store_device_typology,
            customer_id,

            created_at as store_created_at,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from
            stores
    )

select *
from final
  );
[0m22:11:04.008608 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__devices: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.stg_product__devices"} */
create or replace   view takehome_db.tmp_schema_staging.stg_product__devices
  
   as (
    with
    devices as (select * from read_replica.product.device),

    final as (
        select
            id as pk_device_id,
            type as device_type,
            store_id,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from
            devices
    )

select *
from final
  );
[0m22:11:04.008938 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:11:04.009207 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:11:04.553356 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.544 seconds
[0m22:11:04.586472 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__devices: Close
[0m22:11:04.609241 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.600 seconds
[0m22:11:04.611758 [debug] [Thread-2 (]: On model.takehome_wh.stg_product__stores: Close
[0m22:11:04.748009 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1c39d53-650a-4bc0-8406-f7babe9ac3a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076ba860>]}
[0m22:11:04.750560 [info ] [Thread-1 (]: 1 of 12 OK created sql view model tmp_schema_staging.stg_product__devices ...... [[32mSUCCESS 1[0m in 0.79s]
[0m22:11:04.751630 [debug] [Thread-1 (]: Finished running node model.takehome_wh.stg_product__devices
[0m22:11:04.752368 [debug] [Thread-1 (]: Began running node model.takehome_wh.stg_product__transactions
[0m22:11:04.753865 [info ] [Thread-1 (]: 3 of 12 START sql view model tmp_schema_staging.stg_product__transactions ...... [RUN]
[0m22:11:04.754867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.takehome_wh.stg_product__devices, now model.takehome_wh.stg_product__transactions)
[0m22:11:04.755573 [debug] [Thread-1 (]: Began compiling node model.takehome_wh.stg_product__transactions
[0m22:11:04.763056 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome_wh.stg_product__transactions"
[0m22:11:04.766973 [debug] [Thread-1 (]: Began executing node model.takehome_wh.stg_product__transactions
[0m22:11:04.771413 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome_wh.stg_product__transactions"
[0m22:11:04.774950 [debug] [Thread-1 (]: Using snowflake connection "model.takehome_wh.stg_product__transactions"
[0m22:11:04.775728 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1c39d53-650a-4bc0-8406-f7babe9ac3a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e135540>]}
[0m22:11:04.776276 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.stg_product__transactions"} */
create or replace   view takehome_db.tmp_schema_staging.stg_product__transactions
  
   as (
    with
    transactions as (select * from read_replica.product.transactions),

    final as (
        select
            id as pk_transaction_id,
            device_id,
            product_name as transaction_product_name,
            product_sku as transaction_product_sku,
            amount as transaction_amount_eur,
            status as transaction_status,

            -- ideally, sensitive information such as credit card numbers
            -- and CVVs should not be stored in a data warehouse
            -- these sensitive information will not be included in downstream
            -- models in this project
            
            -- if an analysis requires these two fields, and product
            -- database remain unencrypted, perform tokenization

            created_at as transaction_created_at,
            happened_at as transaction_happened_at,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from transactions
    )

select *
from final
  );
[0m22:11:04.776974 [info ] [Thread-2 (]: 2 of 12 OK created sql view model tmp_schema_staging.stg_product__stores ....... [[32mSUCCESS 1[0m in 0.82s]
[0m22:11:04.777387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:11:04.777978 [debug] [Thread-2 (]: Finished running node model.takehome_wh.stg_product__stores
[0m22:11:04.779121 [debug] [Thread-2 (]: Began running node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m22:11:04.779984 [info ] [Thread-2 (]: 4 of 12 START test not_null_stg_product__devices_pk_device_id .................. [RUN]
[0m22:11:04.780492 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome_wh.stg_product__stores, now test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941)
[0m22:11:04.780825 [debug] [Thread-2 (]: Began compiling node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m22:11:04.793501 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"
[0m22:11:04.795051 [debug] [Thread-2 (]: Began executing node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m22:11:04.807686 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"
[0m22:11:04.809023 [debug] [Thread-2 (]: Using snowflake connection "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"
[0m22:11:04.809308 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pk_device_id
from takehome_db.tmp_schema_staging.stg_product__devices
where pk_device_id is null



      
    ) dbt_internal_test
[0m22:11:04.809558 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:11:05.359596 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.550 seconds
[0m22:11:05.366237 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941: Close
[0m22:11:05.420072 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.643 seconds
[0m22:11:05.422937 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__transactions: Close
[0m22:11:05.543163 [info ] [Thread-2 (]: 4 of 12 PASS not_null_stg_product__devices_pk_device_id ........................ [[32mPASS[0m in 0.76s]
[0m22:11:05.543922 [debug] [Thread-2 (]: Finished running node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m22:11:05.544360 [debug] [Thread-2 (]: Began running node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m22:11:05.544845 [info ] [Thread-2 (]: 5 of 12 START test unique_stg_product__devices_pk_device_id .................... [RUN]
[0m22:11:05.545340 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941, now test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505)
[0m22:11:05.545688 [debug] [Thread-2 (]: Began compiling node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m22:11:05.553925 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"
[0m22:11:05.554939 [debug] [Thread-2 (]: Began executing node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m22:11:05.559424 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"
[0m22:11:05.560555 [debug] [Thread-2 (]: Using snowflake connection "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"
[0m22:11:05.560876 [debug] [Thread-2 (]: On test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    pk_device_id as unique_field,
    count(*) as n_records

from takehome_db.tmp_schema_staging.stg_product__devices
where pk_device_id is not null
group by pk_device_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:11:05.561158 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:11:05.594267 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1c39d53-650a-4bc0-8406-f7babe9ac3a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107931a20>]}
[0m22:11:05.595124 [info ] [Thread-1 (]: 3 of 12 OK created sql view model tmp_schema_staging.stg_product__transactions . [[32mSUCCESS 1[0m in 0.84s]
[0m22:11:05.595606 [debug] [Thread-1 (]: Finished running node model.takehome_wh.stg_product__transactions
[0m22:11:05.595926 [debug] [Thread-1 (]: Began running node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m22:11:05.596189 [info ] [Thread-1 (]: 6 of 12 START test not_null_stg_product__stores_pk_store_id .................... [RUN]
[0m22:11:05.596688 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.takehome_wh.stg_product__transactions, now test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696)
[0m22:11:05.597002 [debug] [Thread-1 (]: Began compiling node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m22:11:05.603308 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"
[0m22:11:05.604500 [debug] [Thread-1 (]: Began executing node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m22:11:05.688234 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"
[0m22:11:05.689628 [debug] [Thread-1 (]: Using snowflake connection "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"
[0m22:11:05.689871 [debug] [Thread-1 (]: On test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pk_store_id
from takehome_db.tmp_schema_staging.stg_product__stores
where pk_store_id is null



      
    ) dbt_internal_test
[0m22:11:05.692072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:11:06.143403 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.582 seconds
[0m22:11:06.145563 [debug] [Thread-2 (]: On test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505: Close
[0m22:11:06.161520 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.469 seconds
[0m22:11:06.163525 [debug] [Thread-1 (]: On test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696: Close
[0m22:11:06.318025 [info ] [Thread-2 (]: 5 of 12 PASS unique_stg_product__devices_pk_device_id .......................... [[32mPASS[0m in 0.77s]
[0m22:11:06.318718 [info ] [Thread-1 (]: 6 of 12 PASS not_null_stg_product__stores_pk_store_id .......................... [[32mPASS[0m in 0.72s]
[0m22:11:06.319721 [debug] [Thread-2 (]: Finished running node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m22:11:06.320284 [debug] [Thread-1 (]: Finished running node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m22:11:06.320761 [debug] [Thread-2 (]: Began running node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m22:11:06.321304 [debug] [Thread-1 (]: Began running node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m22:11:06.321783 [info ] [Thread-2 (]: 7 of 12 START test unique_stg_product__stores_pk_store_id ...................... [RUN]
[0m22:11:06.322255 [info ] [Thread-1 (]: 8 of 12 START test not_null_stg_product__transactions_pk_transaction_id ........ [RUN]
[0m22:11:06.322805 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505, now test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e)
[0m22:11:06.323287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696, now test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc)
[0m22:11:06.325299 [debug] [Thread-2 (]: Began compiling node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m22:11:06.325973 [debug] [Thread-1 (]: Began compiling node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m22:11:06.330998 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"
[0m22:11:06.337550 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"
[0m22:11:06.339129 [debug] [Thread-1 (]: Began executing node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m22:11:06.339465 [debug] [Thread-2 (]: Began executing node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m22:11:06.343364 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"
[0m22:11:06.346679 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"
[0m22:11:06.347815 [debug] [Thread-1 (]: Using snowflake connection "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"
[0m22:11:06.349413 [debug] [Thread-2 (]: Using snowflake connection "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"
[0m22:11:06.350365 [debug] [Thread-1 (]: On test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pk_transaction_id
from takehome_db.tmp_schema_staging.stg_product__transactions
where pk_transaction_id is null



      
    ) dbt_internal_test
[0m22:11:06.350748 [debug] [Thread-2 (]: On test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    pk_store_id as unique_field,
    count(*) as n_records

from takehome_db.tmp_schema_staging.stg_product__stores
where pk_store_id is not null
group by pk_store_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:11:06.351055 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:11:06.351406 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:11:06.883365 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.532 seconds
[0m22:11:06.887118 [debug] [Thread-2 (]: On test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e: Close
[0m22:11:06.917479 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.566 seconds
[0m22:11:06.920581 [debug] [Thread-1 (]: On test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc: Close
[0m22:11:07.058578 [info ] [Thread-2 (]: 7 of 12 PASS unique_stg_product__stores_pk_store_id ............................ [[32mPASS[0m in 0.74s]
[0m22:11:07.059578 [debug] [Thread-2 (]: Finished running node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m22:11:07.060237 [debug] [Thread-2 (]: Began running node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m22:11:07.061200 [info ] [Thread-2 (]: 9 of 12 START test unique_stg_product__transactions_pk_transaction_id .......... [RUN]
[0m22:11:07.062061 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e, now test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df)
[0m22:11:07.062590 [debug] [Thread-2 (]: Began compiling node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m22:11:07.070896 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"
[0m22:11:07.074582 [debug] [Thread-2 (]: Began executing node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m22:11:07.080150 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"
[0m22:11:07.081727 [debug] [Thread-2 (]: Using snowflake connection "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"
[0m22:11:07.083850 [debug] [Thread-2 (]: On test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    pk_transaction_id as unique_field,
    count(*) as n_records

from takehome_db.tmp_schema_staging.stg_product__transactions
where pk_transaction_id is not null
group by pk_transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:11:07.084290 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:11:07.089865 [info ] [Thread-1 (]: 8 of 12 PASS not_null_stg_product__transactions_pk_transaction_id .............. [[32mPASS[0m in 0.77s]
[0m22:11:07.091933 [debug] [Thread-1 (]: Finished running node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m22:11:07.092444 [debug] [Thread-1 (]: Began running node model.takehome_wh.dim_devices
[0m22:11:07.092925 [info ] [Thread-1 (]: 10 of 12 START sql table model tmp_schema_mart.dim_devices ..................... [RUN]
[0m22:11:07.093330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc, now model.takehome_wh.dim_devices)
[0m22:11:07.093629 [debug] [Thread-1 (]: Began compiling node model.takehome_wh.dim_devices
[0m22:11:07.097076 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome_wh.dim_devices"
[0m22:11:07.098110 [debug] [Thread-1 (]: Began executing node model.takehome_wh.dim_devices
[0m22:11:07.120164 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome_wh.dim_devices"
[0m22:11:07.123078 [debug] [Thread-1 (]: Using snowflake connection "model.takehome_wh.dim_devices"
[0m22:11:07.124289 [debug] [Thread-1 (]: On model.takehome_wh.dim_devices: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.dim_devices"} */
create or replace transient table takehome_db.tmp_schema_mart.dim_devices
         as
        (with
    -- import CTEs

    stores as (select * from takehome_db.tmp_schema_staging.stg_product__stores),

    devices as (select * from takehome_db.tmp_schema_staging.stg_product__devices),

    -- logical CTEs
    final as (
        select
            devices.pk_device_id,
            devices.device_type,
            devices.store_id,
            stores.store_name,
            stores.store_address,
            stores.store_city,
            stores.store_country,
            stores.store_device_typology,
            stores.store_created_at,
            stores.customer_id,
            
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from devices
        left join stores on devices.store_id = stores.pk_store_id
    )

select *
from final
        );
[0m22:11:07.124678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:11:07.604575 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.520 seconds
[0m22:11:07.608359 [debug] [Thread-2 (]: On test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df: Close
[0m22:11:07.775778 [info ] [Thread-2 (]: 9 of 12 PASS unique_stg_product__transactions_pk_transaction_id ................ [[32mPASS[0m in 0.71s]
[0m22:11:07.777084 [debug] [Thread-2 (]: Finished running node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m22:11:07.778194 [debug] [Thread-2 (]: Began running node model.takehome_wh.fct_transactions
[0m22:11:07.779157 [info ] [Thread-2 (]: 11 of 12 START sql table model tmp_schema_mart.fct_transactions ................ [RUN]
[0m22:11:07.780540 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df, now model.takehome_wh.fct_transactions)
[0m22:11:07.781199 [debug] [Thread-2 (]: Began compiling node model.takehome_wh.fct_transactions
[0m22:11:07.789875 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome_wh.fct_transactions"
[0m22:11:07.792361 [debug] [Thread-2 (]: Began executing node model.takehome_wh.fct_transactions
[0m22:11:07.795913 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome_wh.fct_transactions"
[0m22:11:07.797548 [debug] [Thread-2 (]: Using snowflake connection "model.takehome_wh.fct_transactions"
[0m22:11:07.797951 [debug] [Thread-2 (]: On model.takehome_wh.fct_transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.fct_transactions"} */
create or replace transient table takehome_db.tmp_schema_mart.fct_transactions
         as
        (with
    -- import CTEs
    transactions as (select * from takehome_db.tmp_schema_staging.stg_product__transactions),

    stores as (select * from takehome_db.tmp_schema_staging.stg_product__stores),

    devices as (select * from takehome_db.tmp_schema_staging.stg_product__devices),

    -- logical CTEs
    final as (
        select
            transactions.pk_transaction_id,
            transaction_happened_at,
            transaction_status,
            transaction_product_name,
            transaction_product_sku,
            transaction_amount_eur,

            device_id,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from transactions
        left join devices on transactions.device_id = devices.pk_device_id
    )

select *
from final
        );
[0m22:11:07.798901 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:11:08.230835 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.106 seconds
[0m22:11:08.237727 [debug] [Thread-1 (]: On model.takehome_wh.dim_devices: Close
[0m22:11:08.395350 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1c39d53-650a-4bc0-8406-f7babe9ac3a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107de59c0>]}
[0m22:11:08.397072 [info ] [Thread-1 (]: 10 of 12 OK created sql table model tmp_schema_mart.dim_devices ................ [[32mSUCCESS 1[0m in 1.30s]
[0m22:11:08.398112 [debug] [Thread-1 (]: Finished running node model.takehome_wh.dim_devices
[0m22:11:08.758960 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.960 seconds
[0m22:11:08.763101 [debug] [Thread-2 (]: On model.takehome_wh.fct_transactions: Close
[0m22:11:08.929834 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1c39d53-650a-4bc0-8406-f7babe9ac3a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10751bc70>]}
[0m22:11:08.930865 [info ] [Thread-2 (]: 11 of 12 OK created sql table model tmp_schema_mart.fct_transactions ........... [[32mSUCCESS 1[0m in 1.15s]
[0m22:11:08.931562 [debug] [Thread-2 (]: Finished running node model.takehome_wh.fct_transactions
[0m22:11:08.933610 [debug] [Thread-1 (]: Began running node model.takehome_wh.rpt_device_performance
[0m22:11:08.934446 [info ] [Thread-1 (]: 12 of 12 START sql table model tmp_schema_reporting.rpt_device_performance ..... [RUN]
[0m22:11:08.935035 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.takehome_wh.dim_devices, now model.takehome_wh.rpt_device_performance)
[0m22:11:08.935424 [debug] [Thread-1 (]: Began compiling node model.takehome_wh.rpt_device_performance
[0m22:11:08.942980 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome_wh.rpt_device_performance"
[0m22:11:08.944020 [debug] [Thread-1 (]: Began executing node model.takehome_wh.rpt_device_performance
[0m22:11:08.947213 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome_wh.rpt_device_performance"
[0m22:11:08.949328 [debug] [Thread-1 (]: Using snowflake connection "model.takehome_wh.rpt_device_performance"
[0m22:11:08.949977 [debug] [Thread-1 (]: On model.takehome_wh.rpt_device_performance: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.rpt_device_performance"} */
create or replace transient table takehome_db.tmp_schema_reporting.rpt_device_performance
         as
        (with
    -- import CTEs
    transactions as (select * from takehome_db.tmp_schema_mart.fct_transactions),

    devices as (select * from takehome_db.tmp_schema_mart.dim_devices),

    -- logical CTEs
    final as (
        select
            devices.* exclude dbt_updated_at,
            transactions.* exclude dbt_updated_at,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from devices
        left join transactions on devices.pk_device_id = transactions.device_id
    )

select *
from final
        );
[0m22:11:08.950569 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:11:10.294922 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.344 seconds
[0m22:11:10.302746 [debug] [Thread-1 (]: On model.takehome_wh.rpt_device_performance: Close
[0m22:11:10.492573 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1c39d53-650a-4bc0-8406-f7babe9ac3a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078959f0>]}
[0m22:11:10.494067 [info ] [Thread-1 (]: 12 of 12 OK created sql table model tmp_schema_reporting.rpt_device_performance  [[32mSUCCESS 1[0m in 1.56s]
[0m22:11:10.495155 [debug] [Thread-1 (]: Finished running node model.takehome_wh.rpt_device_performance
[0m22:11:10.497465 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:11:10.498023 [debug] [MainThread]: Connection 'model.takehome_wh.rpt_device_performance' was properly closed.
[0m22:11:10.499299 [debug] [MainThread]: Connection 'model.takehome_wh.fct_transactions' was properly closed.
[0m22:11:10.501252 [info ] [MainThread]: 
[0m22:11:10.502243 [info ] [MainThread]: Finished running 3 view models, 6 data tests, 3 table models in 0 hours 0 minutes and 10.56 seconds (10.56s).
[0m22:11:10.506141 [debug] [MainThread]: Command end result
[0m22:11:10.550042 [info ] [MainThread]: 
[0m22:11:10.550565 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:11:10.550814 [info ] [MainThread]: 
[0m22:11:10.551171 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m22:11:10.552998 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 12.067098, "process_user_time": 3.478107, "process_kernel_time": 0.369265, "process_mem_max_rss": "145997824", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:11:10.553477 [debug] [MainThread]: Command `dbt build` succeeded at 22:11:10.553417 after 12.07 seconds
[0m22:11:10.553795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ddbd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b7b4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10540e080>]}
[0m22:11:10.554071 [debug] [MainThread]: Flushing usage events
[0m22:13:00.218280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069d3d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123a91450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123a91b10>]}


============================== 22:13:00.222061 | 216daef2-cbdc-4f87-857a-f2ec8cba867f ==============================
[0m22:13:00.222061 [info ] [MainThread]: Running with dbt=1.8.8
[0m22:13:00.222483 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cedric.conol/Documents/takehome/', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/cedric.conol/Documents/takehome/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build', 'log_format': 'default', 'target_path': 'target', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:13:00.477627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '216daef2-cbdc-4f87-857a-f2ec8cba867f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120ec0e50>]}
[0m22:13:00.504332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '216daef2-cbdc-4f87-857a-f2ec8cba867f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123762680>]}
[0m22:13:00.505010 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:13:00.520549 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m22:13:00.585762 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m22:13:00.586226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '216daef2-cbdc-4f87-857a-f2ec8cba867f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120ed8d90>]}
[0m22:13:01.548807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '216daef2-cbdc-4f87-857a-f2ec8cba867f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124e412d0>]}
[0m22:13:01.625609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '216daef2-cbdc-4f87-857a-f2ec8cba867f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124e05960>]}
[0m22:13:01.625969 [info ] [MainThread]: Found 6 models, 6 data tests, 3 sources, 570 macros
[0m22:13:01.627222 [info ] [MainThread]: 
[0m22:13:01.627550 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:13:01.630805 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_takehome_db'
[0m22:13:01.631090 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_takehome_db'
[0m22:13:01.638469 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db"
[0m22:13:01.640111 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db"
[0m22:13:01.640336 [debug] [ThreadPool]: On list_takehome_db: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db"} */
show terse schemas in database takehome_db
    limit 10000
[0m22:13:01.640517 [debug] [ThreadPool]: On list_takehome_db: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db"} */
show terse schemas in database takehome_db
    limit 10000
[0m22:13:01.640686 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:13:01.640847 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:13:02.192298 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.551 seconds
[0m22:13:02.196410 [debug] [ThreadPool]: On list_takehome_db: Close
[0m22:13:02.197317 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.556 seconds
[0m22:13:02.199646 [debug] [ThreadPool]: On list_takehome_db: Close
[0m22:13:02.369731 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db"
[0m22:13:02.371268 [debug] [ThreadPool]: On list_takehome_db: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db"} */
show terse schemas in database takehome_db
    limit 10000
[0m22:13:02.371829 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:13:02.863373 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.492 seconds
[0m22:13:02.864459 [debug] [ThreadPool]: On list_takehome_db: Close
[0m22:13:03.033755 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome_db, now list_takehome_db_tmp_schema_mart)
[0m22:13:03.034327 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome_db, now list_takehome_db_tmp_schema_reporting)
[0m22:13:03.042606 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db_tmp_schema_mart"
[0m22:13:03.045535 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db_tmp_schema_reporting"
[0m22:13:03.046029 [debug] [ThreadPool]: On list_takehome_db_tmp_schema_mart: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db_tmp_schema_mart"} */
show objects in takehome_db.tmp_schema_mart limit 10000
[0m22:13:03.046277 [debug] [ThreadPool]: On list_takehome_db_tmp_schema_reporting: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db_tmp_schema_reporting"} */
show objects in takehome_db.tmp_schema_reporting limit 10000
[0m22:13:03.046508 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:13:03.046715 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:13:03.519743 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.473 seconds
[0m22:13:03.523379 [debug] [ThreadPool]: On list_takehome_db_tmp_schema_mart: Close
[0m22:13:03.613287 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.566 seconds
[0m22:13:03.616920 [debug] [ThreadPool]: On list_takehome_db_tmp_schema_reporting: Close
[0m22:13:03.701771 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome_db_tmp_schema_mart, now list_takehome_db_tmp_schema_staging)
[0m22:13:03.711978 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db_tmp_schema_staging"
[0m22:13:03.713055 [debug] [ThreadPool]: On list_takehome_db_tmp_schema_staging: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db_tmp_schema_staging"} */
show objects in takehome_db.tmp_schema_staging limit 10000
[0m22:13:03.713457 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:13:04.221548 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.508 seconds
[0m22:13:04.225502 [debug] [ThreadPool]: On list_takehome_db_tmp_schema_staging: Close
[0m22:13:04.402857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '216daef2-cbdc-4f87-857a-f2ec8cba867f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124cf4fa0>]}
[0m22:13:04.404271 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m22:13:04.405047 [info ] [MainThread]: 
[0m22:13:04.411357 [debug] [Thread-1 (]: Began running node model.takehome_wh.stg_product__devices
[0m22:13:04.412207 [debug] [Thread-2 (]: Began running node model.takehome_wh.stg_product__stores
[0m22:13:04.413708 [info ] [Thread-1 (]: 1 of 12 START sql view model tmp_schema_staging.stg_product__devices ........... [RUN]
[0m22:13:04.417723 [info ] [Thread-2 (]: 2 of 12 START sql view model tmp_schema_staging.stg_product__stores ............ [RUN]
[0m22:13:04.418590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_takehome_db_tmp_schema_staging, now model.takehome_wh.stg_product__devices)
[0m22:13:04.418929 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_takehome_db_tmp_schema_reporting, now model.takehome_wh.stg_product__stores)
[0m22:13:04.419215 [debug] [Thread-1 (]: Began compiling node model.takehome_wh.stg_product__devices
[0m22:13:04.420139 [debug] [Thread-2 (]: Began compiling node model.takehome_wh.stg_product__stores
[0m22:13:04.436900 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome_wh.stg_product__devices"
[0m22:13:04.442259 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome_wh.stg_product__stores"
[0m22:13:04.444074 [debug] [Thread-1 (]: Began executing node model.takehome_wh.stg_product__devices
[0m22:13:04.444401 [debug] [Thread-2 (]: Began executing node model.takehome_wh.stg_product__stores
[0m22:13:04.483073 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome_wh.stg_product__devices"
[0m22:13:04.483797 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome_wh.stg_product__stores"
[0m22:13:04.484723 [debug] [Thread-1 (]: Using snowflake connection "model.takehome_wh.stg_product__devices"
[0m22:13:04.485308 [debug] [Thread-2 (]: Using snowflake connection "model.takehome_wh.stg_product__stores"
[0m22:13:04.485554 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__devices: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.stg_product__devices"} */
create or replace   view takehome_db.tmp_schema_staging.stg_product__devices
  
   as (
    with
    devices as (select * from read_replica.product.device),

    final as (
        select
            id as pk_device_id,
            type as device_type,
            store_id,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from
            devices
    )

select *
from final
  );
[0m22:13:04.485840 [debug] [Thread-2 (]: On model.takehome_wh.stg_product__stores: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.stg_product__stores"} */
create or replace   view takehome_db.tmp_schema_staging.stg_product__stores
  
   as (
    with
    stores as (select * from read_replica.product.store),

    final as (
        select
            id as pk_store_id,
            name as store_name,
            address as store_address,
            city as store_city,
            country as store_country,
            typology as store_device_typology,
            customer_id,

            created_at as store_created_at,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from
            stores
    )

select *
from final
  );
[0m22:13:04.486109 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:13:04.486327 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:13:05.029500 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.543 seconds
[0m22:13:05.059703 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__devices: Close
[0m22:13:05.061479 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.575 seconds
[0m22:13:05.063640 [debug] [Thread-2 (]: On model.takehome_wh.stg_product__stores: Close
[0m22:13:05.229844 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '216daef2-cbdc-4f87-857a-f2ec8cba867f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1248df6d0>]}
[0m22:13:05.230449 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '216daef2-cbdc-4f87-857a-f2ec8cba867f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120ec0040>]}
[0m22:13:05.231109 [info ] [Thread-1 (]: 1 of 12 OK created sql view model tmp_schema_staging.stg_product__devices ...... [[32mSUCCESS 1[0m in 0.81s]
[0m22:13:05.232830 [info ] [Thread-2 (]: 2 of 12 OK created sql view model tmp_schema_staging.stg_product__stores ....... [[32mSUCCESS 1[0m in 0.81s]
[0m22:13:05.233432 [debug] [Thread-1 (]: Finished running node model.takehome_wh.stg_product__devices
[0m22:13:05.233810 [debug] [Thread-2 (]: Finished running node model.takehome_wh.stg_product__stores
[0m22:13:05.234136 [debug] [Thread-1 (]: Began running node model.takehome_wh.stg_product__transactions
[0m22:13:05.234665 [debug] [Thread-2 (]: Began running node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m22:13:05.235104 [info ] [Thread-1 (]: 3 of 12 START sql view model tmp_schema_staging.stg_product__transactions ...... [RUN]
[0m22:13:05.235478 [info ] [Thread-2 (]: 4 of 12 START test not_null_stg_product__devices_pk_device_id .................. [RUN]
[0m22:13:05.235891 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.takehome_wh.stg_product__devices, now model.takehome_wh.stg_product__transactions)
[0m22:13:05.236203 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome_wh.stg_product__stores, now test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941)
[0m22:13:05.236509 [debug] [Thread-1 (]: Began compiling node model.takehome_wh.stg_product__transactions
[0m22:13:05.236774 [debug] [Thread-2 (]: Began compiling node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m22:13:05.240411 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome_wh.stg_product__transactions"
[0m22:13:05.251153 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"
[0m22:13:05.253175 [debug] [Thread-2 (]: Began executing node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m22:13:05.253423 [debug] [Thread-1 (]: Began executing node model.takehome_wh.stg_product__transactions
[0m22:13:05.267211 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"
[0m22:13:05.269760 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome_wh.stg_product__transactions"
[0m22:13:05.271341 [debug] [Thread-2 (]: Using snowflake connection "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"
[0m22:13:05.272129 [debug] [Thread-1 (]: Using snowflake connection "model.takehome_wh.stg_product__transactions"
[0m22:13:05.273134 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pk_device_id
from takehome_db.tmp_schema_staging.stg_product__devices
where pk_device_id is null



      
    ) dbt_internal_test
[0m22:13:05.274020 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.stg_product__transactions"} */
create or replace   view takehome_db.tmp_schema_staging.stg_product__transactions
  
   as (
    with
    transactions as (select * from read_replica.product.transactions),

    final as (
        select
            id as pk_transaction_id,
            device_id,
            product_name as transaction_product_name,
            product_sku as transaction_product_sku,
            amount as transaction_amount_eur,
            status as transaction_status,

            -- ideally, sensitive information such as credit card numbers
            -- and CVVs should not be stored in a data warehouse
            -- these sensitive information will not be included in downstream
            -- models in this project
            
            -- if an analysis requires these two fields, and product
            -- database remain unencrypted, perform tokenization

            created_at as transaction_created_at,
            happened_at as transaction_happened_at,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from transactions
    )

select *
from final
  );
[0m22:13:05.274346 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:13:05.274598 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:13:05.813002 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.538 seconds
[0m22:13:05.824493 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941: Close
[0m22:13:05.964219 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.689 seconds
[0m22:13:05.968642 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__transactions: Close
[0m22:13:06.010643 [info ] [Thread-2 (]: 4 of 12 PASS not_null_stg_product__devices_pk_device_id ........................ [[32mPASS[0m in 0.77s]
[0m22:13:06.012055 [debug] [Thread-2 (]: Finished running node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m22:13:06.012852 [debug] [Thread-2 (]: Began running node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m22:13:06.013693 [info ] [Thread-2 (]: 5 of 12 START test unique_stg_product__devices_pk_device_id .................... [RUN]
[0m22:13:06.016670 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941, now test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505)
[0m22:13:06.017928 [debug] [Thread-2 (]: Began compiling node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m22:13:06.030283 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"
[0m22:13:06.032549 [debug] [Thread-2 (]: Began executing node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m22:13:06.036571 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"
[0m22:13:06.038271 [debug] [Thread-2 (]: Using snowflake connection "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"
[0m22:13:06.038885 [debug] [Thread-2 (]: On test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    pk_device_id as unique_field,
    count(*) as n_records

from takehome_db.tmp_schema_staging.stg_product__devices
where pk_device_id is not null
group by pk_device_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:13:06.039308 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:13:06.143493 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '216daef2-cbdc-4f87-857a-f2ec8cba867f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12647d750>]}
[0m22:13:06.144439 [info ] [Thread-1 (]: 3 of 12 OK created sql view model tmp_schema_staging.stg_product__transactions . [[32mSUCCESS 1[0m in 0.91s]
[0m22:13:06.145024 [debug] [Thread-1 (]: Finished running node model.takehome_wh.stg_product__transactions
[0m22:13:06.145454 [debug] [Thread-1 (]: Began running node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m22:13:06.146001 [info ] [Thread-1 (]: 6 of 12 START test not_null_stg_product__stores_pk_store_id .................... [RUN]
[0m22:13:06.146498 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.takehome_wh.stg_product__transactions, now test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696)
[0m22:13:06.146817 [debug] [Thread-1 (]: Began compiling node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m22:13:06.155341 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"
[0m22:13:06.159301 [debug] [Thread-1 (]: Began executing node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m22:13:06.162645 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"
[0m22:13:06.163827 [debug] [Thread-1 (]: Using snowflake connection "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"
[0m22:13:06.164194 [debug] [Thread-1 (]: On test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pk_store_id
from takehome_db.tmp_schema_staging.stg_product__stores
where pk_store_id is null



      
    ) dbt_internal_test
[0m22:13:06.165220 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:13:06.572376 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.533 seconds
[0m22:13:06.577960 [debug] [Thread-2 (]: On test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505: Close
[0m22:13:06.693356 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.528 seconds
[0m22:13:06.697002 [debug] [Thread-1 (]: On test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696: Close
[0m22:13:06.754254 [info ] [Thread-2 (]: 5 of 12 PASS unique_stg_product__devices_pk_device_id .......................... [[32mPASS[0m in 0.74s]
[0m22:13:06.756164 [debug] [Thread-2 (]: Finished running node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m22:13:06.758002 [debug] [Thread-2 (]: Began running node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m22:13:06.758661 [info ] [Thread-2 (]: 7 of 12 START test unique_stg_product__stores_pk_store_id ...................... [RUN]
[0m22:13:06.759345 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505, now test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e)
[0m22:13:06.759965 [debug] [Thread-2 (]: Began compiling node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m22:13:06.767677 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"
[0m22:13:06.769844 [debug] [Thread-2 (]: Began executing node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m22:13:06.774675 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"
[0m22:13:06.776436 [debug] [Thread-2 (]: Using snowflake connection "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"
[0m22:13:06.776929 [debug] [Thread-2 (]: On test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    pk_store_id as unique_field,
    count(*) as n_records

from takehome_db.tmp_schema_staging.stg_product__stores
where pk_store_id is not null
group by pk_store_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:13:06.777330 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:13:06.876960 [info ] [Thread-1 (]: 6 of 12 PASS not_null_stg_product__stores_pk_store_id .......................... [[32mPASS[0m in 0.73s]
[0m22:13:06.878207 [debug] [Thread-1 (]: Finished running node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m22:13:06.878615 [debug] [Thread-1 (]: Began running node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m22:13:06.879070 [info ] [Thread-1 (]: 8 of 12 START test not_null_stg_product__transactions_pk_transaction_id ........ [RUN]
[0m22:13:06.879532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696, now test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc)
[0m22:13:06.879872 [debug] [Thread-1 (]: Began compiling node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m22:13:06.886488 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"
[0m22:13:06.887612 [debug] [Thread-1 (]: Began executing node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m22:13:06.986960 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"
[0m22:13:06.989004 [debug] [Thread-1 (]: Using snowflake connection "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"
[0m22:13:06.990186 [debug] [Thread-1 (]: On test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pk_transaction_id
from takehome_db.tmp_schema_staging.stg_product__transactions
where pk_transaction_id is null



      
    ) dbt_internal_test
[0m22:13:06.990776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:13:07.334105 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.557 seconds
[0m22:13:07.336583 [debug] [Thread-2 (]: On test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e: Close
[0m22:13:07.482812 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.492 seconds
[0m22:13:07.484888 [debug] [Thread-1 (]: On test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc: Close
[0m22:13:07.493611 [info ] [Thread-2 (]: 7 of 12 PASS unique_stg_product__stores_pk_store_id ............................ [[32mPASS[0m in 0.73s]
[0m22:13:07.494378 [debug] [Thread-2 (]: Finished running node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m22:13:07.494803 [debug] [Thread-2 (]: Began running node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m22:13:07.495397 [info ] [Thread-2 (]: 9 of 12 START test unique_stg_product__transactions_pk_transaction_id .......... [RUN]
[0m22:13:07.495898 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e, now test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df)
[0m22:13:07.496252 [debug] [Thread-2 (]: Began compiling node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m22:13:07.502561 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"
[0m22:13:07.503717 [debug] [Thread-2 (]: Began executing node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m22:13:07.508521 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"
[0m22:13:07.509597 [debug] [Thread-2 (]: Using snowflake connection "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"
[0m22:13:07.509921 [debug] [Thread-2 (]: On test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    pk_transaction_id as unique_field,
    count(*) as n_records

from takehome_db.tmp_schema_staging.stg_product__transactions
where pk_transaction_id is not null
group by pk_transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:13:07.510212 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:13:07.642510 [info ] [Thread-1 (]: 8 of 12 PASS not_null_stg_product__transactions_pk_transaction_id .............. [[32mPASS[0m in 0.76s]
[0m22:13:07.643191 [debug] [Thread-1 (]: Finished running node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m22:13:07.643603 [debug] [Thread-1 (]: Began running node model.takehome_wh.dim_devices
[0m22:13:07.644191 [info ] [Thread-1 (]: 10 of 12 START sql table model tmp_schema_mart.dim_devices ..................... [RUN]
[0m22:13:07.644684 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc, now model.takehome_wh.dim_devices)
[0m22:13:07.645032 [debug] [Thread-1 (]: Began compiling node model.takehome_wh.dim_devices
[0m22:13:07.652874 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome_wh.dim_devices"
[0m22:13:07.654248 [debug] [Thread-1 (]: Began executing node model.takehome_wh.dim_devices
[0m22:13:07.676111 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome_wh.dim_devices"
[0m22:13:07.677576 [debug] [Thread-1 (]: Using snowflake connection "model.takehome_wh.dim_devices"
[0m22:13:07.677899 [debug] [Thread-1 (]: On model.takehome_wh.dim_devices: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.dim_devices"} */
create or replace transient table takehome_db.tmp_schema_mart.dim_devices
         as
        (with
    -- import CTEs

    stores as (select * from takehome_db.tmp_schema_staging.stg_product__stores),

    devices as (select * from takehome_db.tmp_schema_staging.stg_product__devices),

    -- logical CTEs
    final as (
        select
            devices.pk_device_id,
            devices.device_type,
            devices.store_id,
            stores.store_name,
            stores.store_address,
            stores.store_city,
            stores.store_country,
            stores.store_device_typology,
            stores.store_created_at,
            stores.customer_id,
            
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from devices
        left join stores on devices.store_id = stores.pk_store_id
    )

select *
from final
        );
[0m22:13:07.678181 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:13:08.032120 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.521 seconds
[0m22:13:08.036145 [debug] [Thread-2 (]: On test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df: Close
[0m22:13:08.225189 [info ] [Thread-2 (]: 9 of 12 PASS unique_stg_product__transactions_pk_transaction_id ................ [[32mPASS[0m in 0.73s]
[0m22:13:08.227098 [debug] [Thread-2 (]: Finished running node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m22:13:08.228522 [debug] [Thread-2 (]: Began running node model.takehome_wh.fct_transactions
[0m22:13:08.229429 [info ] [Thread-2 (]: 11 of 12 START sql table model tmp_schema_mart.fct_transactions ................ [RUN]
[0m22:13:08.230371 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df, now model.takehome_wh.fct_transactions)
[0m22:13:08.230975 [debug] [Thread-2 (]: Began compiling node model.takehome_wh.fct_transactions
[0m22:13:08.241117 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome_wh.fct_transactions"
[0m22:13:08.242927 [debug] [Thread-2 (]: Began executing node model.takehome_wh.fct_transactions
[0m22:13:08.247273 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome_wh.fct_transactions"
[0m22:13:08.250575 [debug] [Thread-2 (]: Using snowflake connection "model.takehome_wh.fct_transactions"
[0m22:13:08.251216 [debug] [Thread-2 (]: On model.takehome_wh.fct_transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.fct_transactions"} */
create or replace transient table takehome_db.tmp_schema_mart.fct_transactions
         as
        (with
    -- import CTEs
    transactions as (select * from takehome_db.tmp_schema_staging.stg_product__transactions),

    stores as (select * from takehome_db.tmp_schema_staging.stg_product__stores),

    devices as (select * from takehome_db.tmp_schema_staging.stg_product__devices),

    -- logical CTEs
    final as (
        select
            transactions.pk_transaction_id,
            transaction_happened_at,
            transaction_status,
            transaction_product_name,
            transaction_product_sku,
            transaction_amount_eur,

            device_id,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from transactions
        left join devices on transactions.device_id = devices.pk_device_id
    )

select *
from final
        );
[0m22:13:08.251675 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:13:08.669514 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.991 seconds
[0m22:13:08.675963 [debug] [Thread-1 (]: On model.takehome_wh.dim_devices: Close
[0m22:13:08.849961 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '216daef2-cbdc-4f87-857a-f2ec8cba867f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126361210>]}
[0m22:13:08.851470 [info ] [Thread-1 (]: 10 of 12 OK created sql table model tmp_schema_mart.dim_devices ................ [[32mSUCCESS 1[0m in 1.20s]
[0m22:13:08.852528 [debug] [Thread-1 (]: Finished running node model.takehome_wh.dim_devices
[0m22:13:09.219231 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.967 seconds
[0m22:13:09.225338 [debug] [Thread-2 (]: On model.takehome_wh.fct_transactions: Close
[0m22:13:09.382498 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '216daef2-cbdc-4f87-857a-f2ec8cba867f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126338d00>]}
[0m22:13:09.383672 [info ] [Thread-2 (]: 11 of 12 OK created sql table model tmp_schema_mart.fct_transactions ........... [[32mSUCCESS 1[0m in 1.15s]
[0m22:13:09.384498 [debug] [Thread-2 (]: Finished running node model.takehome_wh.fct_transactions
[0m22:13:09.385204 [debug] [Thread-1 (]: Began running node model.takehome_wh.rpt_device_performance
[0m22:13:09.385760 [info ] [Thread-1 (]: 12 of 12 START sql table model tmp_schema_reporting.rpt_device_performance ..... [RUN]
[0m22:13:09.386275 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.takehome_wh.dim_devices, now model.takehome_wh.rpt_device_performance)
[0m22:13:09.386661 [debug] [Thread-1 (]: Began compiling node model.takehome_wh.rpt_device_performance
[0m22:13:09.393961 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome_wh.rpt_device_performance"
[0m22:13:09.395014 [debug] [Thread-1 (]: Began executing node model.takehome_wh.rpt_device_performance
[0m22:13:09.397625 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome_wh.rpt_device_performance"
[0m22:13:09.400657 [debug] [Thread-1 (]: Using snowflake connection "model.takehome_wh.rpt_device_performance"
[0m22:13:09.401128 [debug] [Thread-1 (]: On model.takehome_wh.rpt_device_performance: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.rpt_device_performance"} */
create or replace transient table takehome_db.tmp_schema_reporting.rpt_device_performance
         as
        (with
    -- import CTEs
    transactions as (select * from takehome_db.tmp_schema_mart.fct_transactions),

    devices as (select * from takehome_db.tmp_schema_mart.dim_devices),

    -- logical CTEs
    final as (
        select
            devices.* exclude dbt_updated_at,
            transactions.* exclude dbt_updated_at,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from devices
        left join transactions on devices.pk_device_id = transactions.device_id
    )

select *
from final
        );
[0m22:13:09.401438 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:13:10.365625 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.964 seconds
[0m22:13:10.370403 [debug] [Thread-1 (]: On model.takehome_wh.rpt_device_performance: Close
[0m22:13:10.611528 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '216daef2-cbdc-4f87-857a-f2ec8cba867f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d8e6b0>]}
[0m22:13:10.613591 [info ] [Thread-1 (]: 12 of 12 OK created sql table model tmp_schema_reporting.rpt_device_performance  [[32mSUCCESS 1[0m in 1.22s]
[0m22:13:10.614443 [debug] [Thread-1 (]: Finished running node model.takehome_wh.rpt_device_performance
[0m22:13:10.618012 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:13:10.618621 [debug] [MainThread]: Connection 'model.takehome_wh.rpt_device_performance' was properly closed.
[0m22:13:10.618983 [debug] [MainThread]: Connection 'model.takehome_wh.fct_transactions' was properly closed.
[0m22:13:10.619587 [info ] [MainThread]: 
[0m22:13:10.620112 [info ] [MainThread]: Finished running 3 view models, 6 data tests, 3 table models in 0 hours 0 minutes and 8.99 seconds (8.99s).
[0m22:13:10.624731 [debug] [MainThread]: Command end result
[0m22:13:10.669401 [info ] [MainThread]: 
[0m22:13:10.670002 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:13:10.670273 [info ] [MainThread]: 
[0m22:13:10.670518 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m22:13:10.672418 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 10.508901, "process_user_time": 3.250172, "process_kernel_time": 0.364659, "process_mem_max_rss": "142295040", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:13:10.674585 [debug] [MainThread]: Command `dbt build` succeeded at 22:13:10.674045 after 10.51 seconds
[0m22:13:10.675430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069d3d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120ec2c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1249aa110>]}
[0m22:13:10.675852 [debug] [MainThread]: Flushing usage events
[0m22:15:45.846843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a97cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106401420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106401ae0>]}


============================== 22:15:45.850195 | c1f72978-0285-4593-a7b6-cbd10b7881f5 ==============================
[0m22:15:45.850195 [info ] [MainThread]: Running with dbt=1.8.8
[0m22:15:45.850625 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/cedric.conol/Documents/takehome/logs', 'version_check': 'True', 'profiles_dir': '/Users/cedric.conol/Documents/takehome/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'target', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:15:46.111145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1f72978-0285-4593-a7b6-cbd10b7881f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fd62f0>]}
[0m22:15:46.140164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1f72978-0285-4593-a7b6-cbd10b7881f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060d47c0>]}
[0m22:15:46.140840 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:15:46.154491 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m22:15:46.227314 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m22:15:46.227702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c1f72978-0285-4593-a7b6-cbd10b7881f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10584d030>]}
[0m22:15:47.510751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1f72978-0285-4593-a7b6-cbd10b7881f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10749d390>]}
[0m22:15:47.600249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1f72978-0285-4593-a7b6-cbd10b7881f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072450f0>]}
[0m22:15:47.600630 [info ] [MainThread]: Found 6 models, 6 data tests, 3 sources, 570 macros
[0m22:15:47.602604 [info ] [MainThread]: 
[0m22:15:47.603102 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:15:47.606672 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_takehome_db'
[0m22:15:47.607047 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_takehome_db'
[0m22:15:47.616769 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db"
[0m22:15:47.619625 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db"
[0m22:15:47.620075 [debug] [ThreadPool]: On list_takehome_db: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db"} */
show terse schemas in database takehome_db
    limit 10000
[0m22:15:47.620343 [debug] [ThreadPool]: On list_takehome_db: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db"} */
show terse schemas in database takehome_db
    limit 10000
[0m22:15:47.620545 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:47.620715 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:48.269836 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.648 seconds
[0m22:15:48.273293 [debug] [ThreadPool]: On list_takehome_db: Close
[0m22:15:48.279077 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.658 seconds
[0m22:15:48.280988 [debug] [ThreadPool]: On list_takehome_db: Close
[0m22:15:48.460896 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db"
[0m22:15:48.461925 [debug] [ThreadPool]: On list_takehome_db: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db"} */
show terse schemas in database takehome_db
    limit 10000
[0m22:15:48.462197 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:15:48.969458 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.507 seconds
[0m22:15:48.972280 [debug] [ThreadPool]: On list_takehome_db: Close
[0m22:15:49.150375 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome_db, now create_takehome_db_takehome_schema_staging)
[0m22:15:49.153685 [debug] [ThreadPool]: Creating schema "database: "takehome_db"
schema: "takehome_schema_staging"
"
[0m22:15:49.155202 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome_db, now create_takehome_db_takehome_schema_reporting)
[0m22:15:49.171372 [debug] [ThreadPool]: Using snowflake connection "create_takehome_db_takehome_schema_staging"
[0m22:15:49.171993 [debug] [ThreadPool]: Creating schema "database: "takehome_db"
schema: "takehome_schema_reporting"
"
[0m22:15:49.172271 [debug] [ThreadPool]: On create_takehome_db_takehome_schema_staging: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "create_takehome_db_takehome_schema_staging"} */
create schema if not exists takehome_db.takehome_schema_staging
[0m22:15:49.174405 [debug] [ThreadPool]: Using snowflake connection "create_takehome_db_takehome_schema_reporting"
[0m22:15:49.174829 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:15:49.175153 [debug] [ThreadPool]: On create_takehome_db_takehome_schema_reporting: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "create_takehome_db_takehome_schema_reporting"} */
create schema if not exists takehome_db.takehome_schema_reporting
[0m22:15:49.177183 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:15:49.770067 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.593 seconds
[0m22:15:49.772091 [debug] [ThreadPool]: On create_takehome_db_takehome_schema_reporting: Close
[0m22:15:49.778342 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.603 seconds
[0m22:15:49.780554 [debug] [ThreadPool]: On create_takehome_db_takehome_schema_staging: Close
[0m22:15:49.947185 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_takehome_db_takehome_schema_reporting, now create_takehome_db_takehome_schema_mart)
[0m22:15:49.948738 [debug] [ThreadPool]: Creating schema "database: "takehome_db"
schema: "takehome_schema_mart"
"
[0m22:15:49.956742 [debug] [ThreadPool]: Using snowflake connection "create_takehome_db_takehome_schema_mart"
[0m22:15:49.958465 [debug] [ThreadPool]: On create_takehome_db_takehome_schema_mart: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "create_takehome_db_takehome_schema_mart"} */
create schema if not exists takehome_db.takehome_schema_mart
[0m22:15:49.959246 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:15:50.472311 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.513 seconds
[0m22:15:50.475044 [debug] [ThreadPool]: On create_takehome_db_takehome_schema_mart: Close
[0m22:15:50.643857 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_takehome_db_takehome_schema_mart, now list_takehome_db_takehome_schema_staging)
[0m22:15:50.644610 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_takehome_db_takehome_schema_staging, now list_takehome_db_takehome_schema_reporting)
[0m22:15:50.650774 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db_takehome_schema_staging"
[0m22:15:50.653187 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db_takehome_schema_reporting"
[0m22:15:50.653499 [debug] [ThreadPool]: On list_takehome_db_takehome_schema_staging: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db_takehome_schema_staging"} */
show objects in takehome_db.takehome_schema_staging limit 10000
[0m22:15:50.653720 [debug] [ThreadPool]: On list_takehome_db_takehome_schema_reporting: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db_takehome_schema_reporting"} */
show objects in takehome_db.takehome_schema_reporting limit 10000
[0m22:15:50.653922 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:15:50.654107 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:15:51.138495 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.484 seconds
[0m22:15:51.141074 [debug] [ThreadPool]: On list_takehome_db_takehome_schema_reporting: Close
[0m22:15:51.154690 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.501 seconds
[0m22:15:51.157013 [debug] [ThreadPool]: On list_takehome_db_takehome_schema_staging: Close
[0m22:15:51.304430 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome_db_takehome_schema_reporting, now list_takehome_db_takehome_schema_mart)
[0m22:15:51.311950 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db_takehome_schema_mart"
[0m22:15:51.312756 [debug] [ThreadPool]: On list_takehome_db_takehome_schema_mart: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db_takehome_schema_mart"} */
show objects in takehome_db.takehome_schema_mart limit 10000
[0m22:15:51.313158 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:15:51.796286 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.483 seconds
[0m22:15:51.799858 [debug] [ThreadPool]: On list_takehome_db_takehome_schema_mart: Close
[0m22:15:51.957789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1f72978-0285-4593-a7b6-cbd10b7881f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074d6860>]}
[0m22:15:51.959399 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m22:15:51.960481 [info ] [MainThread]: 
[0m22:15:51.965773 [debug] [Thread-1 (]: Began running node model.takehome_wh.stg_product__devices
[0m22:15:51.966534 [debug] [Thread-2 (]: Began running node model.takehome_wh.stg_product__stores
[0m22:15:51.968992 [info ] [Thread-1 (]: 1 of 12 START sql view model takehome_schema_staging.stg_product__devices ...... [RUN]
[0m22:15:51.970574 [info ] [Thread-2 (]: 2 of 12 START sql view model takehome_schema_staging.stg_product__stores ....... [RUN]
[0m22:15:51.971533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_takehome_db_takehome_schema_staging, now model.takehome_wh.stg_product__devices)
[0m22:15:51.972831 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_takehome_db_takehome_schema_mart, now model.takehome_wh.stg_product__stores)
[0m22:15:51.973670 [debug] [Thread-1 (]: Began compiling node model.takehome_wh.stg_product__devices
[0m22:15:51.974296 [debug] [Thread-2 (]: Began compiling node model.takehome_wh.stg_product__stores
[0m22:15:51.997289 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome_wh.stg_product__devices"
[0m22:15:51.998000 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome_wh.stg_product__stores"
[0m22:15:51.999146 [debug] [Thread-1 (]: Began executing node model.takehome_wh.stg_product__devices
[0m22:15:51.999569 [debug] [Thread-2 (]: Began executing node model.takehome_wh.stg_product__stores
[0m22:15:52.040229 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome_wh.stg_product__devices"
[0m22:15:52.041648 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome_wh.stg_product__stores"
[0m22:15:52.042770 [debug] [Thread-2 (]: Using snowflake connection "model.takehome_wh.stg_product__stores"
[0m22:15:52.044205 [debug] [Thread-1 (]: Using snowflake connection "model.takehome_wh.stg_product__devices"
[0m22:15:52.044605 [debug] [Thread-2 (]: On model.takehome_wh.stg_product__stores: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.stg_product__stores"} */
create or replace   view takehome_db.takehome_schema_staging.stg_product__stores
  
   as (
    with
    stores as (select * from read_replica.product.store),

    final as (
        select
            id as pk_store_id,
            name as store_name,
            address as store_address,
            city as store_city,
            country as store_country,
            typology as store_device_typology,
            customer_id,

            created_at as store_created_at,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from
            stores
    )

select *
from final
  );
[0m22:15:52.044928 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__devices: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.stg_product__devices"} */
create or replace   view takehome_db.takehome_schema_staging.stg_product__devices
  
   as (
    with
    devices as (select * from read_replica.product.device),

    final as (
        select
            id as pk_device_id,
            type as device_type,
            store_id,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from
            devices
    )

select *
from final
  );
[0m22:15:52.045284 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:15:52.045538 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:15:52.623538 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.578 seconds
[0m22:15:52.661815 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__devices: Close
[0m22:15:52.687605 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.642 seconds
[0m22:15:52.690090 [debug] [Thread-2 (]: On model.takehome_wh.stg_product__stores: Close
[0m22:15:52.832500 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1f72978-0285-4593-a7b6-cbd10b7881f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ec76a0>]}
[0m22:15:52.833849 [info ] [Thread-1 (]: 1 of 12 OK created sql view model takehome_schema_staging.stg_product__devices . [[32mSUCCESS 1[0m in 0.86s]
[0m22:15:52.835659 [debug] [Thread-1 (]: Finished running node model.takehome_wh.stg_product__devices
[0m22:15:52.836839 [debug] [Thread-1 (]: Began running node model.takehome_wh.stg_product__transactions
[0m22:15:52.837646 [info ] [Thread-1 (]: 3 of 12 START sql view model takehome_schema_staging.stg_product__transactions . [RUN]
[0m22:15:52.838350 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.takehome_wh.stg_product__devices, now model.takehome_wh.stg_product__transactions)
[0m22:15:52.838789 [debug] [Thread-1 (]: Began compiling node model.takehome_wh.stg_product__transactions
[0m22:15:52.845841 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome_wh.stg_product__transactions"
[0m22:15:52.848056 [debug] [Thread-1 (]: Began executing node model.takehome_wh.stg_product__transactions
[0m22:15:52.854118 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome_wh.stg_product__transactions"
[0m22:15:52.856522 [debug] [Thread-1 (]: Using snowflake connection "model.takehome_wh.stg_product__transactions"
[0m22:15:52.857133 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1f72978-0285-4593-a7b6-cbd10b7881f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107062e30>]}
[0m22:15:52.857589 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.stg_product__transactions"} */
create or replace   view takehome_db.takehome_schema_staging.stg_product__transactions
  
   as (
    with
    transactions as (select * from read_replica.product.transactions),

    final as (
        select
            id as pk_transaction_id,
            device_id,
            product_name as transaction_product_name,
            product_sku as transaction_product_sku,
            amount as transaction_amount_eur,
            status as transaction_status,

            -- ideally, sensitive information such as credit card numbers
            -- and CVVs should not be stored in a data warehouse
            -- these sensitive information will not be included in downstream
            -- models in this project
            
            -- if an analysis requires these two fields, and product
            -- database remain unencrypted, perform tokenization

            created_at as transaction_created_at,
            happened_at as transaction_happened_at,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from transactions
    )

select *
from final
  );
[0m22:15:52.858269 [info ] [Thread-2 (]: 2 of 12 OK created sql view model takehome_schema_staging.stg_product__stores .. [[32mSUCCESS 1[0m in 0.88s]
[0m22:15:52.858685 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:15:52.859268 [debug] [Thread-2 (]: Finished running node model.takehome_wh.stg_product__stores
[0m22:15:52.861780 [debug] [Thread-2 (]: Began running node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m22:15:52.862338 [info ] [Thread-2 (]: 4 of 12 START test not_null_stg_product__devices_pk_device_id .................. [RUN]
[0m22:15:52.862746 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome_wh.stg_product__stores, now test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941)
[0m22:15:52.863060 [debug] [Thread-2 (]: Began compiling node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m22:15:52.878441 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"
[0m22:15:52.879571 [debug] [Thread-2 (]: Began executing node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m22:15:52.891578 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"
[0m22:15:52.892652 [debug] [Thread-2 (]: Using snowflake connection "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"
[0m22:15:52.893720 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pk_device_id
from takehome_db.takehome_schema_staging.stg_product__devices
where pk_device_id is null



      
    ) dbt_internal_test
[0m22:15:52.894031 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:15:53.366426 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.472 seconds
[0m22:15:53.377141 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941: Close
[0m22:15:53.479939 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.621 seconds
[0m22:15:53.483869 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__transactions: Close
[0m22:15:53.530733 [info ] [Thread-2 (]: 4 of 12 PASS not_null_stg_product__devices_pk_device_id ........................ [[32mPASS[0m in 0.67s]
[0m22:15:53.531982 [debug] [Thread-2 (]: Finished running node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m22:15:53.532634 [debug] [Thread-2 (]: Began running node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m22:15:53.533329 [info ] [Thread-2 (]: 5 of 12 START test unique_stg_product__devices_pk_device_id .................... [RUN]
[0m22:15:53.534055 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941, now test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505)
[0m22:15:53.535512 [debug] [Thread-2 (]: Began compiling node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m22:15:53.547672 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"
[0m22:15:53.548835 [debug] [Thread-2 (]: Began executing node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m22:15:53.554928 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"
[0m22:15:53.556140 [debug] [Thread-2 (]: Using snowflake connection "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"
[0m22:15:53.556555 [debug] [Thread-2 (]: On test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    pk_device_id as unique_field,
    count(*) as n_records

from takehome_db.takehome_schema_staging.stg_product__devices
where pk_device_id is not null
group by pk_device_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:15:53.557034 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:15:53.647514 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1f72978-0285-4593-a7b6-cbd10b7881f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aa2650>]}
[0m22:15:53.648430 [info ] [Thread-1 (]: 3 of 12 OK created sql view model takehome_schema_staging.stg_product__transactions  [[32mSUCCESS 1[0m in 0.81s]
[0m22:15:53.649417 [debug] [Thread-1 (]: Finished running node model.takehome_wh.stg_product__transactions
[0m22:15:53.650875 [debug] [Thread-1 (]: Began running node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m22:15:53.652631 [info ] [Thread-1 (]: 6 of 12 START test not_null_stg_product__stores_pk_store_id .................... [RUN]
[0m22:15:53.654153 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.takehome_wh.stg_product__transactions, now test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696)
[0m22:15:53.654608 [debug] [Thread-1 (]: Began compiling node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m22:15:53.730339 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"
[0m22:15:53.731614 [debug] [Thread-1 (]: Began executing node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m22:15:53.733975 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"
[0m22:15:53.735361 [debug] [Thread-1 (]: Using snowflake connection "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"
[0m22:15:53.735677 [debug] [Thread-1 (]: On test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pk_store_id
from takehome_db.takehome_schema_staging.stg_product__stores
where pk_store_id is null



      
    ) dbt_internal_test
[0m22:15:53.736015 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:15:54.208732 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.652 seconds
[0m22:15:54.247020 [debug] [Thread-2 (]: On test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505: Close
[0m22:15:54.307156 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.571 seconds
[0m22:15:54.312491 [debug] [Thread-1 (]: On test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696: Close
[0m22:15:54.420186 [info ] [Thread-2 (]: 5 of 12 PASS unique_stg_product__devices_pk_device_id .......................... [[32mPASS[0m in 0.89s]
[0m22:15:54.420924 [debug] [Thread-2 (]: Finished running node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m22:15:54.421273 [debug] [Thread-2 (]: Began running node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m22:15:54.421894 [info ] [Thread-2 (]: 7 of 12 START test unique_stg_product__stores_pk_store_id ...................... [RUN]
[0m22:15:54.422377 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505, now test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e)
[0m22:15:54.422677 [debug] [Thread-2 (]: Began compiling node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m22:15:54.428906 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"
[0m22:15:54.429759 [debug] [Thread-2 (]: Began executing node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m22:15:54.432395 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"
[0m22:15:54.433422 [debug] [Thread-2 (]: Using snowflake connection "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"
[0m22:15:54.433754 [debug] [Thread-2 (]: On test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    pk_store_id as unique_field,
    count(*) as n_records

from takehome_db.takehome_schema_staging.stg_product__stores
where pk_store_id is not null
group by pk_store_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:15:54.434302 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:15:54.467672 [info ] [Thread-1 (]: 6 of 12 PASS not_null_stg_product__stores_pk_store_id .......................... [[32mPASS[0m in 0.81s]
[0m22:15:54.470371 [debug] [Thread-1 (]: Finished running node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m22:15:54.470761 [debug] [Thread-1 (]: Began running node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m22:15:54.471116 [info ] [Thread-1 (]: 8 of 12 START test not_null_stg_product__transactions_pk_transaction_id ........ [RUN]
[0m22:15:54.471540 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696, now test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc)
[0m22:15:54.471866 [debug] [Thread-1 (]: Began compiling node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m22:15:54.478045 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"
[0m22:15:54.479201 [debug] [Thread-1 (]: Began executing node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m22:15:54.482282 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"
[0m22:15:54.483370 [debug] [Thread-1 (]: Using snowflake connection "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"
[0m22:15:54.483696 [debug] [Thread-1 (]: On test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pk_transaction_id
from takehome_db.takehome_schema_staging.stg_product__transactions
where pk_transaction_id is null



      
    ) dbt_internal_test
[0m22:15:54.484199 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:15:54.982897 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.548 seconds
[0m22:15:54.990505 [debug] [Thread-2 (]: On test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e: Close
[0m22:15:55.047397 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.563 seconds
[0m22:15:55.051938 [debug] [Thread-1 (]: On test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc: Close
[0m22:15:55.175587 [info ] [Thread-2 (]: 7 of 12 PASS unique_stg_product__stores_pk_store_id ............................ [[32mPASS[0m in 0.75s]
[0m22:15:55.183001 [debug] [Thread-2 (]: Finished running node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m22:15:55.184024 [debug] [Thread-2 (]: Began running node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m22:15:55.188401 [info ] [Thread-2 (]: 9 of 12 START test unique_stg_product__transactions_pk_transaction_id .......... [RUN]
[0m22:15:55.190722 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e, now test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df)
[0m22:15:55.191353 [debug] [Thread-2 (]: Began compiling node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m22:15:55.206513 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"
[0m22:15:55.207641 [debug] [Thread-2 (]: Began executing node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m22:15:55.223112 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"
[0m22:15:55.224593 [debug] [Thread-2 (]: Using snowflake connection "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"
[0m22:15:55.225889 [debug] [Thread-2 (]: On test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    pk_transaction_id as unique_field,
    count(*) as n_records

from takehome_db.takehome_schema_staging.stg_product__transactions
where pk_transaction_id is not null
group by pk_transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:15:55.230887 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:15:55.249939 [info ] [Thread-1 (]: 8 of 12 PASS not_null_stg_product__transactions_pk_transaction_id .............. [[32mPASS[0m in 0.78s]
[0m22:15:55.255466 [debug] [Thread-1 (]: Finished running node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m22:15:55.255938 [debug] [Thread-1 (]: Began running node model.takehome_wh.dim_devices
[0m22:15:55.256491 [info ] [Thread-1 (]: 10 of 12 START sql table model takehome_schema_mart.dim_devices ................ [RUN]
[0m22:15:55.257211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc, now model.takehome_wh.dim_devices)
[0m22:15:55.258211 [debug] [Thread-1 (]: Began compiling node model.takehome_wh.dim_devices
[0m22:15:55.273993 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome_wh.dim_devices"
[0m22:15:55.275317 [debug] [Thread-1 (]: Began executing node model.takehome_wh.dim_devices
[0m22:15:55.296732 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome_wh.dim_devices"
[0m22:15:55.299672 [debug] [Thread-1 (]: Using snowflake connection "model.takehome_wh.dim_devices"
[0m22:15:55.300021 [debug] [Thread-1 (]: On model.takehome_wh.dim_devices: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.dim_devices"} */
create or replace transient table takehome_db.takehome_schema_mart.dim_devices
         as
        (with
    -- import CTEs

    stores as (select * from takehome_db.takehome_schema_staging.stg_product__stores),

    devices as (select * from takehome_db.takehome_schema_staging.stg_product__devices),

    -- logical CTEs
    final as (
        select
            devices.pk_device_id,
            devices.device_type,
            devices.store_id,
            stores.store_name,
            stores.store_address,
            stores.store_city,
            stores.store_country,
            stores.store_device_typology,
            stores.store_created_at,
            stores.customer_id,
            
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from devices
        left join stores on devices.store_id = stores.pk_store_id
    )

select *
from final
        );
[0m22:15:55.300262 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:15:55.755127 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.525 seconds
[0m22:15:55.757893 [debug] [Thread-2 (]: On test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df: Close
[0m22:15:55.925141 [info ] [Thread-2 (]: 9 of 12 PASS unique_stg_product__transactions_pk_transaction_id ................ [[32mPASS[0m in 0.73s]
[0m22:15:55.927325 [debug] [Thread-2 (]: Finished running node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m22:15:55.928875 [debug] [Thread-2 (]: Began running node model.takehome_wh.fct_transactions
[0m22:15:55.929657 [info ] [Thread-2 (]: 11 of 12 START sql table model takehome_schema_mart.fct_transactions ........... [RUN]
[0m22:15:55.930369 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df, now model.takehome_wh.fct_transactions)
[0m22:15:55.930870 [debug] [Thread-2 (]: Began compiling node model.takehome_wh.fct_transactions
[0m22:15:55.937833 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome_wh.fct_transactions"
[0m22:15:55.938801 [debug] [Thread-2 (]: Began executing node model.takehome_wh.fct_transactions
[0m22:15:55.942388 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome_wh.fct_transactions"
[0m22:15:55.945383 [debug] [Thread-2 (]: Using snowflake connection "model.takehome_wh.fct_transactions"
[0m22:15:55.945881 [debug] [Thread-2 (]: On model.takehome_wh.fct_transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.fct_transactions"} */
create or replace transient table takehome_db.takehome_schema_mart.fct_transactions
         as
        (with
    -- import CTEs
    transactions as (select * from takehome_db.takehome_schema_staging.stg_product__transactions),

    stores as (select * from takehome_db.takehome_schema_staging.stg_product__stores),

    devices as (select * from takehome_db.takehome_schema_staging.stg_product__devices),

    -- logical CTEs
    final as (
        select
            transactions.pk_transaction_id,
            transaction_happened_at,
            transaction_status,
            transaction_product_name,
            transaction_product_sku,
            transaction_amount_eur,

            device_id,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from transactions
        left join devices on transactions.device_id = devices.pk_device_id
    )

select *
from final
        );
[0m22:15:55.946254 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:15:56.233218 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.933 seconds
[0m22:15:56.246719 [debug] [Thread-1 (]: On model.takehome_wh.dim_devices: Close
[0m22:15:56.418662 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1f72978-0285-4593-a7b6-cbd10b7881f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084bb580>]}
[0m22:15:56.420635 [info ] [Thread-1 (]: 10 of 12 OK created sql table model takehome_schema_mart.dim_devices ........... [[32mSUCCESS 1[0m in 1.16s]
[0m22:15:56.421827 [debug] [Thread-1 (]: Finished running node model.takehome_wh.dim_devices
[0m22:15:57.125355 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.179 seconds
[0m22:15:57.132598 [debug] [Thread-2 (]: On model.takehome_wh.fct_transactions: Close
[0m22:15:57.326055 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1f72978-0285-4593-a7b6-cbd10b7881f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107afad10>]}
[0m22:15:57.328180 [info ] [Thread-2 (]: 11 of 12 OK created sql table model takehome_schema_mart.fct_transactions ...... [[32mSUCCESS 1[0m in 1.40s]
[0m22:15:57.329318 [debug] [Thread-2 (]: Finished running node model.takehome_wh.fct_transactions
[0m22:15:57.359641 [debug] [Thread-1 (]: Began running node model.takehome_wh.rpt_device_performance
[0m22:15:57.362794 [info ] [Thread-1 (]: 12 of 12 START sql table model takehome_schema_reporting.rpt_device_performance  [RUN]
[0m22:15:57.368436 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.takehome_wh.dim_devices, now model.takehome_wh.rpt_device_performance)
[0m22:15:57.371014 [debug] [Thread-1 (]: Began compiling node model.takehome_wh.rpt_device_performance
[0m22:15:57.394370 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome_wh.rpt_device_performance"
[0m22:15:57.402796 [debug] [Thread-1 (]: Began executing node model.takehome_wh.rpt_device_performance
[0m22:15:57.417676 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome_wh.rpt_device_performance"
[0m22:15:57.425896 [debug] [Thread-1 (]: Using snowflake connection "model.takehome_wh.rpt_device_performance"
[0m22:15:57.428153 [debug] [Thread-1 (]: On model.takehome_wh.rpt_device_performance: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.rpt_device_performance"} */
create or replace transient table takehome_db.takehome_schema_reporting.rpt_device_performance
         as
        (with
    -- import CTEs
    transactions as (select * from takehome_db.takehome_schema_mart.fct_transactions),

    devices as (select * from takehome_db.takehome_schema_mart.dim_devices),

    -- logical CTEs
    final as (
        select
            devices.* exclude dbt_updated_at,
            transactions.* exclude dbt_updated_at,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from devices
        left join transactions on devices.pk_device_id = transactions.device_id
    )

select *
from final
        );
[0m22:15:57.429684 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:15:58.425908 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.996 seconds
[0m22:15:58.432118 [debug] [Thread-1 (]: On model.takehome_wh.rpt_device_performance: Close
[0m22:15:58.608075 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1f72978-0285-4593-a7b6-cbd10b7881f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10727bd90>]}
[0m22:15:58.609647 [info ] [Thread-1 (]: 12 of 12 OK created sql table model takehome_schema_reporting.rpt_device_performance  [[32mSUCCESS 1[0m in 1.24s]
[0m22:15:58.610901 [debug] [Thread-1 (]: Finished running node model.takehome_wh.rpt_device_performance
[0m22:15:58.612288 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:15:58.612622 [debug] [MainThread]: Connection 'model.takehome_wh.rpt_device_performance' was properly closed.
[0m22:15:58.613070 [debug] [MainThread]: Connection 'model.takehome_wh.fct_transactions' was properly closed.
[0m22:15:58.614533 [info ] [MainThread]: 
[0m22:15:58.616736 [info ] [MainThread]: Finished running 3 view models, 6 data tests, 3 table models in 0 hours 0 minutes and 11.01 seconds (11.01s).
[0m22:15:58.619972 [debug] [MainThread]: Command end result
[0m22:15:58.674330 [info ] [MainThread]: 
[0m22:15:58.675079 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:15:58.675332 [info ] [MainThread]: 
[0m22:15:58.675569 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m22:15:58.677257 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 12.887747, "process_user_time": 3.666607, "process_kernel_time": 0.465053, "process_mem_max_rss": "142376960", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:15:58.677699 [debug] [MainThread]: Command `dbt build` succeeded at 22:15:58.677636 after 12.89 seconds
[0m22:15:58.677991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a97cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10584fb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10748ae90>]}
[0m22:15:58.678243 [debug] [MainThread]: Flushing usage events
[0m22:31:32.242476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10897bc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5913f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b591ab0>]}


============================== 22:31:32.245717 | 83fe464a-07f3-4d6e-920d-5415b87f487d ==============================
[0m22:31:32.245717 [info ] [MainThread]: Running with dbt=1.8.8
[0m22:31:32.246057 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/cedric.conol/Documents/takehome/', 'log_path': '/Users/cedric.conol/Documents/takehome/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt build', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'target', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:31:32.482595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83fe464a-07f3-4d6e-920d-5415b87f487d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2aa890>]}
[0m22:31:32.509568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83fe464a-07f3-4d6e-920d-5415b87f487d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b42a920>]}
[0m22:31:32.510190 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:31:32.523931 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m22:31:32.628366 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:31:32.628861 [debug] [MainThread]: Partial parsing: updated file: takehome_wh://models/reporting/rpt_device_performance.sql
[0m22:31:32.784252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83fe464a-07f3-4d6e-920d-5415b87f487d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca96290>]}
[0m22:31:32.880784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83fe464a-07f3-4d6e-920d-5415b87f487d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9dcf70>]}
[0m22:31:32.881218 [info ] [MainThread]: Found 6 models, 6 data tests, 3 sources, 570 macros
[0m22:31:32.882585 [info ] [MainThread]: 
[0m22:31:32.882924 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:31:32.885648 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_takehome_db'
[0m22:31:32.885953 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_takehome_db'
[0m22:31:32.894935 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db"
[0m22:31:32.896394 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db"
[0m22:31:32.896639 [debug] [ThreadPool]: On list_takehome_db: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db"} */
show terse schemas in database takehome_db
    limit 10000
[0m22:31:32.896839 [debug] [ThreadPool]: On list_takehome_db: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db"} */
show terse schemas in database takehome_db
    limit 10000
[0m22:31:32.897034 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:31:32.897214 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:31:33.596854 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.700 seconds
[0m22:31:33.601364 [debug] [ThreadPool]: On list_takehome_db: Close
[0m22:31:33.607354 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.710 seconds
[0m22:31:33.610816 [debug] [ThreadPool]: On list_takehome_db: Close
[0m22:31:33.767793 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db"
[0m22:31:33.768651 [debug] [ThreadPool]: On list_takehome_db: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db"} */
show terse schemas in database takehome_db
    limit 10000
[0m22:31:33.769167 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:31:34.419419 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.650 seconds
[0m22:31:34.420994 [debug] [ThreadPool]: On list_takehome_db: Close
[0m22:31:34.580955 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome_db, now list_takehome_db_takehome_schema_staging)
[0m22:31:34.582249 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome_db, now list_takehome_db_takehome_schema_reporting)
[0m22:31:34.598124 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db_takehome_schema_staging"
[0m22:31:34.598772 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db_takehome_schema_reporting"
[0m22:31:34.599132 [debug] [ThreadPool]: On list_takehome_db_takehome_schema_staging: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db_takehome_schema_staging"} */
show objects in takehome_db.takehome_schema_staging limit 10000
[0m22:31:34.599416 [debug] [ThreadPool]: On list_takehome_db_takehome_schema_reporting: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db_takehome_schema_reporting"} */
show objects in takehome_db.takehome_schema_reporting limit 10000
[0m22:31:34.599980 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:31:34.600471 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:31:35.059283 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.459 seconds
[0m22:31:35.064250 [debug] [ThreadPool]: On list_takehome_db_takehome_schema_staging: Close
[0m22:31:35.066635 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.466 seconds
[0m22:31:35.071990 [debug] [ThreadPool]: On list_takehome_db_takehome_schema_reporting: Close
[0m22:31:35.234734 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome_db_takehome_schema_staging, now list_takehome_db_takehome_schema_mart)
[0m22:31:35.243385 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db_takehome_schema_mart"
[0m22:31:35.245263 [debug] [ThreadPool]: On list_takehome_db_takehome_schema_mart: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db_takehome_schema_mart"} */
show objects in takehome_db.takehome_schema_mart limit 10000
[0m22:31:35.246287 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:31:35.769450 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.523 seconds
[0m22:31:35.774958 [debug] [ThreadPool]: On list_takehome_db_takehome_schema_mart: Close
[0m22:31:35.979941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83fe464a-07f3-4d6e-920d-5415b87f487d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c925270>]}
[0m22:31:35.982383 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m22:31:35.984045 [info ] [MainThread]: 
[0m22:31:35.988802 [debug] [Thread-1 (]: Began running node model.takehome_wh.stg_product__devices
[0m22:31:35.989349 [debug] [Thread-2 (]: Began running node model.takehome_wh.stg_product__stores
[0m22:31:35.991325 [info ] [Thread-1 (]: 1 of 12 START sql view model takehome_schema_staging.stg_product__devices ...... [RUN]
[0m22:31:35.992536 [info ] [Thread-2 (]: 2 of 12 START sql view model takehome_schema_staging.stg_product__stores ....... [RUN]
[0m22:31:35.993233 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_takehome_db_takehome_schema_mart, now model.takehome_wh.stg_product__devices)
[0m22:31:35.993562 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_takehome_db_takehome_schema_reporting, now model.takehome_wh.stg_product__stores)
[0m22:31:35.993867 [debug] [Thread-1 (]: Began compiling node model.takehome_wh.stg_product__devices
[0m22:31:35.994129 [debug] [Thread-2 (]: Began compiling node model.takehome_wh.stg_product__stores
[0m22:31:36.016416 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome_wh.stg_product__devices"
[0m22:31:36.017429 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome_wh.stg_product__stores"
[0m22:31:36.019811 [debug] [Thread-1 (]: Began executing node model.takehome_wh.stg_product__devices
[0m22:31:36.020252 [debug] [Thread-2 (]: Began executing node model.takehome_wh.stg_product__stores
[0m22:31:36.045304 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome_wh.stg_product__devices"
[0m22:31:36.048047 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome_wh.stg_product__stores"
[0m22:31:36.050821 [debug] [Thread-2 (]: Using snowflake connection "model.takehome_wh.stg_product__stores"
[0m22:31:36.051680 [debug] [Thread-1 (]: Using snowflake connection "model.takehome_wh.stg_product__devices"
[0m22:31:36.052021 [debug] [Thread-2 (]: On model.takehome_wh.stg_product__stores: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.stg_product__stores"} */
create or replace   view takehome_db.takehome_schema_staging.stg_product__stores
  
   as (
    with
    stores as (select * from read_replica.product.store),

    final as (
        select
            id as pk_store_id,
            name as store_name,
            address as store_address,
            city as store_city,
            country as store_country,
            typology as store_device_typology,
            customer_id,

            created_at as store_created_at,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from
            stores
    )

select *
from final
  );
[0m22:31:36.052305 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__devices: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.stg_product__devices"} */
create or replace   view takehome_db.takehome_schema_staging.stg_product__devices
  
   as (
    with
    devices as (select * from read_replica.product.device),

    final as (
        select
            id as pk_device_id,
            type as device_type,
            store_id,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from
            devices
    )

select *
from final
  );
[0m22:31:36.052557 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:31:36.052787 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:36.633195 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.580 seconds
[0m22:31:36.667905 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__devices: Close
[0m22:31:36.687613 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.635 seconds
[0m22:31:36.690794 [debug] [Thread-2 (]: On model.takehome_wh.stg_product__stores: Close
[0m22:31:36.845706 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83fe464a-07f3-4d6e-920d-5415b87f487d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1df640>]}
[0m22:31:36.847559 [info ] [Thread-1 (]: 1 of 12 OK created sql view model takehome_schema_staging.stg_product__devices . [[32mSUCCESS 1[0m in 0.85s]
[0m22:31:36.849372 [debug] [Thread-1 (]: Finished running node model.takehome_wh.stg_product__devices
[0m22:31:36.850553 [debug] [Thread-1 (]: Began running node model.takehome_wh.stg_product__transactions
[0m22:31:36.851741 [info ] [Thread-1 (]: 3 of 12 START sql view model takehome_schema_staging.stg_product__transactions . [RUN]
[0m22:31:36.852682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.takehome_wh.stg_product__devices, now model.takehome_wh.stg_product__transactions)
[0m22:31:36.853303 [debug] [Thread-1 (]: Began compiling node model.takehome_wh.stg_product__transactions
[0m22:31:36.861179 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome_wh.stg_product__transactions"
[0m22:31:36.864677 [debug] [Thread-1 (]: Began executing node model.takehome_wh.stg_product__transactions
[0m22:31:36.866872 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83fe464a-07f3-4d6e-920d-5415b87f487d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ddcd2d0>]}
[0m22:31:36.871172 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome_wh.stg_product__transactions"
[0m22:31:36.871873 [info ] [Thread-2 (]: 2 of 12 OK created sql view model takehome_schema_staging.stg_product__stores .. [[32mSUCCESS 1[0m in 0.87s]
[0m22:31:36.872600 [debug] [Thread-2 (]: Finished running node model.takehome_wh.stg_product__stores
[0m22:31:36.873053 [debug] [Thread-2 (]: Began running node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m22:31:36.875918 [debug] [Thread-1 (]: Using snowflake connection "model.takehome_wh.stg_product__transactions"
[0m22:31:36.874832 [info ] [Thread-2 (]: 4 of 12 START test not_null_stg_product__devices_pk_device_id .................. [RUN]
[0m22:31:36.876415 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.stg_product__transactions"} */
create or replace   view takehome_db.takehome_schema_staging.stg_product__transactions
  
   as (
    with
    transactions as (select * from read_replica.product.transactions),

    final as (
        select
            id as pk_transaction_id,
            device_id,
            product_name as transaction_product_name,
            product_sku as transaction_product_sku,
            amount as transaction_amount_eur,
            status as transaction_status,

            -- ideally, sensitive information such as credit card numbers
            -- and CVVs should not be stored in a data warehouse
            -- these sensitive information will not be included in downstream
            -- models in this project
            
            -- if an analysis requires these two fields, and product
            -- database remain unencrypted, perform tokenization

            created_at as transaction_created_at,
            happened_at as transaction_happened_at,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from transactions
    )

select *
from final
  );
[0m22:31:36.876800 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome_wh.stg_product__stores, now test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941)
[0m22:31:36.877056 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:36.877305 [debug] [Thread-2 (]: Began compiling node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m22:31:36.890188 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"
[0m22:31:36.891597 [debug] [Thread-2 (]: Began executing node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m22:31:36.904809 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"
[0m22:31:36.906176 [debug] [Thread-2 (]: Using snowflake connection "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"
[0m22:31:36.906482 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pk_device_id
from takehome_db.takehome_schema_staging.stg_product__devices
where pk_device_id is null



      
    ) dbt_internal_test
[0m22:31:36.907703 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:31:37.464623 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.556 seconds
[0m22:31:37.473234 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941: Close
[0m22:31:37.477551 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.600 seconds
[0m22:31:37.483036 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__transactions: Close
[0m22:31:37.636903 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83fe464a-07f3-4d6e-920d-5415b87f487d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c80820>]}
[0m22:31:37.638556 [info ] [Thread-1 (]: 3 of 12 OK created sql view model takehome_schema_staging.stg_product__transactions  [[32mSUCCESS 1[0m in 0.78s]
[0m22:31:37.639738 [debug] [Thread-1 (]: Finished running node model.takehome_wh.stg_product__transactions
[0m22:31:37.641773 [debug] [Thread-1 (]: Began running node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m22:31:37.643237 [info ] [Thread-1 (]: 5 of 12 START test unique_stg_product__devices_pk_device_id .................... [RUN]
[0m22:31:37.644167 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.takehome_wh.stg_product__transactions, now test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505)
[0m22:31:37.645009 [debug] [Thread-1 (]: Began compiling node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m22:31:37.659321 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"
[0m22:31:37.660941 [debug] [Thread-1 (]: Began executing node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m22:31:37.664473 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"
[0m22:31:37.666970 [info ] [Thread-2 (]: 4 of 12 PASS not_null_stg_product__devices_pk_device_id ........................ [[32mPASS[0m in 0.79s]
[0m22:31:37.668002 [debug] [Thread-2 (]: Finished running node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m22:31:37.668520 [debug] [Thread-2 (]: Began running node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m22:31:37.669005 [info ] [Thread-2 (]: 6 of 12 START test not_null_stg_product__stores_pk_store_id .................... [RUN]
[0m22:31:37.669717 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941, now test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696)
[0m22:31:37.670561 [debug] [Thread-1 (]: Using snowflake connection "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"
[0m22:31:37.670948 [debug] [Thread-2 (]: Began compiling node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m22:31:37.671364 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    pk_device_id as unique_field,
    count(*) as n_records

from takehome_db.takehome_schema_staging.stg_product__devices
where pk_device_id is not null
group by pk_device_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:31:37.677453 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"
[0m22:31:37.677971 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:37.680107 [debug] [Thread-2 (]: Began executing node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m22:31:37.684363 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"
[0m22:31:37.685940 [debug] [Thread-2 (]: Using snowflake connection "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"
[0m22:31:37.686293 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pk_store_id
from takehome_db.takehome_schema_staging.stg_product__stores
where pk_store_id is null



      
    ) dbt_internal_test
[0m22:31:37.686572 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:31:38.218709 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.532 seconds
[0m22:31:38.222870 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696: Close
[0m22:31:38.231244 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.553 seconds
[0m22:31:38.236535 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505: Close
[0m22:31:38.387015 [info ] [Thread-1 (]: 5 of 12 PASS unique_stg_product__devices_pk_device_id .......................... [[32mPASS[0m in 0.74s]
[0m22:31:38.388704 [debug] [Thread-1 (]: Finished running node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m22:31:38.391172 [debug] [Thread-1 (]: Began running node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m22:31:38.392882 [info ] [Thread-1 (]: 7 of 12 START test unique_stg_product__stores_pk_store_id ...................... [RUN]
[0m22:31:38.393993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505, now test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e)
[0m22:31:38.395117 [debug] [Thread-1 (]: Began compiling node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m22:31:38.396368 [info ] [Thread-2 (]: 6 of 12 PASS not_null_stg_product__stores_pk_store_id .......................... [[32mPASS[0m in 0.73s]
[0m22:31:38.408018 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"
[0m22:31:38.410233 [debug] [Thread-2 (]: Finished running node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m22:31:38.411119 [debug] [Thread-2 (]: Began running node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m22:31:38.411756 [info ] [Thread-2 (]: 8 of 12 START test not_null_stg_product__transactions_pk_transaction_id ........ [RUN]
[0m22:31:38.412473 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696, now test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc)
[0m22:31:38.412912 [debug] [Thread-1 (]: Began executing node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m22:31:38.413337 [debug] [Thread-2 (]: Began compiling node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m22:31:38.418166 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"
[0m22:31:38.422723 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"
[0m22:31:38.425254 [debug] [Thread-1 (]: Using snowflake connection "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"
[0m22:31:38.426093 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    pk_store_id as unique_field,
    count(*) as n_records

from takehome_db.takehome_schema_staging.stg_product__stores
where pk_store_id is not null
group by pk_store_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:31:38.426488 [debug] [Thread-2 (]: Began executing node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m22:31:38.426893 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:38.429872 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"
[0m22:31:38.433992 [debug] [Thread-2 (]: Using snowflake connection "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"
[0m22:31:38.434470 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pk_transaction_id
from takehome_db.takehome_schema_staging.stg_product__transactions
where pk_transaction_id is null



      
    ) dbt_internal_test
[0m22:31:38.434790 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:31:38.986748 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.551 seconds
[0m22:31:38.992590 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc: Close
[0m22:31:38.996168 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.569 seconds
[0m22:31:39.000531 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e: Close
[0m22:31:39.172076 [info ] [Thread-2 (]: 8 of 12 PASS not_null_stg_product__transactions_pk_transaction_id .............. [[32mPASS[0m in 0.76s]
[0m22:31:39.172605 [info ] [Thread-1 (]: 7 of 12 PASS unique_stg_product__stores_pk_store_id ............................ [[32mPASS[0m in 0.78s]
[0m22:31:39.174896 [debug] [Thread-2 (]: Finished running node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m22:31:39.176948 [debug] [Thread-1 (]: Finished running node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m22:31:39.177334 [debug] [Thread-2 (]: Began running node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m22:31:39.178144 [debug] [Thread-1 (]: Began running node model.takehome_wh.dim_devices
[0m22:31:39.177835 [info ] [Thread-2 (]: 9 of 12 START test unique_stg_product__transactions_pk_transaction_id .......... [RUN]
[0m22:31:39.178765 [info ] [Thread-1 (]: 10 of 12 START sql table model takehome_schema_mart.dim_devices ................ [RUN]
[0m22:31:39.179271 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc, now test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df)
[0m22:31:39.179638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e, now model.takehome_wh.dim_devices)
[0m22:31:39.179976 [debug] [Thread-2 (]: Began compiling node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m22:31:39.180492 [debug] [Thread-1 (]: Began compiling node model.takehome_wh.dim_devices
[0m22:31:39.194924 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"
[0m22:31:39.205338 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome_wh.dim_devices"
[0m22:31:39.209068 [debug] [Thread-1 (]: Began executing node model.takehome_wh.dim_devices
[0m22:31:39.209424 [debug] [Thread-2 (]: Began executing node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m22:31:39.235507 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"
[0m22:31:39.232761 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome_wh.dim_devices"
[0m22:31:39.236893 [debug] [Thread-2 (]: Using snowflake connection "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"
[0m22:31:39.237147 [debug] [Thread-2 (]: On test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    pk_transaction_id as unique_field,
    count(*) as n_records

from takehome_db.takehome_schema_staging.stg_product__transactions
where pk_transaction_id is not null
group by pk_transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:31:39.237848 [debug] [Thread-1 (]: Using snowflake connection "model.takehome_wh.dim_devices"
[0m22:31:39.238114 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:31:39.238379 [debug] [Thread-1 (]: On model.takehome_wh.dim_devices: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.dim_devices"} */
create or replace transient table takehome_db.takehome_schema_mart.dim_devices
         as
        (with
    -- import CTEs

    stores as (select * from takehome_db.takehome_schema_staging.stg_product__stores),

    devices as (select * from takehome_db.takehome_schema_staging.stg_product__devices),

    -- logical CTEs
    final as (
        select
            devices.pk_device_id,
            devices.device_type,
            devices.store_id,
            stores.store_name,
            stores.store_address,
            stores.store_city,
            stores.store_country,
            stores.store_device_typology,
            stores.store_created_at,
            stores.customer_id,
            
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from devices
        left join stores on devices.store_id = stores.pk_store_id
    )

select *
from final
        );
[0m22:31:39.242102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:39.694247 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.456 seconds
[0m22:31:39.697508 [debug] [Thread-2 (]: On test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df: Close
[0m22:31:39.845143 [info ] [Thread-2 (]: 9 of 12 PASS unique_stg_product__transactions_pk_transaction_id ................ [[32mPASS[0m in 0.67s]
[0m22:31:39.846057 [debug] [Thread-2 (]: Finished running node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m22:31:39.846688 [debug] [Thread-2 (]: Began running node model.takehome_wh.fct_transactions
[0m22:31:39.847189 [info ] [Thread-2 (]: 11 of 12 START sql table model takehome_schema_mart.fct_transactions ........... [RUN]
[0m22:31:39.847597 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df, now model.takehome_wh.fct_transactions)
[0m22:31:39.852731 [debug] [Thread-2 (]: Began compiling node model.takehome_wh.fct_transactions
[0m22:31:39.859633 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome_wh.fct_transactions"
[0m22:31:39.863992 [debug] [Thread-2 (]: Began executing node model.takehome_wh.fct_transactions
[0m22:31:39.869500 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome_wh.fct_transactions"
[0m22:31:39.871016 [debug] [Thread-2 (]: Using snowflake connection "model.takehome_wh.fct_transactions"
[0m22:31:39.871404 [debug] [Thread-2 (]: On model.takehome_wh.fct_transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.fct_transactions"} */
create or replace transient table takehome_db.takehome_schema_mart.fct_transactions
         as
        (with
    -- import CTEs
    transactions as (select * from takehome_db.takehome_schema_staging.stg_product__transactions),

    stores as (select * from takehome_db.takehome_schema_staging.stg_product__stores),

    devices as (select * from takehome_db.takehome_schema_staging.stg_product__devices),

    -- logical CTEs
    final as (
        select
            transactions.pk_transaction_id,
            transaction_happened_at,
            transaction_status,
            transaction_product_name,
            transaction_product_sku,
            transaction_amount_eur,

            device_id,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from transactions
        left join devices on transactions.device_id = devices.pk_device_id
    )

select *
from final
        );
[0m22:31:39.871713 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:31:40.769953 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.528 seconds
[0m22:31:40.771771 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.900 seconds
[0m22:31:40.779061 [debug] [Thread-1 (]: On model.takehome_wh.dim_devices: Close
[0m22:31:40.785236 [debug] [Thread-2 (]: On model.takehome_wh.fct_transactions: Close
[0m22:31:41.009707 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83fe464a-07f3-4d6e-920d-5415b87f487d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca81ea0>]}
[0m22:31:41.010281 [info ] [Thread-2 (]: 11 of 12 OK created sql table model takehome_schema_mart.fct_transactions ...... [[32mSUCCESS 1[0m in 1.16s]
[0m22:31:41.010661 [debug] [Thread-2 (]: Finished running node model.takehome_wh.fct_transactions
[0m22:31:41.034226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83fe464a-07f3-4d6e-920d-5415b87f487d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cad6470>]}
[0m22:31:41.034813 [info ] [Thread-1 (]: 10 of 12 OK created sql table model takehome_schema_mart.dim_devices ........... [[32mSUCCESS 1[0m in 1.85s]
[0m22:31:41.035187 [debug] [Thread-1 (]: Finished running node model.takehome_wh.dim_devices
[0m22:31:41.035813 [debug] [Thread-2 (]: Began running node model.takehome_wh.rpt_device_performance
[0m22:31:41.036215 [info ] [Thread-2 (]: 12 of 12 START sql table model takehome_schema_reporting.rpt_device_performance  [RUN]
[0m22:31:41.036553 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome_wh.fct_transactions, now model.takehome_wh.rpt_device_performance)
[0m22:31:41.036826 [debug] [Thread-2 (]: Began compiling node model.takehome_wh.rpt_device_performance
[0m22:31:41.039525 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome_wh.rpt_device_performance"
[0m22:31:41.040769 [debug] [Thread-2 (]: Began executing node model.takehome_wh.rpt_device_performance
[0m22:31:41.043158 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome_wh.rpt_device_performance"
[0m22:31:41.044098 [debug] [Thread-2 (]: Using snowflake connection "model.takehome_wh.rpt_device_performance"
[0m22:31:41.044354 [debug] [Thread-2 (]: On model.takehome_wh.rpt_device_performance: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.rpt_device_performance"} */
create or replace transient table takehome_db.takehome_schema_reporting.rpt_device_performance
         as
        (with
    -- import CTEs
    transactions as (select * from takehome_db.takehome_schema_mart.fct_transactions),

    devices as (select * from takehome_db.takehome_schema_mart.dim_devices),

    -- logical CTEs
    final as (
        select
            devices.* exclude dbt_updated_at,
            transactions.* exclude (dbt_updated_at, transaction_status),
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from devices
        left join transactions on devices.pk_device_id = transactions.device_id
        where transaction_status = 'accepted'
    )

select *
from final
        );
[0m22:31:41.044670 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:31:42.002678 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.958 seconds
[0m22:31:42.005057 [debug] [Thread-2 (]: On model.takehome_wh.rpt_device_performance: Close
[0m22:31:42.171221 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83fe464a-07f3-4d6e-920d-5415b87f487d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c50a7d0>]}
[0m22:31:42.171994 [info ] [Thread-2 (]: 12 of 12 OK created sql table model takehome_schema_reporting.rpt_device_performance  [[32mSUCCESS 1[0m in 1.13s]
[0m22:31:42.173064 [debug] [Thread-2 (]: Finished running node model.takehome_wh.rpt_device_performance
[0m22:31:42.177729 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:31:42.178041 [debug] [MainThread]: Connection 'model.takehome_wh.dim_devices' was properly closed.
[0m22:31:42.178244 [debug] [MainThread]: Connection 'model.takehome_wh.rpt_device_performance' was properly closed.
[0m22:31:42.178562 [info ] [MainThread]: 
[0m22:31:42.178838 [info ] [MainThread]: Finished running 3 view models, 6 data tests, 3 table models in 0 hours 0 minutes and 9.30 seconds (9.30s).
[0m22:31:42.180375 [debug] [MainThread]: Command end result
[0m22:31:42.230463 [info ] [MainThread]: 
[0m22:31:42.230839 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:31:42.231056 [info ] [MainThread]: 
[0m22:31:42.231273 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m22:31:42.234320 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 10.036078, "process_user_time": 2.552681, "process_kernel_time": 0.391033, "process_mem_max_rss": "139083776", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:31:42.234798 [debug] [MainThread]: Command `dbt build` succeeded at 22:31:42.234752 after 10.04 seconds
[0m22:31:42.235027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10897bc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8d7b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc51870>]}
[0m22:31:42.235230 [debug] [MainThread]: Flushing usage events
[0m22:43:19.324408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071c7d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b353f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b35ae0>]}


============================== 22:43:19.327684 | c101214e-050b-4e6e-9c76-c6d90a25c0a0 ==============================
[0m22:43:19.327684 [info ] [MainThread]: Running with dbt=1.8.8
[0m22:43:19.328036 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/cedric.conol/Documents/takehome/logs', 'profiles_dir': '/Users/cedric.conol/Documents/takehome/', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'target', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m22:43:19.560736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c101214e-050b-4e6e-9c76-c6d90a25c0a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097047f0>]}
[0m22:43:19.589571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c101214e-050b-4e6e-9c76-c6d90a25c0a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088047f0>]}
[0m22:43:19.590234 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:43:19.603993 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m22:43:19.704608 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m22:43:19.705219 [debug] [MainThread]: Partial parsing: updated file: takehome_wh://models/staging/_stg_product__models.yml
[0m22:43:19.705482 [debug] [MainThread]: Partial parsing: updated file: takehome_wh://models/mart/dim_devices.sql
[0m22:43:19.705690 [debug] [MainThread]: Partial parsing: updated file: takehome_wh://models/staging/stg_product__stores.sql
[0m22:43:19.931427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c101214e-050b-4e6e-9c76-c6d90a25c0a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109de92d0>]}
[0m22:43:20.003555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c101214e-050b-4e6e-9c76-c6d90a25c0a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109debbe0>]}
[0m22:43:20.004191 [info ] [MainThread]: Found 6 models, 6 data tests, 3 sources, 570 macros
[0m22:43:20.005912 [info ] [MainThread]: 
[0m22:43:20.006332 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:43:20.009004 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_takehome_db'
[0m22:43:20.009275 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_takehome_db'
[0m22:43:20.017319 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db"
[0m22:43:20.019128 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db"
[0m22:43:20.019379 [debug] [ThreadPool]: On list_takehome_db: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db"} */
show terse schemas in database takehome_db
    limit 10000
[0m22:43:20.019579 [debug] [ThreadPool]: On list_takehome_db: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db"} */
show terse schemas in database takehome_db
    limit 10000
[0m22:43:20.019765 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:43:20.019936 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:43:20.631155 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.611 seconds
[0m22:43:20.637658 [debug] [ThreadPool]: On list_takehome_db: Close
[0m22:43:20.642778 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.623 seconds
[0m22:43:20.645884 [debug] [ThreadPool]: On list_takehome_db: Close
[0m22:43:20.816353 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db"
[0m22:43:20.819125 [debug] [ThreadPool]: On list_takehome_db: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db"} */
show terse schemas in database takehome_db
    limit 10000
[0m22:43:20.819748 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:43:21.324561 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.505 seconds
[0m22:43:21.327011 [debug] [ThreadPool]: On list_takehome_db: Close
[0m22:43:21.496372 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome_db, now list_takehome_db_takehome_schema_mart)
[0m22:43:21.497018 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome_db, now list_takehome_db_takehome_schema_reporting)
[0m22:43:21.507219 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db_takehome_schema_mart"
[0m22:43:21.510658 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db_takehome_schema_reporting"
[0m22:43:21.511084 [debug] [ThreadPool]: On list_takehome_db_takehome_schema_mart: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db_takehome_schema_mart"} */
show objects in takehome_db.takehome_schema_mart limit 10000
[0m22:43:21.511376 [debug] [ThreadPool]: On list_takehome_db_takehome_schema_reporting: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db_takehome_schema_reporting"} */
show objects in takehome_db.takehome_schema_reporting limit 10000
[0m22:43:21.511647 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:43:21.511937 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:43:22.003509 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.490 seconds
[0m22:43:22.011278 [debug] [ThreadPool]: On list_takehome_db_takehome_schema_reporting: Close
[0m22:43:22.014151 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.502 seconds
[0m22:43:22.019299 [debug] [ThreadPool]: On list_takehome_db_takehome_schema_mart: Close
[0m22:43:22.191294 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome_db_takehome_schema_reporting, now list_takehome_db_takehome_schema_staging)
[0m22:43:22.199007 [debug] [ThreadPool]: Using snowflake connection "list_takehome_db_takehome_schema_staging"
[0m22:43:22.201494 [debug] [ThreadPool]: On list_takehome_db_takehome_schema_staging: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "connection_name": "list_takehome_db_takehome_schema_staging"} */
show objects in takehome_db.takehome_schema_staging limit 10000
[0m22:43:22.202747 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:43:22.683104 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.480 seconds
[0m22:43:22.687495 [debug] [ThreadPool]: On list_takehome_db_takehome_schema_staging: Close
[0m22:43:22.847301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c101214e-050b-4e6e-9c76-c6d90a25c0a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107003e20>]}
[0m22:43:22.848728 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m22:43:22.849558 [info ] [MainThread]: 
[0m22:43:22.854983 [debug] [Thread-1 (]: Began running node model.takehome_wh.stg_product__devices
[0m22:43:22.855991 [debug] [Thread-2 (]: Began running node model.takehome_wh.stg_product__stores
[0m22:43:22.857231 [info ] [Thread-1 (]: 1 of 12 START sql view model takehome_schema_staging.stg_product__devices ...... [RUN]
[0m22:43:22.862037 [info ] [Thread-2 (]: 2 of 12 START sql view model takehome_schema_staging.stg_product__stores ....... [RUN]
[0m22:43:22.862803 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_takehome_db_takehome_schema_mart, now model.takehome_wh.stg_product__devices)
[0m22:43:22.863279 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_takehome_db_takehome_schema_staging, now model.takehome_wh.stg_product__stores)
[0m22:43:22.863728 [debug] [Thread-1 (]: Began compiling node model.takehome_wh.stg_product__devices
[0m22:43:22.864127 [debug] [Thread-2 (]: Began compiling node model.takehome_wh.stg_product__stores
[0m22:43:22.876688 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome_wh.stg_product__devices"
[0m22:43:22.880975 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome_wh.stg_product__stores"
[0m22:43:22.882235 [debug] [Thread-1 (]: Began executing node model.takehome_wh.stg_product__devices
[0m22:43:22.882563 [debug] [Thread-2 (]: Began executing node model.takehome_wh.stg_product__stores
[0m22:43:22.904352 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome_wh.stg_product__devices"
[0m22:43:22.907774 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome_wh.stg_product__stores"
[0m22:43:22.908924 [debug] [Thread-1 (]: Using snowflake connection "model.takehome_wh.stg_product__devices"
[0m22:43:22.909608 [debug] [Thread-2 (]: Using snowflake connection "model.takehome_wh.stg_product__stores"
[0m22:43:22.909916 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__devices: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.stg_product__devices"} */
create or replace   view takehome_db.takehome_schema_staging.stg_product__devices
  
   as (
    with
    devices as (select * from read_replica.product.device),

    final as (
        select
            id as pk_device_id,
            type as device_type,
            store_id,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from
            devices
    )

select *
from final
  );
[0m22:43:22.910217 [debug] [Thread-2 (]: On model.takehome_wh.stg_product__stores: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.stg_product__stores"} */
create or replace   view takehome_db.takehome_schema_staging.stg_product__stores
  
   as (
    with
    stores as (select * from read_replica.product.store),

    final as (
        select
            id as pk_store_id,
            name as store_name,
            address as store_address,
            city as store_city,
            country as store_country,
            typology as store_typology,
            customer_id,

            created_at as store_created_at,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from
            stores
    )

select *
from final
  );
[0m22:43:22.910503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:22.910760 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:43:23.578250 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.667 seconds
[0m22:43:23.615949 [debug] [Thread-2 (]: On model.takehome_wh.stg_product__stores: Close
[0m22:43:23.619230 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.709 seconds
[0m22:43:23.621967 [debug] [Thread-1 (]: On model.takehome_wh.stg_product__devices: Close
[0m22:43:23.774483 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c101214e-050b-4e6e-9c76-c6d90a25c0a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e51c90>]}
[0m22:43:23.778399 [info ] [Thread-2 (]: 2 of 12 OK created sql view model takehome_schema_staging.stg_product__stores .. [[32mSUCCESS 1[0m in 0.91s]
[0m22:43:23.779888 [debug] [Thread-2 (]: Finished running node model.takehome_wh.stg_product__stores
[0m22:43:23.780785 [debug] [Thread-2 (]: Began running node model.takehome_wh.stg_product__transactions
[0m22:43:23.781976 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c101214e-050b-4e6e-9c76-c6d90a25c0a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad09330>]}
[0m22:43:23.783313 [info ] [Thread-2 (]: 3 of 12 START sql view model takehome_schema_staging.stg_product__transactions . [RUN]
[0m22:43:23.785376 [info ] [Thread-1 (]: 1 of 12 OK created sql view model takehome_schema_staging.stg_product__devices . [[32mSUCCESS 1[0m in 0.92s]
[0m22:43:23.786087 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome_wh.stg_product__stores, now model.takehome_wh.stg_product__transactions)
[0m22:43:23.786754 [debug] [Thread-1 (]: Finished running node model.takehome_wh.stg_product__devices
[0m22:43:23.787189 [debug] [Thread-2 (]: Began compiling node model.takehome_wh.stg_product__transactions
[0m22:43:23.787681 [debug] [Thread-1 (]: Began running node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m22:43:23.794982 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome_wh.stg_product__transactions"
[0m22:43:23.795723 [info ] [Thread-1 (]: 4 of 12 START test not_null_stg_product__stores_pk_store_id .................... [RUN]
[0m22:43:23.796433 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.takehome_wh.stg_product__devices, now test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696)
[0m22:43:23.797376 [debug] [Thread-1 (]: Began compiling node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m22:43:23.810921 [debug] [Thread-2 (]: Began executing node model.takehome_wh.stg_product__transactions
[0m22:43:23.812339 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"
[0m22:43:23.815585 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome_wh.stg_product__transactions"
[0m22:43:23.817810 [debug] [Thread-1 (]: Began executing node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m22:43:23.818987 [debug] [Thread-2 (]: Using snowflake connection "model.takehome_wh.stg_product__transactions"
[0m22:43:23.826386 [debug] [Thread-2 (]: On model.takehome_wh.stg_product__transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.stg_product__transactions"} */
create or replace   view takehome_db.takehome_schema_staging.stg_product__transactions
  
   as (
    with
    transactions as (select * from read_replica.product.transactions),

    final as (
        select
            id as pk_transaction_id,
            device_id,
            product_name as transaction_product_name,
            product_sku as transaction_product_sku,
            amount as transaction_amount_eur,
            status as transaction_status,

            -- ideally, sensitive information such as credit card numbers
            -- and CVVs should not be stored in a data warehouse
            -- these sensitive information will not be included in downstream
            -- models in this project
            
            -- if an analysis requires these two fields, and product
            -- database remain unencrypted, perform tokenization

            created_at as transaction_created_at,
            happened_at as transaction_happened_at,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from transactions
    )

select *
from final
  );
[0m22:43:23.832547 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"
[0m22:43:23.832927 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:43:23.835494 [debug] [Thread-1 (]: Using snowflake connection "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"
[0m22:43:23.835821 [debug] [Thread-1 (]: On test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pk_store_id
from takehome_db.takehome_schema_staging.stg_product__stores
where pk_store_id is null



      
    ) dbt_internal_test
[0m22:43:23.836064 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:24.409955 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.574 seconds
[0m22:43:24.412677 [debug] [Thread-1 (]: On test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696: Close
[0m22:43:24.510322 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.677 seconds
[0m22:43:24.513081 [debug] [Thread-2 (]: On model.takehome_wh.stg_product__transactions: Close
[0m22:43:24.581838 [info ] [Thread-1 (]: 4 of 12 PASS not_null_stg_product__stores_pk_store_id .......................... [[32mPASS[0m in 0.79s]
[0m22:43:24.584773 [debug] [Thread-1 (]: Finished running node test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696
[0m22:43:24.585682 [debug] [Thread-1 (]: Began running node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m22:43:24.586466 [info ] [Thread-1 (]: 5 of 12 START test unique_stg_product__stores_pk_store_id ...................... [RUN]
[0m22:43:24.587339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome_wh.not_null_stg_product__stores_pk_store_id.5962178696, now test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e)
[0m22:43:24.587927 [debug] [Thread-1 (]: Began compiling node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m22:43:24.598158 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"
[0m22:43:24.602172 [debug] [Thread-1 (]: Began executing node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m22:43:24.605436 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"
[0m22:43:24.607033 [debug] [Thread-1 (]: Using snowflake connection "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"
[0m22:43:24.607467 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    pk_store_id as unique_field,
    count(*) as n_records

from takehome_db.takehome_schema_staging.stg_product__stores
where pk_store_id is not null
group by pk_store_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:43:24.607862 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:24.694816 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c101214e-050b-4e6e-9c76-c6d90a25c0a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e525c0>]}
[0m22:43:24.695637 [info ] [Thread-2 (]: 3 of 12 OK created sql view model takehome_schema_staging.stg_product__transactions  [[32mSUCCESS 1[0m in 0.91s]
[0m22:43:24.696187 [debug] [Thread-2 (]: Finished running node model.takehome_wh.stg_product__transactions
[0m22:43:24.696576 [debug] [Thread-2 (]: Began running node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m22:43:24.697079 [info ] [Thread-2 (]: 6 of 12 START test not_null_stg_product__devices_pk_device_id .................. [RUN]
[0m22:43:24.697512 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome_wh.stg_product__transactions, now test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941)
[0m22:43:24.697836 [debug] [Thread-2 (]: Began compiling node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m22:43:24.702735 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"
[0m22:43:24.704524 [debug] [Thread-2 (]: Began executing node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m22:43:24.709587 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"
[0m22:43:24.710693 [debug] [Thread-2 (]: Using snowflake connection "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"
[0m22:43:24.710989 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pk_device_id
from takehome_db.takehome_schema_staging.stg_product__devices
where pk_device_id is null



      
    ) dbt_internal_test
[0m22:43:24.711249 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:43:25.121407 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.513 seconds
[0m22:43:25.126505 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e: Close
[0m22:43:25.247300 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.536 seconds
[0m22:43:25.256062 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941: Close
[0m22:43:25.289191 [info ] [Thread-1 (]: 5 of 12 PASS unique_stg_product__stores_pk_store_id ............................ [[32mPASS[0m in 0.70s]
[0m22:43:25.290798 [debug] [Thread-1 (]: Finished running node test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e
[0m22:43:25.293025 [debug] [Thread-1 (]: Began running node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m22:43:25.294613 [info ] [Thread-1 (]: 7 of 12 START test unique_stg_product__devices_pk_device_id .................... [RUN]
[0m22:43:25.295845 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome_wh.unique_stg_product__stores_pk_store_id.8e7d55965e, now test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505)
[0m22:43:25.297035 [debug] [Thread-1 (]: Began compiling node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m22:43:25.305376 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"
[0m22:43:25.306796 [debug] [Thread-1 (]: Began executing node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m22:43:25.311414 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"
[0m22:43:25.312984 [debug] [Thread-1 (]: Using snowflake connection "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"
[0m22:43:25.313452 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    pk_device_id as unique_field,
    count(*) as n_records

from takehome_db.takehome_schema_staging.stg_product__devices
where pk_device_id is not null
group by pk_device_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:43:25.313866 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:25.429892 [info ] [Thread-2 (]: 6 of 12 PASS not_null_stg_product__devices_pk_device_id ........................ [[32mPASS[0m in 0.73s]
[0m22:43:25.430862 [debug] [Thread-2 (]: Finished running node test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941
[0m22:43:25.431388 [debug] [Thread-2 (]: Began running node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m22:43:25.431981 [info ] [Thread-2 (]: 8 of 12 START test not_null_stg_product__transactions_pk_transaction_id ........ [RUN]
[0m22:43:25.432601 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.takehome_wh.not_null_stg_product__devices_pk_device_id.3bc2482941, now test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc)
[0m22:43:25.433747 [debug] [Thread-2 (]: Began compiling node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m22:43:25.439003 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"
[0m22:43:25.441117 [debug] [Thread-2 (]: Began executing node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m22:43:25.446881 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"
[0m22:43:25.448343 [debug] [Thread-2 (]: Using snowflake connection "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"
[0m22:43:25.448738 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pk_transaction_id
from takehome_db.takehome_schema_staging.stg_product__transactions
where pk_transaction_id is null



      
    ) dbt_internal_test
[0m22:43:25.449084 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:43:25.820581 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.507 seconds
[0m22:43:25.824431 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505: Close
[0m22:43:25.932419 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.483 seconds
[0m22:43:25.937636 [debug] [Thread-2 (]: On test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc: Close
[0m22:43:25.993844 [info ] [Thread-1 (]: 7 of 12 PASS unique_stg_product__devices_pk_device_id .......................... [[32mPASS[0m in 0.70s]
[0m22:43:25.996202 [debug] [Thread-1 (]: Finished running node test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505
[0m22:43:25.997757 [debug] [Thread-1 (]: Began running node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m22:43:25.999031 [info ] [Thread-1 (]: 9 of 12 START test unique_stg_product__transactions_pk_transaction_id .......... [RUN]
[0m22:43:25.999965 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome_wh.unique_stg_product__devices_pk_device_id.775d050505, now test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df)
[0m22:43:26.000598 [debug] [Thread-1 (]: Began compiling node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m22:43:26.009474 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"
[0m22:43:26.011583 [debug] [Thread-1 (]: Began executing node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m22:43:26.017145 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"
[0m22:43:26.019444 [debug] [Thread-1 (]: Using snowflake connection "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"
[0m22:43:26.020537 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    pk_transaction_id as unique_field,
    count(*) as n_records

from takehome_db.takehome_schema_staging.stg_product__transactions
where pk_transaction_id is not null
group by pk_transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:43:26.020992 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:26.093788 [info ] [Thread-2 (]: 8 of 12 PASS not_null_stg_product__transactions_pk_transaction_id .............. [[32mPASS[0m in 0.66s]
[0m22:43:26.094942 [debug] [Thread-2 (]: Finished running node test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc
[0m22:43:26.096854 [debug] [Thread-2 (]: Began running node model.takehome_wh.dim_devices
[0m22:43:26.099820 [info ] [Thread-2 (]: 10 of 12 START sql table model takehome_schema_mart.dim_devices ................ [RUN]
[0m22:43:26.101056 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.takehome_wh.not_null_stg_product__transactions_pk_transaction_id.49827a4dfc, now model.takehome_wh.dim_devices)
[0m22:43:26.101846 [debug] [Thread-2 (]: Began compiling node model.takehome_wh.dim_devices
[0m22:43:26.113368 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome_wh.dim_devices"
[0m22:43:26.114876 [debug] [Thread-2 (]: Began executing node model.takehome_wh.dim_devices
[0m22:43:26.140601 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome_wh.dim_devices"
[0m22:43:26.142093 [debug] [Thread-2 (]: Using snowflake connection "model.takehome_wh.dim_devices"
[0m22:43:26.142368 [debug] [Thread-2 (]: On model.takehome_wh.dim_devices: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.dim_devices"} */
create or replace transient table takehome_db.takehome_schema_mart.dim_devices
         as
        (with
    -- import CTEs

    stores as (select * from takehome_db.takehome_schema_staging.stg_product__stores),

    devices as (select * from takehome_db.takehome_schema_staging.stg_product__devices),

    -- logical CTEs
    final as (
        select
            devices.pk_device_id,
            devices.device_type,
            devices.store_id,
            stores.store_name,
            stores.store_address,
            stores.store_city,
            stores.store_country,
            stores.store_typology,
            stores.store_created_at,
            stores.customer_id,
            
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from devices
        left join stores on devices.store_id = stores.pk_store_id
    )

select *
from final
        );
[0m22:43:26.142587 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:43:26.549955 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.528 seconds
[0m22:43:26.554012 [debug] [Thread-1 (]: On test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df: Close
[0m22:43:26.721796 [info ] [Thread-1 (]: 9 of 12 PASS unique_stg_product__transactions_pk_transaction_id ................ [[32mPASS[0m in 0.72s]
[0m22:43:26.723788 [debug] [Thread-1 (]: Finished running node test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df
[0m22:43:26.725441 [debug] [Thread-1 (]: Began running node model.takehome_wh.fct_transactions
[0m22:43:26.727027 [info ] [Thread-1 (]: 11 of 12 START sql table model takehome_schema_mart.fct_transactions ........... [RUN]
[0m22:43:26.728188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome_wh.unique_stg_product__transactions_pk_transaction_id.15dc5108df, now model.takehome_wh.fct_transactions)
[0m22:43:26.729270 [debug] [Thread-1 (]: Began compiling node model.takehome_wh.fct_transactions
[0m22:43:26.737732 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome_wh.fct_transactions"
[0m22:43:26.740029 [debug] [Thread-1 (]: Began executing node model.takehome_wh.fct_transactions
[0m22:43:26.745516 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome_wh.fct_transactions"
[0m22:43:26.748272 [debug] [Thread-1 (]: Using snowflake connection "model.takehome_wh.fct_transactions"
[0m22:43:26.748941 [debug] [Thread-1 (]: On model.takehome_wh.fct_transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.fct_transactions"} */
create or replace transient table takehome_db.takehome_schema_mart.fct_transactions
         as
        (with
    -- import CTEs
    transactions as (select * from takehome_db.takehome_schema_staging.stg_product__transactions),

    stores as (select * from takehome_db.takehome_schema_staging.stg_product__stores),

    devices as (select * from takehome_db.takehome_schema_staging.stg_product__devices),

    -- logical CTEs
    final as (
        select
            transactions.pk_transaction_id,
            transaction_happened_at,
            transaction_status,
            transaction_product_name,
            transaction_product_sku,
            transaction_amount_eur,

            device_id,
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from transactions
        left join devices on transactions.device_id = devices.pk_device_id
    )

select *
from final
        );
[0m22:43:26.749358 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:27.211047 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.068 seconds
[0m22:43:27.217076 [debug] [Thread-2 (]: On model.takehome_wh.dim_devices: Close
[0m22:43:27.382312 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c101214e-050b-4e6e-9c76-c6d90a25c0a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad25a20>]}
[0m22:43:27.385265 [info ] [Thread-2 (]: 10 of 12 OK created sql table model takehome_schema_mart.dim_devices ........... [[32mSUCCESS 1[0m in 1.28s]
[0m22:43:27.386266 [debug] [Thread-2 (]: Finished running node model.takehome_wh.dim_devices
[0m22:43:27.745134 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.996 seconds
[0m22:43:27.751401 [debug] [Thread-1 (]: On model.takehome_wh.fct_transactions: Close
[0m22:43:27.938872 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c101214e-050b-4e6e-9c76-c6d90a25c0a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b9f2b0>]}
[0m22:43:27.941752 [info ] [Thread-1 (]: 11 of 12 OK created sql table model takehome_schema_mart.fct_transactions ...... [[32mSUCCESS 1[0m in 1.21s]
[0m22:43:27.948183 [debug] [Thread-1 (]: Finished running node model.takehome_wh.fct_transactions
[0m22:43:27.973059 [debug] [Thread-2 (]: Began running node model.takehome_wh.rpt_device_performance
[0m22:43:27.973709 [info ] [Thread-2 (]: 12 of 12 START sql table model takehome_schema_reporting.rpt_device_performance  [RUN]
[0m22:43:27.974284 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome_wh.dim_devices, now model.takehome_wh.rpt_device_performance)
[0m22:43:27.974598 [debug] [Thread-2 (]: Began compiling node model.takehome_wh.rpt_device_performance
[0m22:43:27.989308 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome_wh.rpt_device_performance"
[0m22:43:27.995945 [debug] [Thread-2 (]: Began executing node model.takehome_wh.rpt_device_performance
[0m22:43:27.999992 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome_wh.rpt_device_performance"
[0m22:43:28.001407 [debug] [Thread-2 (]: Using snowflake connection "model.takehome_wh.rpt_device_performance"
[0m22:43:28.001713 [debug] [Thread-2 (]: On model.takehome_wh.rpt_device_performance: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "takehome_wh", "target_name": "dev", "node_id": "model.takehome_wh.rpt_device_performance"} */
create or replace transient table takehome_db.takehome_schema_reporting.rpt_device_performance
         as
        (with
    -- import CTEs
    transactions as (select * from takehome_db.takehome_schema_mart.fct_transactions),

    devices as (select * from takehome_db.takehome_schema_mart.dim_devices),

    -- logical CTEs
    final as (
        select
            devices.* exclude dbt_updated_at,
            transactions.* exclude (dbt_updated_at, transaction_status),
            convert_timezone('UTC', current_timestamp()) as dbt_updated_at
        from devices
        left join transactions on devices.pk_device_id = transactions.device_id
        where transaction_status = 'accepted'
    )

select *
from final
        );
[0m22:43:28.001959 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:43:29.011325 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.009 seconds
[0m22:43:29.015439 [debug] [Thread-2 (]: On model.takehome_wh.rpt_device_performance: Close
[0m22:43:29.168056 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c101214e-050b-4e6e-9c76-c6d90a25c0a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acc3970>]}
[0m22:43:29.168815 [info ] [Thread-2 (]: 12 of 12 OK created sql table model takehome_schema_reporting.rpt_device_performance  [[32mSUCCESS 1[0m in 1.19s]
[0m22:43:29.169671 [debug] [Thread-2 (]: Finished running node model.takehome_wh.rpt_device_performance
[0m22:43:29.170579 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:43:29.170831 [debug] [MainThread]: Connection 'model.takehome_wh.fct_transactions' was properly closed.
[0m22:43:29.171023 [debug] [MainThread]: Connection 'model.takehome_wh.rpt_device_performance' was properly closed.
[0m22:43:29.172000 [info ] [MainThread]: 
[0m22:43:29.172249 [info ] [MainThread]: Finished running 3 view models, 6 data tests, 3 table models in 0 hours 0 minutes and 9.17 seconds (9.17s).
[0m22:43:29.173357 [debug] [MainThread]: Command end result
[0m22:43:29.211214 [info ] [MainThread]: 
[0m22:43:29.211631 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:43:29.211853 [info ] [MainThread]: 
[0m22:43:29.212071 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m22:43:29.213652 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 9.944555, "process_user_time": 2.668885, "process_kernel_time": 0.353946, "process_mem_max_rss": "149061632", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:43:29.214093 [debug] [MainThread]: Command `dbt build` succeeded at 22:43:29.214040 after 9.95 seconds
[0m22:43:29.214352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071c7d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f7d510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b41060>]}
[0m22:43:29.214588 [debug] [MainThread]: Flushing usage events
